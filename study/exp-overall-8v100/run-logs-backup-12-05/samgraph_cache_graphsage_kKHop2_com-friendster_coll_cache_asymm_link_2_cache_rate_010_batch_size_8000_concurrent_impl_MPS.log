config:eval_tsp="2022-12-07 08:35:34"
config:arch=arch5
config:num_train_worker=6
config:num_sample_worker=2
config:sample_type=khop2
config:root_path=/nvme/samgraph/
config:dataset=com-friendster
config:pipeline=False
config:cache_policy=coll_cache_asymm_link
config:cache_percentage=0.1
config:num_epoch=4
config:batch_size=8000
config:num_hidden=256
config:max_sampling_jobs=1
config:max_copying_jobs=1
config:barriered_epoch=1
config:presample_epoch=2
config:omp_thread_num=6
config:unsupervised=False
config:amp=True
config:rolling=0
config:fanout=[25, 10]
config:lr=0.003
config:dropout=0.5
config:single_gpu=False
config:max_num_step=100000
config:validate_configs=False
config:report_acc=0
config:dataset_path=/nvme/samgraph/com-friendster
config:torch_thread_num=8
config:train_workers=['cuda:0', 'cuda:1', 'cuda:2', 'cuda:3', 'cuda:4', 'cuda:5']
config:sample_workers=['cuda:6', 'cuda:7']
config:num_fanout=2
config:num_layer=2
config:_run_mode=RunMode.FGNN
config:_log_level=warn
config:_profile_level=3
config:_empty_feat=0
config:_arch=5
config:_sample_type=5
config:_cache_policy=13
test_result:init:input_scale_factor=1.1
Set parameter WLSAccessID
Set parameter WLSSecret
Set parameter LicenseID
Set parameter TimeLimit to value 200
Set parameter MIPGap to value 0.05
Set parameter GomoryPasses to value 0
Set parameter Aggregate to value 0
Set parameter LogFile to value "cppsolver.log"
Set parameter Threads to value 12
Academic license - for non-commercial use only - registered to xiaoniu.sxn@sjtu.edu.cn
Gurobi Optimizer version 9.5.2 build v9.5.2rc0 (linux64)
Thread count: 48 physical cores, 96 logical processors, using up to 12 threads
Academic license - for non-commercial use only - registered to xiaoniu.sxn@sjtu.edu.cn
Optimize a model with 115974 rows, 25432 columns and 286830 nonzeros
Model fingerprint: 0x0c230fe9
Variable types: 7 continuous, 25425 integer (25425 binary)
Coefficient statistics:
  Matrix range     [3e-04, 7e+02]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 1e+03]
Found heuristic solution: objective 42010.073814
Presolve removed 91535 rows and 0 columns
Presolve time: 0.29s
Presolved: 24439 rows, 25432 columns, 98680 nonzeros
Found heuristic solution: objective 42010.073802
Variable types: 7 continuous, 25425 integer (25425 binary)

Root relaxation: objective 3.604093e+03, 34492 iterations, 4.07 seconds (4.57 work units)
Total elapsed time = 7.64s

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 3604.09263    0 9985 42010.0738 3604.09263  91.4%     -    7s
H    0     0                    32272.378708 3604.09263  88.8%     -   10s
H    0     0                    26761.939658 3604.09263  86.5%     -   10s
     0     0 3604.96104    0 10000 26761.9397 3604.96104  86.5%     -   11s
H    0     0                    21276.657577 3604.96104  83.1%     -   11s
     0     0 3604.96273    0 9995 21276.6576 3604.96273  83.1%     -   12s
     0     0 3604.96509    0 9982 21276.6576 3604.96509  83.1%     -   12s
     0     0 3607.70144    0 9999 21276.6576 3607.70144  83.0%     -   15s
H    0     0                    20270.416369 3607.70144  82.2%     -   15s
     0     0 3629.98760    0 9860 20270.4164 3629.98760  82.1%     -   18s
H    0     0                    17178.797504 3629.98760  78.9%     -   19s
H    0     0                    15421.798131 3629.98760  76.5%     -   20s
H    0     0                    14477.329799 3629.98760  74.9%     -   20s
H    0     0                    13488.692648 3629.98760  73.1%     -   20s
     0     0 3679.48732    0 9668 13488.6926 3679.48732  72.7%     -   20s
H    0     0                    11952.571202 3679.48732  69.2%     -   20s
     0     0 3680.17482    0 9672 11952.5712 3680.17482  69.2%     -   20s
     0     0 3680.17482    0 9672 11952.5712 3680.17482  69.2%     -   20s
     0     0 3697.77938    0 9646 11952.5712 3697.77938  69.1%     -   23s
H    0     0                    10508.050289 3697.77938  64.8%     -   24s
     0     0 3702.74232    0 9605 10508.0503 3702.74232  64.8%     -   24s
     0     0 3702.91693    0 9614 10508.0503 3702.91693  64.8%     -   24s
     0     0 3702.91693    0 9594 10508.0503 3702.91693  64.8%     -   24s
     0     0 3748.26518    0 9586 10508.0503 3748.26518  64.3%     -   26s
H    0     0                    10266.051651 3748.26518  63.5%     -   26s
     0     0 3749.33184    0 9594 10266.0517 3749.33184  63.5%     -   26s
     0     0 3749.33184    0 9593 10266.0517 3749.33184  63.5%     -   27s
     0     0 3803.40297    0 9546 10266.0517 3803.40297  63.0%     -   30s
H    0     0                    10110.090199 3803.40297  62.4%     -   30s
     0     0 3816.99702    0 9423 10110.0902 3816.99702  62.2%     -   31s
     0     0 3818.61144    0 9396 10110.0902 3818.61144  62.2%     -   31s
     0     0 3819.04312    0 9418 10110.0902 3819.04312  62.2%     -   31s
     0     0 3819.04312    0 9420 10110.0902 3819.04312  62.2%     -   31s
H    0     0                    7866.9549411 3819.04312  51.5%     -   32s
     0     0 3871.21363    0 8975 7866.95494 3871.21363  50.8%     -   32s
H    0     0                    7822.9551865 3871.21363  50.5%     -   32s
     0     0 3901.13347    0 8800 7822.95519 3901.13347  50.1%     -   32s
     0     0 3909.38342    0 8746 7822.95519 3909.38342  50.0%     -   32s
     0     0 3909.38342    0 8735 7822.95519 3909.38342  50.0%     -   33s
     0     0 3950.12847    0 8544 7822.95519 3950.12847  49.5%     -   36s
H    0     0                    7339.9427140 3950.12847  46.2%     -   36s
     0     0 3950.75704    0 8601 7339.94271 3950.75704  46.2%     -   37s
     0     0 3950.75704    0 8596 7339.94271 3950.75704  46.2%     -   37s
     0     0 3970.28975    0 8626 7339.94271 3970.28975  45.9%     -   40s
H    0     0                    7274.4420594 3970.28975  45.4%     -   40s
     0     0 3980.77671    0 8642 7274.44206 3980.77671  45.3%     -   40s
     0     0 3983.22114    0 8670 7274.44206 3983.22114  45.2%     -   40s
     0     0 3983.22114    0 8660 7274.44206 3983.22114  45.2%     -   40s
     0     0 4015.01037    0 8727 7274.44206 4015.01037  44.8%     -   42s
     0     0 4017.16681    0 8721 7274.44206 4017.16681  44.8%     -   42s
     0     0 4017.27150    0 8716 7274.44206 4017.27150  44.8%     -   42s
     0     0 4035.29407    0 8596 7274.44206 4035.29407  44.5%     -   45s
     0     0 4037.68412    0 8577 7274.44206 4037.68412  44.5%     -   45s
     0     0 4038.52697    0 8586 7274.44206 4038.52697  44.5%     -   45s
     0     0 4038.52697    0 8593 7274.44206 4038.52697  44.5%     -   45s
     0     0 4065.43635    0 8330 7274.44206 4065.43635  44.1%     -   47s
     0     0 4075.46010    0 8223 7274.44206 4075.46010  44.0%     -   48s
     0     0 4080.10293    0 8176 7274.44206 4080.10293  43.9%     -   48s
     0     0 4080.10293    0 8174 7274.44206 4080.10293  43.9%     -   48s
     0     0 4096.33141    0 7988 7274.44206 4096.33141  43.7%     -   51s
H    0     0                    7230.4423049 4096.33141  43.3%     -   52s
     0     0 4100.04574    0 7996 7230.44230 4100.04574  43.3%     -   52s
     0     0 4100.78845    0 8008 7230.44230 4100.78845  43.3%     -   52s
     0     0 4101.43453    0 7991 7230.44230 4101.43453  43.3%     -   52s
     0     0 4101.97774    0 7992 7230.44230 4101.97774  43.3%     -   53s
     0     0 4101.97774    0 7992 7230.44230 4101.97774  43.3%     -   53s
     0     0 4111.31344    0 7957 7230.44230 4111.31344  43.1%     -   59s
     0     0 4120.66338    0 7895 7230.44230 4120.66338  43.0%     -   59s
     0     0 4129.66333    0 7819 7230.44230 4129.66333  42.9%     -   60s
     0     0 4131.66332    0 7802 7230.44230 4131.66332  42.9%     -   60s
     0     0 4133.86331    0 7721 7230.44230 4133.86331  42.8%     -   61s
     0     0 4138.26328    0 7678 7230.44230 4138.26328  42.8%     -   61s
     0     0 4138.26328    0 7677 7230.44230 4138.26328  42.8%     -   61s
     0     0 4905.93223    0 5229 7230.44230 4905.93223  32.1%     -   63s
H    0     0                    6859.1061529 4905.93223  28.5%     -   63s
     0     0 4905.93223    0 4809 6859.10615 4905.93223  28.5%     -   64s
     0     0 4953.90557    0 4901 6859.10615 4953.90557  27.8%     -   65s
H    0     0                    6848.1062473 4953.90557  27.7%     -   66s
     0     0 5352.49844    0 6057 6848.10625 5352.49844  21.8%     -   66s
     0     0 5958.36434    0 3446 6848.10625 5958.36434  13.0%     -   67s
     0     0 6029.59038    0 3243 6848.10625 6029.59038  12.0%     -   67s
     0     0 6064.40774    0 3199 6848.10625 6064.40774  11.4%     -   67s
     0     0 6082.86521    0 3256 6848.10625 6082.86521  11.2%     -   67s
     0     0 6100.15209    0 3248 6848.10625 6100.15209  10.9%     -   67s
     0     0 6112.96111    0 3277 6848.10625 6112.96111  10.7%     -   67s
     0     0 6129.68022    0 3290 6848.10625 6129.68022  10.5%     -   67s
     0     0 6139.83524    0 3244 6848.10625 6139.83524  10.3%     -   67s
     0     0 6147.45968    0 3241 6848.10625 6147.45968  10.2%     -   68s
     0     0 6153.44554    0 3262 6848.10625 6153.44554  10.1%     -   68s
     0     0 6156.71192    0 3259 6848.10625 6156.71192  10.1%     -   68s
     0     0 6160.29238    0 3282 6848.10625 6160.29238  10.0%     -   68s
     0     0 6162.55357    0 3261 6848.10625 6162.55357  10.0%     -   68s
     0     0 6164.29800    0 3289 6848.10625 6164.29800  10.0%     -   68s
     0     0 6164.45069    0 3297 6848.10625 6164.45069  10.0%     -   68s
     0     0 6390.47014    0 2073 6848.10625 6390.47014  6.68%     -   71s
H    0     0                    6616.2611805 6390.47014  3.41%     -   72s

Cutting planes:
  MIR: 632
  Zero half: 1961
  Mod-K: 1477

Explored 1 nodes (85569 simplex iterations) in 72.45 seconds (62.75 work units)
Thread count was 12 (of 96 available processors)

Solution count 10: 6616.26 6848.11 6859.11 ... 10266.1

Optimal solution found (tolerance 5.00e-02)
Best objective 6.616261180481e+03, best bound 6.390470139434e+03, gap 3.4127%
coll_cache:optimal_local_rate=0.298572,0.26756,0.321222,0.283144,0.313306,0.291456,
coll_cache:optimal_remote_rate=0.588782,0.619794,0.566132,0.60421,0.574049,0.595899,
coll_cache:optimal_cpu_rate=0.112646,0.112646,0.112646,0.112646,0.112646,0.112646,
z=6616.26
test_result:init:feat_nbytes=67182966784
test_result:init:cache_nbytes=6720736256
test_result:init:feat_nbytes=67182966784
test_result:init:cache_nbytes=6703747072
test_result:init:feat_nbytes=67182966784
test_result:init:cache_nbytes=6722546688
test_result:init:feat_nbytes=67182966784
test_result:init:cache_nbytes=6724031488
test_result:init:feat_nbytes=67182966784
test_result:init:cache_nbytes=6716954624
test_result:init:feat_nbytes=67182966784
test_result:init:cache_nbytes=6715125760
test_result:init:cache_nbytes=0
test_result:init:cache_nbytes=0
test_result:init:cache_nbytes=0
test_result:init:cache_nbytes=0
test_result:init:cache_nbytes=0
test_result:init:cache_nbytes=0
[Train  Worker 4/6] Started with PID 77484(Tesla V100-SXM2-32GB)
[Train  Worker 4] run train for 4 epochs with 126 steps
[Train  Worker 4] Avg Epoch Time 1.3049 | Train Total Time(Profiler) 0.2180 | Copy Time 1.0847
[Train  Worker 3/6] Started with PID 77481(Tesla V100-SXM2-32GB)
[Train  Worker 3] run train for 4 epochs with 126 steps
[Train  Worker 3] Avg Epoch Time 1.3050 | Train Total Time(Profiler) 0.2183 | Copy Time 1.0844
[Train  Worker 0/6] Started with PID 77472(Tesla V100-SXM2-32GB)
[Train  Worker 0] run train for 4 epochs with 126 steps
Epoch 00000 | Epoch Time 2.6691 | Total Train Time(Profiler) 2.0063 | Copy Time 0.6595
Epoch 00001 | Epoch Time 1.3048 | Total Train Time(Profiler) 0.6861 | Copy Time 0.6162
Epoch 00002 | Epoch Time 1.3053 | Total Train Time(Profiler) 0.6870 | Copy Time 0.6159
Epoch 00003 | Epoch Time 1.3048 | Total Train Time(Profiler) 0.6898 | Copy Time 0.6128
[Train  Worker 0] Avg Epoch Time 1.3050 | Train Total Time(Profiler) 0.6876 | Copy Time 0.6150
[Train  Worker 1/6] Started with PID 77475(Tesla V100-SXM2-32GB)
[Train  Worker 1] run train for 4 epochs with 126 steps
[Train  Worker 1] Avg Epoch Time 1.3049 | Train Total Time(Profiler) 0.2265 | Copy Time 1.0762
[Train  Worker 5/6] Started with PID 77487(Tesla V100-SXM2-32GB)
[Train  Worker 5] run train for 4 epochs with 126 steps
[Train  Worker 5] Avg Epoch Time 1.3050 | Train Total Time(Profiler) 0.6896 | Copy Time 0.6132
[Train  Worker 2/6] Started with PID 77478(Tesla V100-SXM2-32GB)
[Train  Worker 2] run train for 4 epochs with 126 steps
[Train  Worker 2] Avg Epoch Time 1.3049 | Train Total Time(Profiler) 0.2233 | Copy Time 1.0793
[Sample Worker 1/2] Started with PID 77470(Tesla V100-SXM2-32GB)
[Sample Worker 1] run sample for 4 epochs with 63 steps
[Sample Worker 1] Avg Sample Total Time 0.4523 | Sampler Total Time(Profiler) 0.4516
    [Step(average) Profiler Level 1 E3 S62]
        L1  sample           0.005805 | send           0.001272
        L1  recv             0.000000 | copy           0.000000 | convert time 0.000000 | train  0.000000
        L1  feature nbytes 0.00 Bytes | label nbytes 0.00 Bytes
        L1  id nbytes      0.00 Bytes | graph nbytes 0.00 Bytes
        L1  miss nbytes    0.00 Bytes | remote nbytes 0.00 Bytes
        L1  num nodes         1189247 | num samples     1335744
    [Step(average) Profiler Level 2 E3 S62]
        L2  shuffle     0.000511 | core sample  0.001734 | id remap        0.003444
        L2  graph copy  0.000000 | id copy      0.000000 | cache feat copy 0.000000
        L2  last layer sample time 0.000330 | size 58941.068783
    [Step(average) Profiler Level 3 E3 S62]
        L3  khop sample coo  0.001428 | khop sort coo      0.000000 | khop count edge     0.000042 | khop compact edge 0.000223
        L3  walk sample coo  0.000000 | walk topk total    0.000000 | walk topk step1     0.000000 | walk topk step2   0.000000
        L3  walk topk step3  0.000000 | walk topk step4    0.000000 | walk topk step5     0.000000
        L3  walk topk step6  0.000000 | walk topk step7    0.000000
        L3  remap unique     0.000000 | remap populate     0.002905 | remap mapnode       0.000000 | remap mapedge     0.000539
        L3  cache get_index  0.000000 | cache copy_index   0.000000 | cache extract_miss  0.000000
        L3  cache copy_miss  0.000000 | cache combine_miss 0.000000 | cache combine cache 0.000000 | cache combine remote 0.000000
        L3  label extract  0.000000
    [Init Profiler Level 1]
        L1  init     7.7293 | sampler init    14.5955 | trainer init 0.0000
    [Init Profiler Level 2]
        L2  load ds        10.7489 | init queue           4.5715
        L2  presample       4.5463 | build interal ds     2.4534
        L2  build cache     0.0000
    [Init Profiler Level 3]
        L3  load dataset: mmap     7.7244 | copy         3.0244
        L3  dist queue: alloc      0.0018 | pin          4.5696 | push     0.0000
        L3  presample: init        0.2256
        L3  presample: sample      1.4055 | copy         0.1024
        L3  presample: count       2.4045 | sort         0.1461
        L3  presample: reset       0.0006 | get rank     0.0147
        L3  internal: cuda ctx     2.1698 | cuda stream     0.2779
[Sample Worker 0/2] Started with PID 77469(Tesla V100-SXM2-32GB)
[Sample Worker 0] run sample for 4 epochs with 63 steps
[Sample Worker 0] Avg Sample Total Time 0.4512 | Sampler Total Time(Profiler) 0.4459
test_result:sample_time=0.3657
test_result:get_cache_miss_index_time=0.0000
test_result:enqueue_samples_time=0.0801
test_result:epoch_time:sample_total=0.4512
[CUDA] cuda0: usage: 13.89 GB
[SAM] cuda0 data alloc        : 0.00 Bytes
[SAM] cuda0 workspace         : 2.56 GB
[SAM] cuda0 workspace reserve : 1.27 GB
[SAM] cuda0 total             : 2.56 GB
    [Step(average) Profiler Level 1 E3 S125]
        L1  sample           0.000000 | send           0.000000
        L1  recv             0.002276 | copy           0.044048 | convert time 0.000419 | train  0.017565
        L1  feature nbytes    1.13 GB | label nbytes   62.50 KB
        L1  id nbytes      0.00 Bytes | graph nbytes 0.00 Bytes
        L1  miss nbytes     160.59 MB | remote nbytes  666.86 MB
        L1  num nodes               0 | num samples           0
    [Step(average) Profiler Level 2 E3 S125]
        L2  shuffle     0.000000 | core sample  0.000000 | id remap        0.000000
        L2  graph copy  0.000004 | id copy      0.000000 | cache feat copy 0.041768
        L2  last layer sample time 0.000000 | size 0.000000
    [Step(average) Profiler Level 3 E3 S125]
        L3  khop sample coo  0.000000 | khop sort coo      0.000000 | khop count edge     0.000000 | khop compact edge 0.000000
        L3  walk sample coo  0.000000 | walk topk total    0.000000 | walk topk step1     0.000000 | walk topk step2   0.000000
        L3  walk topk step3  0.000000 | walk topk step4    0.000000 | walk topk step5     0.000000
        L3  walk topk step6  0.000000 | walk topk step7    0.000000
        L3  remap unique     0.000000 | remap populate     0.000000 | remap mapnode       0.000000 | remap mapedge     0.000000
        L3  cache get_index  0.000857 | cache copy_index   0.000000 | cache extract_miss  0.000000
        L3  cache copy_miss  0.000000 | cache combine_miss 0.040483 | cache combine cache 0.001195 | cache combine remote 0.012502
        L3  label extract  0.000415
    [Init Profiler Level 1]
        L1  init     7.7293 | sampler init     0.0000 | trainer init 134.5022
    [Init Profiler Level 2]
        L2  load ds         7.7244 | init queue           4.4317
        L2  presample       0.0000 | build interal ds     2.1549
        L2  build cache   127.9083
    [Init Profiler Level 3]
        L3  load dataset: mmap     7.7244 | copy         0.0000
        L3  dist queue: alloc      0.0018 | pin          4.4299 | push     0.0000
        L3  presample: init        0.0000
        L3  presample: sample      0.0000 | copy         0.0000
        L3  presample: count       0.0000 | sort         0.0000
        L3  presample: reset       0.0000 | get rank     0.0000
        L3  internal: cuda ctx     2.1548 | cuda stream     0.0001
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   17963 KB |  735358 KB |  128496 MB |  128478 MB |
|       from large pool |   13107 KB |  733931 KB |  127744 MB |  127731 MB |
|       from small pool |    4856 KB |    6555 KB |     751 MB |     747 MB |
|---------------------------------------------------------------------------|
| Active memory         |   17964 KB |  735358 KB |  128496 MB |  128478 MB |
|       from large pool |   13107 KB |  733931 KB |  127744 MB |  127731 MB |
|       from small pool |    4857 KB |    6555 KB |     751 MB |     747 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  751616 KB |  751616 KB |  751616 KB |       0 B  |
|       from large pool |  743424 KB |  743424 KB |  743424 KB |       0 B  |
|       from small pool |    8192 KB |    8192 KB |    8192 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   18900 KB |  652258 KB |  121946 MB |  121928 MB |
|       from large pool |   17613 KB |  650584 KB |  120981 MB |  120964 MB |
|       from small pool |    1287 KB |    3162 KB |     965 MB |     964 MB |
|---------------------------------------------------------------------------|
| Allocations           |      38    |      51    |    9363    |    9325    |
|       from large pool |       3    |      14    |    3696    |    3693    |
|       from small pool |      35    |      39    |    5667    |    5632    |
|---------------------------------------------------------------------------|
| Active allocs         |      39    |      51    |    9363    |    9324    |
|       from large pool |       3    |      14    |    3696    |    3693    |
|       from small pool |      36    |      39    |    5667    |    5631    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      10    |      10    |      10    |       0    |
|       from large pool |       6    |       6    |       6    |       0    |
|       from small pool |       4    |       4    |       4    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      12    |      22    |    4102    |    4090    |
|       from large pool |       2    |       8    |    2164    |    2162    |
|       from small pool |      10    |      17    |    1938    |    1928    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

test_result:epoch_time:copy_time=0.6150
test_result:convert_time=0.0089
test_result:train_time=0.6787
test_result:epoch_time:train_total=0.6876
test_result:cache_percentage=0.1000
test_result:cache_hit_rate=1.0000
test_result:run_time=8.4076
