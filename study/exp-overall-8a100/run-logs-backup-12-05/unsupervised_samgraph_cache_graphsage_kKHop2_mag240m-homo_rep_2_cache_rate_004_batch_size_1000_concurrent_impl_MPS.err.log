[2022-12-06 04:56:50. 55595: W /samgraph/samgraph/common/cpu/mmap_cpu_device.cc:92] mmap allocating space 12.87 GB
[2022-12-06 04:56:50. 55670: W /samgraph/samgraph/common/cpu/mmap_cpu_device.cc:97] mmap allocating space 12.87 GB done
[2022-12-06 04:56:53.712673: W /samgraph/samgraph/common/cpu/mmap_cpu_device.cc:92] mmap allocating space 349.28 GB
[2022-12-06 04:56:53.712783: W /samgraph/samgraph/common/cpu/mmap_cpu_device.cc:97] mmap allocating space 349.28 GB done
[2022-12-06 04:56:53.712803: W /samgraph/samgraph/common/cpu/mmap_cpu_device.cc:92] mmap allocating space 1.82 GB
[2022-12-06 04:56:53.712816: W /samgraph/samgraph/common/cpu/mmap_cpu_device.cc:97] mmap allocating space 1.82 GB done
[2022-12-06 04:56:53.712851: W /samgraph/samgraph/common/cpu/cpu_device.cc:39] WORKER[0] alloc host memory 12.87 GB
[2022-12-06 04:56:54.253139: E /samgraph/samgraph/common/engine.cc:272] Train set size 3.82 MB
[2022-12-06 04:56:54.253501: W /samgraph/samgraph/common/cpu/mmap_cpu_device.cc:92] mmap allocating space 68.50 GB
[2022-12-06 04:56:54.253524: W /samgraph/samgraph/common/cpu/mmap_cpu_device.cc:97] mmap allocating space 68.50 GB done
/usr/lib/python3/dist-packages/requests/__init__.py:89: RequestsDependencyWarning: urllib3 (1.26.12) or chardet (3.0.4) doesn't match a supported version!
  warnings.warn("urllib3 ({}) or chardet ({}) doesn't match a supported "
[2022-12-06 04:56:55.552136: W /samgraph/samgraph/common/dist/dist_engine.cc:662] Trainer[5] initializing...
[2022-12-06 04:56:55.593848: W /samgraph/samgraph/common/dist/dist_engine.cc:662] Trainer[0] initializing...
[2022-12-06 04:56:55.631943: W /samgraph/samgraph/common/dist/dist_engine.cc:662] Trainer[1] initializing...
[2022-12-06 04:56:55.693024: W /samgraph/samgraph/common/dist/dist_engine.cc:662] Trainer[3] initializing...
[2022-12-06 04:56:55.735313: W /samgraph/samgraph/common/dist/dist_engine.cc:662] Trainer[2] initializing...
[2022-12-06 04:56:55.761496: W /samgraph/samgraph/common/dist/dist_engine.cc:662] Trainer[4] initializing...
[2022-12-06 04:56:57. 70060: W /samgraph/samgraph/common/dist/dist_engine.cc:666] Trainer[0] pin memory queue...
[2022-12-06 04:56:57. 73311: W /samgraph/samgraph/common/dist/dist_engine.cc:666] Trainer[5] pin memory queue...
[2022-12-06 04:56:57. 87444: W /samgraph/samgraph/common/dist/dist_engine.cc:666] Trainer[3] pin memory queue...
[2022-12-06 04:56:57. 87511: W /samgraph/samgraph/common/dist/dist_engine.cc:666] Trainer[1] pin memory queue...
[2022-12-06 04:56:57. 95771: W /samgraph/samgraph/common/dist/dist_engine.cc:666] Trainer[4] pin memory queue...
[2022-12-06 04:56:57. 97269: W /samgraph/samgraph/common/dist/dist_engine.cc:666] Trainer[2] pin memory queue...
[2022-12-06 04:57:16.645991: E /samgraph/samgraph/common/dist/dist_engine.cc:85] Running on A100
[2022-12-06 04:57:16.646801: E /samgraph/samgraph/common/dist/dist_engine.cc:85] Running on A100
[2022-12-06 04:57:16.647227: W /samgraph/samgraph/common/dist/dist_engine.cc:701] Trainer[5] register host memory...
[2022-12-06 04:57:16.647335: E /samgraph/samgraph/common/dist/dist_engine.cc:85] Running on A100
[2022-12-06 04:57:16.647867: W /samgraph/samgraph/common/dist/dist_engine.cc:701] Trainer[4] register host memory...
[2022-12-06 04:57:16.648188: W /samgraph/samgraph/common/dist/dist_engine.cc:701] Trainer[1] register host memory...
[2022-12-06 04:57:16.674953: E /samgraph/samgraph/common/dist/dist_engine.cc:85] Running on A100
[2022-12-06 04:57:16.675503: W /samgraph/samgraph/common/dist/dist_engine.cc:701] Trainer[2] register host memory...
[2022-12-06 04:57:16.700095: E /samgraph/samgraph/common/dist/dist_engine.cc:85] Running on A100
[2022-12-06 04:57:16.700280: W /samgraph/samgraph/common/dist/dist_engine.cc:701] Trainer[0] register host memory...
[2022-12-06 04:57:16.711124: E /samgraph/samgraph/common/dist/dist_engine.cc:85] Running on A100
[2022-12-06 04:57:16.711176: W /samgraph/samgraph/common/dist/dist_engine.cc:701] Trainer[3] register host memory...
[2022-12-06 04:57:16.862639: E /samgraph/samgraph/common/dist/dist_engine.cc:85] Running on A100
[2022-12-06 04:57:16.862707: E /samgraph/samgraph/common/dist/dist_engine.cc:85] Running on A100
[2022-12-06 04:57:16.865766: W /samgraph/samgraph/common/cuda/cuda_device.cc:49] GPU[6] alloc cuda memory 931.40 MB
[2022-12-06 04:57:17. 24558: W /samgraph/samgraph/common/cuda/cuda_device.cc:49] GPU[6] alloc cuda memory 12.87 GB
[2022-12-06 04:57:18.901160: W /samgraph/samgraph/common/cuda/cuda_device.cc:49] GPU[6] alloc cuda memory 32.00 MB
[2022-12-06 04:57:18.903700: E /samgraph/samgraph/common/dist/pre_sampler.cc:41] Dist Presampler making shuffler...
[2022-12-06 04:57:18.905278: E /samgraph/samgraph/common/dist/pre_sampler.cc:44] Dist Presampler making shuffler...Done
[2022-12-06 04:57:18.905302: W /samgraph/samgraph/common/cpu/cpu_device.cc:39] WORKER[0] alloc host memory 1.82 GB
[2022-12-06 04:57:19.199122: E /samgraph/samgraph/common/dist/pre_sampler.cc:85] Dist Presampler doing presample epoch 0
[2022-12-06 04:57:23.356971: E /samgraph/samgraph/common/dist/pre_sampler.cc:129] presample spend 1.22092 on sample, 0.0924008 on copy, 2.83713 on count
[2022-12-06 04:57:23.357074: E /samgraph/samgraph/common/dist/pre_sampler.cc:85] Dist Presampler doing presample epoch 1
[2022-12-06 04:57:27.657250: E /samgraph/samgraph/common/dist/pre_sampler.cc:129] presample spend 2.46972 on sample, 0.185627 on copy, 5.78815 on count
[2022-12-06 04:57:27.657336: E /samgraph/samgraph/common/dist/pre_sampler.cc:136] max_num_inputs = 500540, min_num_inputs = 465967
[2022-12-06 04:57:28.198134: E /samgraph/samgraph/common/dist/pre_sampler.cc:148] presample spend 0.540723 on sort freq.
[2022-12-06 04:57:28.555661: E /samgraph/samgraph/common/dist/dist_engine.cc:524] pre sample done, delete it
[[[[[[2022-12-06 04:57:282022-12-06 04:57:282022-12-06 04:57:282022-12-06 04:57:282022-12-06 04:57:28.2022-12-06 04:57:28....596479.596481596472596477596486: 596487: : : : W: WWWW W    /samgraph/samgraph/common/dist/dist_engine.cc /samgraph/samgraph/common/dist/dist_engine.cc/samgraph/samgraph/common/dist/dist_engine.cc/samgraph/samgraph/common/dist/dist_engine.cc/samgraph/samgraph/common/dist/dist_engine.cc:/samgraph/samgraph/common/dist/dist_engine.cc::::711:711711711711] 711] ] ] ] Trainer[0] building cache...] Trainer[3] building cache...Trainer[5] building cache...Trainer[2] building cache...Trainer[1] building cache...

Trainer[4] building cache...



[[[2022-12-06 04:57:282022-12-06 04:57:282022-12-06 04:57:28...597982597987597985: : : EEE[   2022-12-06 04:57:28/samgraph/3rdparty/collcachelib/coll_cache_lib/run_config.cc/samgraph/3rdparty/collcachelib/coll_cache_lib/run_config.cc/samgraph/3rdparty/collcachelib/coll_cache_lib/run_config.cc.:::598005134134134: ] ] ] Eusing concurrent impl MPSusing concurrent impl MPSusing concurrent impl MPS 


/samgraph/3rdparty/collcachelib/coll_cache_lib/run_config.cc:134] using concurrent impl MPS
[2022-12-06 04:57:28.598052: E /samgraph/3rdparty/collcachelib/coll_cache_lib/run_config.cc:134] using concurrent impl MPS
[2022-12-06 04:57:28.599267: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] build symm link desc with 6X NVIDIA A100-SXM4-80GB out of 8
[2022-12-06 04:57:28.599298: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:197] remote time is 10.8824
[2022-12-06 04:57:28.599309: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:198] cpu time is 41.1111
[2022-12-06 04:57:28.599525: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] build symm link desc with 6X NVIDIA A100-SXM4-80GB out of 8
[2022-12-06 04:57:28.599544: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:197] remote time is 10.8824
[2022-12-06 04:57:28.599555: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:198] cpu time is 41.1111
[2022-12-06 04:57:28.599765: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] build symm link desc with 6X NVIDIA A100-SXM4-80GB out of 8
[2022-12-06 04:57:28.599786: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:197] remote time is 10.8824
[2022-12-06 04:57:28.599804: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:198] cpu time is 41.1111
[2022-12-06 04:57:28.599922: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] build symm link desc with 6X NVIDIA A100-SXM4-80GB out of 8
[2022-12-06 04:57:28.599942: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:197] remote time is 10.8824
[2022-12-06 04:57:28.599953: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:198] cpu time is 41.1111
[2022-12-06 04:57:28.600060: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] build symm link desc with 6X NVIDIA A100-SXM4-80GB out of 8
[2022-12-06 04:57:28.600085: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:197] remote time is 10.8824
[2022-12-06 04:57:28.600097: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:198] cpu time is 41.1111
[2022-12-06 04:57:28.704030: E /samgraph/3rdparty/collcachelib/coll_cache_lib/run_config.cc:134] using concurrent impl MPS
[2022-12-06 04:57:28.705152: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] build symm link desc with 6X NVIDIA A100-SXM4-80GB out of 8
[2022-12-06 04:57:28.705180: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:197] remote time is 10.8824
[2022-12-06 04:57:28.705191: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:198] cpu time is 41.1111
[2022-12-06 04:58:55.449695: E /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:115] solver created. now build & solve
[2022-12-06 04:58:55.527726: E /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:120] solver built. now solve
[2022-12-06 04:58:55.527761: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:895] num_cached_nodes = 9766419
[2022-12-06 04:58:56.872126: E /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:124] solver solved
[2022-12-06 04:58:56.872217: E /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:187] 0 solved master
[2022-12-06 04:58:56.872236: E /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:194] 0 solved
[2022-12-06 04:58:56.872247: E /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:197] worker 0 thread 0 initing device 0
[2022-12-06 04:58:56.901424: E /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:194] 5 solved
[2022-12-06 04:58:56.901480: E /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:197] worker 5 thread 5 initing device 5
[2022-12-06 04:58:56.902561: E /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:194] 1 solved
[2022-12-06 04:58:56.902607: E /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:197] worker 1 thread 1 initing device 1
[2022-12-06 04:58:56.904428: E /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:194] 2 solved
[2022-12-06 04:58:56.904460: E /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:197] worker 2 thread 2 initing device 2
[[2022-12-06 04:58:562022-12-06 04:58:56..943743943743: : EE  /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc/samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc::194194] ] 3 solved4 solved

[[2022-12-06 04:58:562022-12-06 04:58:56..943811943811: : EE  /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc/samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc::197197] ] worker 4 thread 4 initing device 4worker 3 thread 3 initing device 3

[2022-12-06 04:58:58.264959: E /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:1740] Collaborative GPU cache (policy: rep_cache) | local 9766419 / 244160499 nodes ( 4.00 %~4.00 %) | remote 0 / 244160499 nodes ( 0.00 %) | cpu 234394080 / 244160499 nodes ( 96.00 %) | 13.97 GB | 1.36274 secs 
[2022-12-06 04:58:58.265668: E /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:1740] Collaborative GPU cache (policy: rep_cache) | local 9766419 / 244160499 nodes ( 4.00 %~4.00 %) | remote 0 / 244160499 nodes ( 0.00 %) | cpu 234394080 / 244160499 nodes ( 96.00 %) | 13.97 GB | 1.35992 secs 
[2022-12-06 04:58:58.268405: E /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:1740] Collaborative GPU cache (policy: rep_cache) | local 9766419 / 244160499 nodes ( 4.00 %~4.00 %) | remote 0 / 244160499 nodes ( 0.00 %) | cpu 234394080 / 244160499 nodes ( 96.00 %) | 13.97 GB | 1.39551 secs 
[2022-12-06 04:58:58.269000: E /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:1740] Collaborative GPU cache (policy: rep_cache) | local 9766419 / 244160499 nodes ( 4.00 %~4.00 %) | remote 0 / 244160499 nodes ( 0.00 %) | cpu 234394080 / 244160499 nodes ( 96.00 %) | 13.97 GB | 1.32424 secs 
[2022-12-06 04:58:58.269713: E /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:1740] Collaborative GPU cache (policy: rep_cache) | local 9766419 / 244160499 nodes ( 4.00 %~4.00 %) | remote 0 / 244160499 nodes ( 0.00 %) | cpu 234394080 / 244160499 nodes ( 96.00 %) | 13.97 GB | 1.32491 secs 
[2022-12-06 04:58:58.269789: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:2004] before create ctx, mem is 17.51 GB
[2022-12-06 04:58:58.270436: E /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:1740] Collaborative GPU cache (policy: rep_cache) | local 9766419 / 244160499 nodes ( 4.00 %~4.00 %) | remote 0 / 244160499 nodes ( 0.00 %) | cpu 234394080 / 244160499 nodes ( 96.00 %) | 13.97 GB | 1.36673 secs 
[2022-12-06 04:58:59.420639: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:2010] after create ctx, mem is 17.94 GB
[2022-12-06 04:58:59.421817: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:2017] after create stream, mem is 17.94 GB
[2022-12-06 04:58:59.422600: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:2004] before create ctx, mem is 17.94 GB
[2022-12-06 04:59:00.508087: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:2010] after create ctx, mem is 18.37 GB
[2022-12-06 04:59:00.509214: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:2017] after create stream, mem is 18.37 GB
[2022-12-06 04:59:00.509440: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:2004] before create ctx, mem is 18.37 GB
[2022-12-06 04:59:01.649125: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:2010] after create ctx, mem is 18.79 GB
[2022-12-06 04:59:01.651405: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:2017] after create stream, mem is 18.79 GB
[2022-12-06 04:59:01.653706: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:2004] before create ctx, mem is 18.79 GB
[2022-12-06 04:59:02.615368: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:2010] after create ctx, mem is 19.22 GB
[2022-12-06 04:59:02.615499: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:2017] after create stream, mem is 19.22 GB
[2022-12-06 04:59:02.616589: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:2004] before create ctx, mem is 19.22 GB
[2022-12-06 04:59:03.706370: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:2010] after create ctx, mem is 19.65 GB
[2022-12-06 04:59:03.707455: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:2017] after create stream, mem is 19.65 GB
[2022-12-06 04:59:03.707712: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:2004] before create ctx, mem is 19.65 GB
[2022-12-06 04:59:04.859681: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:2010] after create ctx, mem is 20.40 GB
[2022-12-06 04:59:04.860470: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:2017] after create stream, mem is 20.40 GB
[2022-12-06 04:59:04.860981: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:2004] before create ctx, mem is 20.40 GB
[2022-12-06 04:59:05.994985: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:2010] after create ctx, mem is 20.79 GB
[2022-12-06 04:59:05.995104: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:2017] after create stream, mem is 20.79 GB
[2022-12-06 04:59:10.408129: W /samgraph/samgraph/common/cuda/cuda_device.cc:49] GPU[0] alloc cuda memory 794.71 MB
[2022-12-06 04:59:11.788064: W /samgraph/samgraph/common/cuda/cuda_device.cc:49] GPU[0] alloc cuda memory 794.71 MB
/usr/local/lib/python3.8/dist-packages/torch/nn/parallel/scatter_gather.py:9: UserWarning: is_namedtuple is deprecated, please use the python checks instead
  warnings.warn("is_namedtuple is deprecated, please use the python checks instead")
/usr/local/lib/python3.8/dist-packages/torch/nn/parallel/scatter_gather.py:9: UserWarning: is_namedtuple is deprecated, please use the python checks instead
  warnings.warn("is_namedtuple is deprecated, please use the python checks instead")
/usr/local/lib/python3.8/dist-packages/torch/nn/parallel/scatter_gather.py:9: UserWarning: is_namedtuple is deprecated, please use the python checks instead
  warnings.warn("is_namedtuple is deprecated, please use the python checks instead")
/usr/local/lib/python3.8/dist-packages/torch/nn/parallel/scatter_gather.py:9: UserWarning: is_namedtuple is deprecated, please use the python checks instead
  warnings.warn("is_namedtuple is deprecated, please use the python checks instead")
/usr/local/lib/python3.8/dist-packages/torch/nn/parallel/scatter_gather.py:9: UserWarning: is_namedtuple is deprecated, please use the python checks instead
  warnings.warn("is_namedtuple is deprecated, please use the python checks instead")
/usr/local/lib/python3.8/dist-packages/torch/nn/parallel/scatter_gather.py:9: UserWarning: is_namedtuple is deprecated, please use the python checks instead
  warnings.warn("is_namedtuple is deprecated, please use the python checks instead")
