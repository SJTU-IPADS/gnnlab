[2022-12-05 16:01:54.285388: W /samgraph/samgraph/common/cpu/mmap_cpu_device.cc:92] mmap allocating space 12.03 GB
[2022-12-05 16:01:54.285461: W /samgraph/samgraph/common/cpu/mmap_cpu_device.cc:97] mmap allocating space 12.03 GB done
[2022-12-05 16:01:57.802749: W /samgraph/samgraph/common/cpu/mmap_cpu_device.cc:92] mmap allocating space 52.96 GB
[2022-12-05 16:01:57.802847: W /samgraph/samgraph/common/cpu/mmap_cpu_device.cc:97] mmap allocating space 52.96 GB done
[2022-12-05 16:01:57.802896: W /samgraph/samgraph/common/cpu/cpu_device.cc:39] WORKER[0] alloc host memory 12.03 GB
[2022-12-05 16:01:58.729632: E /samgraph/samgraph/common/engine.cc:272] Train set size 30.58 MB
[2022-12-05 16:01:58.730009: W /samgraph/samgraph/common/cpu/mmap_cpu_device.cc:92] mmap allocating space 68.50 GB
[2022-12-05 16:01:58.730030: W /samgraph/samgraph/common/cpu/mmap_cpu_device.cc:97] mmap allocating space 68.50 GB done
/usr/lib/python3/dist-packages/requests/__init__.py:89: RequestsDependencyWarning: urllib3 (1.26.12) or chardet (3.0.4) doesn't match a supported version!
  warnings.warn("urllib3 ({}) or chardet ({}) doesn't match a supported "
[2022-12-05 16:02:00.  3294: W /samgraph/samgraph/common/dist/dist_engine.cc:662] Trainer[0] initializing...
[2022-12-05 16:02:00. 58254: W /samgraph/samgraph/common/dist/dist_engine.cc:662] Trainer[5] initializing...
[2022-12-05 16:02:00. 80903: W /samgraph/samgraph/common/dist/dist_engine.cc:662] Trainer[2] initializing...
[2022-12-05 16:02:00.118329: W /samgraph/samgraph/common/dist/dist_engine.cc:662] Trainer[1] initializing...
[2022-12-05 16:02:00.219437: W /samgraph/samgraph/common/dist/dist_engine.cc:662] Trainer[3] initializing...
[2022-12-05 16:02:00.262310: W /samgraph/samgraph/common/dist/dist_engine.cc:662] Trainer[4] initializing...
[2022-12-05 16:02:01.526435: W /samgraph/samgraph/common/dist/dist_engine.cc:666] Trainer[0] pin memory queue...
[2022-12-05 16:02:01.534807: W /samgraph/samgraph/common/dist/dist_engine.cc:666] Trainer[5] pin memory queue...
[2022-12-05 16:02:01.543099: W /samgraph/samgraph/common/dist/dist_engine.cc:666] Trainer[1] pin memory queue...
[2022-12-05 16:02:01.549460: W /samgraph/samgraph/common/dist/dist_engine.cc:666] Trainer[2] pin memory queue...
[2022-12-05 16:02:01.564868: W /samgraph/samgraph/common/dist/dist_engine.cc:666] Trainer[4] pin memory queue...
[2022-12-05 16:02:01.576507: W /samgraph/samgraph/common/dist/dist_engine.cc:666] Trainer[3] pin memory queue...
[2022-12-05 16:02:21.404828: E /samgraph/samgraph/common/dist/dist_engine.cc:85] Running on A100
[2022-12-05 16:02:21.405875: E /samgraph/samgraph/common/dist/dist_engine.cc:85] Running on A100
[2022-12-05 16:02:21.406242: W /samgraph/samgraph/common/dist/dist_engine.cc:701] Trainer[4] register host memory...
[2022-12-05 16:02:21.407057: W /samgraph/samgraph/common/dist/dist_engine.cc:701] Trainer[3] register host memory...
[2022-12-05 16:02:21.407717: E /samgraph/samgraph/common/dist/dist_engine.cc:85] Running on A100
[2022-12-05 16:02:21.408850: W /samgraph/samgraph/common/dist/dist_engine.cc:701] Trainer[0] register host memory...
[2022-12-05 16:02:21.433301: E /samgraph/samgraph/common/dist/dist_engine.cc:85] Running on A100
[2022-12-05 16:02:21.433873: W /samgraph/samgraph/common/dist/dist_engine.cc:701] Trainer[1] register host memory...
[2022-12-05 16:02:21.458742: E /samgraph/samgraph/common/dist/dist_engine.cc:85] Running on A100
[2022-12-05 16:02:21.458899: W /samgraph/samgraph/common/dist/dist_engine.cc:701] Trainer[5] register host memory...
[2022-12-05 16:02:21.469687: E /samgraph/samgraph/common/dist/dist_engine.cc:85] Running on A100
[2022-12-05 16:02:21.469740: W /samgraph/samgraph/common/dist/dist_engine.cc:701] Trainer[2] register host memory...
[2022-12-05 16:02:21.608558: E /samgraph/samgraph/common/dist/dist_engine.cc:85] Running on A100
[2022-12-05 16:02:21.619377: E /samgraph/samgraph/common/dist/dist_engine.cc:85] Running on A100
[2022-12-05 16:02:21.619489: W /samgraph/samgraph/common/cpu/cpu_device.cc:39] WORKER[0] alloc host memory 30.58 MB
[2022-12-05 16:02:21.628899: W /samgraph/samgraph/common/cuda/cuda_device.cc:49] GPU[6] alloc cuda memory 423.66 MB
[2022-12-05 16:02:21.698365: W /samgraph/samgraph/common/cuda/cuda_device.cc:49] GPU[6] alloc cuda memory 12.03 GB
[2022-12-05 16:02:23.426240: W /samgraph/samgraph/common/cpu/cpu_device.cc:39] WORKER[0] alloc host memory 38.23 MB
[2022-12-05 16:02:23.435403: W /samgraph/samgraph/common/cuda/cuda_device.cc:49] GPU[6] alloc cuda memory 19.12 MB
[2022-12-05 16:02:23.435762: W /samgraph/samgraph/common/cuda/cuda_device.cc:49] GPU[6] alloc cuda memory 256.00 MB
[2022-12-05 16:02:23.435899: W /samgraph/samgraph/common/cuda/cuda_device.cc:49] GPU[6] alloc cuda memory 26.18 MB
[2022-12-05 16:02:23.436258: W /samgraph/samgraph/common/cuda/cuda_device.cc:49] GPU[6] alloc cuda memory 28.56 MB
[2022-12-05 16:02:23.436711: W /samgraph/samgraph/common/cpu/cpu_device.cc:39] WORKER[0] alloc host memory 38.23 MB
[2022-12-05 16:02:23.445284: E /samgraph/samgraph/common/dist/pre_sampler.cc:41] Dist Presampler making shuffler...
[2022-12-05 16:02:23.445322: W /samgraph/samgraph/common/cpu/cpu_device.cc:39] WORKER[0] alloc host memory 38.23 MB
[2022-12-05 16:02:23.454025: W /samgraph/samgraph/common/cuda/cuda_device.cc:49] GPU[6] alloc cuda memory 38.23 MB
[2022-12-05 16:02:23.454052: E /samgraph/samgraph/common/dist/pre_sampler.cc:44] Dist Presampler making shuffler...Done
[2022-12-05 16:02:23.454064: W /samgraph/samgraph/common/cpu/cpu_device.cc:39] WORKER[0] alloc host memory 847.32 MB
[2022-12-05 16:02:23.588434: E /samgraph/samgraph/common/dist/pre_sampler.cc:85] Dist Presampler doing presample epoch 0
[2022-12-05 16:02:23.694531: W /samgraph/samgraph/common/cuda/cuda_device.cc:49] GPU[6] alloc cuda memory 27.22 MB
[2022-12-05 16:02:23.694691: W /samgraph/samgraph/common/cuda/cuda_device.cc:49] GPU[6] alloc cuda memory 27.22 MB
[2022-12-05 16:02:23.694832: W /samgraph/samgraph/common/cuda/cuda_device.cc:49] GPU[6] alloc cuda memory 27.22 MB
[2022-12-05 16:02:23.694951: W /samgraph/samgraph/common/cuda/cuda_device.cc:49] GPU[6] alloc cuda memory 27.22 MB
[2022-12-05 16:02:23.698994: W /samgraph/samgraph/common/cuda/cuda_device.cc:49] GPU[6] alloc cuda memory 24.29 MB
[2022-12-05 16:02:23.699586: W /samgraph/samgraph/common/cpu/cpu_device.cc:39] WORKER[0] alloc host memory 20.38 MB
[2022-12-05 16:02:56.275730: E /samgraph/samgraph/common/dist/pre_sampler.cc:129] presample spend 5.66458 on sample, 0.719434 on copy, 26.2928 on count
[2022-12-05 16:02:56.275814: E /samgraph/samgraph/common/dist/pre_sampler.cc:85] Dist Presampler doing presample epoch 1
[2022-12-05 16:03:29.203022: E /samgraph/samgraph/common/dist/pre_sampler.cc:129] presample spend 11.3935 on sample, 1.44082 on copy, 52.7606 on count
[2022-12-05 16:03:29.203148: E /samgraph/samgraph/common/dist/pre_sampler.cc:136] max_num_inputs = 4310702, min_num_inputs = 4244776
[2022-12-05 16:03:29.472905: E /samgraph/samgraph/common/dist/pre_sampler.cc:148] presample spend 0.269678 on sort freq.
[2022-12-05 16:03:29.636157: E /samgraph/samgraph/common/dist/dist_engine.cc:524] pre sample done, delete it
[[[2022-12-05 16:03:292022-12-05 16:03:29[.[2022-12-05 16:03:29[.2022-12-05 16:03:296546042022-12-05 16:03:29.2022-12-05 16:03:29654608.: .654607.: 654612W654612: 654612W:  : W:  W/samgraph/samgraph/common/dist/dist_engine.ccW W/samgraph/samgraph/common/dist/dist_engine.cc : /samgraph/samgraph/common/dist/dist_engine.cc :/samgraph/samgraph/common/dist/dist_engine.cc711/samgraph/samgraph/common/dist/dist_engine.cc:/samgraph/samgraph/common/dist/dist_engine.cc711:] :711:] 711Trainer[1] building cache...711] 711Trainer[2] building cache...] 
] Trainer[5] building cache...] 
Trainer[0] building cache...Trainer[4] building cache...
Trainer[3] building cache...


[2022-12-05 16:03:29.657175: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] build symm link desc with 6X NVIDIA A100-SXM4-80GB out of 8
[2022-12-05 16:03:29.657210: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:197] remote time is 10.8824
[2022-12-05 16:03:29.657221: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:198] cpu time is 41.1111
[2022-12-05 16:03:29.657613: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] build symm link desc with 6X NVIDIA A100-SXM4-80GB out of 8
[[2022-12-05 16:03:292022-12-05 16:03:29..657645657637: : EE  /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc/samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc::197196] ] remote time is 10.8824build symm link desc with 6X NVIDIA A100-SXM4-80GB out of 8

[2022-12-05 16:03:29.657681: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:198] cpu time is 41.1111
[2022-12-05 16:03:29.657689: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:197] remote time is 10.8824
[2022-12-05 16:03:29.657702: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:198] cpu time is 41.1111
[2022-12-05 16:03:29.657863: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] build symm link desc with 6X NVIDIA A100-SXM4-80GB out of 8
[2022-12-05 16:03:29.657893: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:197] remote time is 10.8824
[2022-12-05 16:03:29.657904: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:198] cpu time is 41.1111
[2022-12-05 16:03:29.658016: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] build symm link desc with 6X NVIDIA A100-SXM4-80GB out of 8
[2022-12-05 16:03:29.658043: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:197] remote time is 10.8824
[2022-12-05 16:03:29.658054: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:198] cpu time is 41.1111
[2022-12-05 16:03:29.665883: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] build symm link desc with 6X NVIDIA A100-SXM4-80GB out of 8
[2022-12-05 16:03:29.665912: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:197] remote time is 10.8824
[2022-12-05 16:03:29.665924: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:198] cpu time is 41.1111
[2022-12-05 16:03:42.928127: E /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:115] solver created. now build & solve
[2022-12-05 16:03:42.975937: E /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:120] solver built. now solve
[2022-12-05 16:03:42.975973: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:895] num_cached_nodes = 11105995
[2022-12-05 16:03:43.969282: E /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:124] solver solved
[2022-12-05 16:03:43.969356: E /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:187] 0 solved master
[2022-12-05 16:03:43.969375: E /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:194] 0 solved
[2022-12-05 16:03:43.969385: E /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:197] worker 0 thread 0 initing device 0
[2022-12-05 16:03:43.983424: E /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:194] 4 solved
[2022-12-05 16:03:43.983475: E /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:197] worker 4 thread 4 initing device 4
[[[[2022-12-05 16:03:432022-12-05 16:03:432022-12-05 16:03:432022-12-05 16:03:43....993718993718993718993718: : : : EEEE    /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc/samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc/samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc/samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc::::194194194194] ] ] ] 5 solved1 solved2 solved3 solved



[2022-12-05 16:03:43[.[[2022-12-05 16:03:439938042022-12-05 16:03:432022-12-05 16:03:43.: ..993804E993805993804:  : : E/samgraph/3rdparty/collcachelib/coll_cache_lib/facade.ccEE :  /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc197/samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc/samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:] ::197worker 5 thread 5 initing device 5197197] 
] ] worker 1 thread 1 initing device 1worker 2 thread 2 initing device 2worker 3 thread 3 initing device 3


[2022-12-05 16:03:44.545837: E /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:1740] Collaborative GPU cache (policy: rep_cache) | local 11105995 / 111059956 nodes ( 10.00 %~10.00 %) | remote 0 / 111059956 nodes ( 0.00 %) | cpu 99953961 / 111059956 nodes ( 90.00 %) | 5.30 GB | 0.550881 secs 
[2022-12-05 16:03:44.546114: E /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:1740] Collaborative GPU cache (policy: rep_cache) | local 11105995 / 111059956 nodes ( 10.00 %~10.00 %) | remote 0 / 111059956 nodes ( 0.00 %) | cpu 99953961 / 111059956 nodes ( 90.00 %) | 5.30 GB | 0.551185 secs 
[2022-12-05 16:03:44.546433: E /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:1740] Collaborative GPU cache (policy: rep_cache) | local 11105995 / 111059956 nodes ( 10.00 %~10.00 %) | remote 0 / 111059956 nodes ( 0.00 %) | cpu 99953961 / 111059956 nodes ( 90.00 %) | 5.30 GB | 0.551523 secs 
[2022-12-05 16:03:44.547066: E /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:1740] Collaborative GPU cache (policy: rep_cache) | local 11105995 / 111059956 nodes ( 10.00 %~10.00 %) | remote 0 / 111059956 nodes ( 0.00 %) | cpu 99953961 / 111059956 nodes ( 90.00 %) | 5.30 GB | 0.562852 secs 
[2022-12-05 16:03:44.547366: E /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:1740] Collaborative GPU cache (policy: rep_cache) | local 11105995 / 111059956 nodes ( 10.00 %~10.00 %) | remote 0 / 111059956 nodes ( 0.00 %) | cpu 99953961 / 111059956 nodes ( 90.00 %) | 5.30 GB | 0.55239 secs 
[2022-12-05 16:03:44.547631: E /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:1740] Collaborative GPU cache (policy: rep_cache) | local 11105995 / 111059956 nodes ( 10.00 %~10.00 %) | remote 0 / 111059956 nodes ( 0.00 %) | cpu 99953961 / 111059956 nodes ( 90.00 %) | 5.30 GB | 0.577517 secs 
[2022-12-05 16:03:51.929543: W /samgraph/samgraph/common/cuda/cuda_device.cc:49] GPU[0] alloc cuda memory 22.29 MB
[2022-12-05 16:03:51.930692: W /samgraph/samgraph/common/cuda/cuda_device.cc:49] GPU[0] alloc cuda memory 26.76 MB
[2022-12-05 16:03:51.931754: W /samgraph/samgraph/common/cuda/cuda_device.cc:49] GPU[0] alloc cuda memory 26.76 MB
[2022-12-05 16:03:51.943913: W /samgraph/samgraph/common/cuda/cuda_device.cc:49] GPU[0] alloc cuda memory 2.23 GB
[2022-12-05 16:03:53.337029: W /samgraph/samgraph/common/cuda/cuda_device.cc:49] GPU[0] alloc cuda memory 20.42 MB
[2022-12-05 16:03:53.338175: W /samgraph/samgraph/common/cuda/cuda_device.cc:49] GPU[0] alloc cuda memory 24.36 MB
[2022-12-05 16:03:53.339240: W /samgraph/samgraph/common/cuda/cuda_device.cc:49] GPU[0] alloc cuda memory 24.36 MB
[2022-12-05 16:03:53.349688: W /samgraph/samgraph/common/cuda/cuda_device.cc:49] GPU[0] alloc cuda memory 2.23 GB
/usr/local/lib/python3.8/dist-packages/torch/nn/parallel/scatter_gather.py:9: UserWarning: is_namedtuple is deprecated, please use the python checks instead
  warnings.warn("is_namedtuple is deprecated, please use the python checks instead")
/usr/local/lib/python3.8/dist-packages/torch/nn/parallel/scatter_gather.py:9: UserWarning: is_namedtuple is deprecated, please use the python checks instead
  warnings.warn("is_namedtuple is deprecated, please use the python checks instead")
/usr/local/lib/python3.8/dist-packages/torch/nn/parallel/scatter_gather.py:9: UserWarning: is_namedtuple is deprecated, please use the python checks instead
  warnings.warn("is_namedtuple is deprecated, please use the python checks instead")
/usr/local/lib/python3.8/dist-packages/torch/nn/parallel/scatter_gather.py:9: UserWarning: is_namedtuple is deprecated, please use the python checks instead
  warnings.warn("is_namedtuple is deprecated, please use the python checks instead")
/usr/local/lib/python3.8/dist-packages/torch/nn/parallel/scatter_gather.py:9: UserWarning: is_namedtuple is deprecated, please use the python checks instead
  warnings.warn("is_namedtuple is deprecated, please use the python checks instead")
/usr/local/lib/python3.8/dist-packages/torch/nn/parallel/scatter_gather.py:9: UserWarning: is_namedtuple is deprecated, please use the python checks instead
  warnings.warn("is_namedtuple is deprecated, please use the python checks instead")
