[2022-12-06 07:47:23.700486: W /samgraph/samgraph/common/cpu/mmap_cpu_device.cc:92] mmap allocating space 12.87 GB
[2022-12-06 07:47:23.700565: W /samgraph/samgraph/common/cpu/mmap_cpu_device.cc:97] mmap allocating space 12.87 GB done
[2022-12-06 07:47:27.700178: W /samgraph/samgraph/common/cpu/mmap_cpu_device.cc:92] mmap allocating space 349.28 GB
[2022-12-06 07:47:27.700292: W /samgraph/samgraph/common/cpu/mmap_cpu_device.cc:97] mmap allocating space 349.28 GB done
[2022-12-06 07:47:27.700313: W /samgraph/samgraph/common/cpu/mmap_cpu_device.cc:92] mmap allocating space 1.82 GB
[2022-12-06 07:47:27.700326: W /samgraph/samgraph/common/cpu/mmap_cpu_device.cc:97] mmap allocating space 1.82 GB done
[2022-12-06 07:47:27.702689: W /samgraph/samgraph/common/cpu/mmap_cpu_device.cc:92] mmap allocating space 29.97 GB
[2022-12-06 07:47:27.702726: W /samgraph/samgraph/common/cpu/mmap_cpu_device.cc:97] mmap allocating space 29.97 GB done
/usr/lib/python3/dist-packages/requests/__init__.py:89: RequestsDependencyWarning: urllib3 (1.26.12) or chardet (3.0.4) doesn't match a supported version!
  warnings.warn("urllib3 ({}) or chardet ({}) doesn't match a supported "
[2022-12-06 07:47:28.977603: W /samgraph/samgraph/common/dist/dist_engine.cc:662] Trainer[0] initializing...
[2022-12-06 07:47:29. 19854: W /samgraph/samgraph/common/dist/dist_engine.cc:662] Trainer[2] initializing...
[2022-12-06 07:47:29. 64087: W /samgraph/samgraph/common/dist/dist_engine.cc:662] Trainer[3] initializing...
[2022-12-06 07:47:29. 93839: W /samgraph/samgraph/common/dist/dist_engine.cc:662] Trainer[5] initializing...
[2022-12-06 07:47:29.138483: W /samgraph/samgraph/common/dist/dist_engine.cc:662] Trainer[4] initializing...
[2022-12-06 07:47:29.174897: W /samgraph/samgraph/common/dist/dist_engine.cc:662] Trainer[1] initializing...
[2022-12-06 07:47:30.543575: W /samgraph/samgraph/common/dist/dist_engine.cc:666] Trainer[0] pin memory queue...
[2022-12-06 07:47:30.559795: W /samgraph/samgraph/common/dist/dist_engine.cc:666] Trainer[3] pin memory queue...
[2022-12-06 07:47:30.564288: W /samgraph/samgraph/common/dist/dist_engine.cc:666] Trainer[2] pin memory queue...
[2022-12-06 07:47:30.567635: W /samgraph/samgraph/common/dist/dist_engine.cc:666] Trainer[5] pin memory queue...
[2022-12-06 07:47:30.568621: W /samgraph/samgraph/common/dist/dist_engine.cc:666] Trainer[1] pin memory queue...
[2022-12-06 07:47:30.573620: W /samgraph/samgraph/common/dist/dist_engine.cc:666] Trainer[4] pin memory queue...
[2022-12-06 07:47:39.504139: E /samgraph/samgraph/common/dist/dist_engine.cc:85] Running on A100
[2022-12-06 07:47:39.504420: E /samgraph/samgraph/common/dist/dist_engine.cc:85] Running on A100
[2022-12-06 07:47:39.505132: W /samgraph/samgraph/common/dist/dist_engine.cc:701] Trainer[3] register host memory...
[2022-12-06 07:47:39.505351: W /samgraph/samgraph/common/dist/dist_engine.cc:701] Trainer[1] register host memory...
[2022-12-06 07:47:39.507750: E /samgraph/samgraph/common/dist/dist_engine.cc:85] Running on A100
[2022-12-06 07:47:39.508024: E /samgraph/samgraph/common/dist/dist_engine.cc:85] Running on A100
[2022-12-06 07:47:39.508783: W /samgraph/samgraph/common/dist/dist_engine.cc:701] Trainer[5] register host memory...
[2022-12-06 07:47:39.509022: W /samgraph/samgraph/common/dist/dist_engine.cc:701] Trainer[4] register host memory...
[2022-12-06 07:47:39.516728: E /samgraph/samgraph/common/dist/dist_engine.cc:85] Running on A100
[2022-12-06 07:47:39.517389: W /samgraph/samgraph/common/dist/dist_engine.cc:701] Trainer[2] register host memory...
[2022-12-06 07:47:39.539552: E /samgraph/samgraph/common/dist/dist_engine.cc:85] Running on A100
[2022-12-06 07:47:39.539936: W /samgraph/samgraph/common/dist/dist_engine.cc:701] Trainer[0] register host memory...
[2022-12-06 07:47:39.737678: E /samgraph/samgraph/common/dist/dist_engine.cc:85] Running on A100
[2022-12-06 07:47:39.754586: E /samgraph/samgraph/common/dist/dist_engine.cc:85] Running on A100
[2022-12-06 07:47:39.757736: W /samgraph/samgraph/common/cuda/cuda_device.cc:49] GPU[6] alloc cuda memory 931.40 MB
[2022-12-06 07:47:39.867114: W /samgraph/samgraph/common/cuda/cuda_device.cc:49] GPU[6] alloc cuda memory 12.87 GB
[2022-12-06 07:47:41.581104: W /samgraph/samgraph/common/cuda/cuda_device.cc:49] GPU[6] alloc cuda memory 32.00 MB
[2022-12-06 07:47:41.583838: E /samgraph/samgraph/common/dist/pre_sampler.cc:41] Dist Presampler making shuffler...
[2022-12-06 07:47:41.585996: E /samgraph/samgraph/common/dist/pre_sampler.cc:44] Dist Presampler making shuffler...Done
[2022-12-06 07:47:41.586022: W /samgraph/samgraph/common/cpu/cpu_device.cc:39] WORKER[0] alloc host memory 1.82 GB
[2022-12-06 07:47:41.881625: E /samgraph/samgraph/common/dist/pre_sampler.cc:85] Dist Presampler doing presample epoch 0
[2022-12-06 07:47:43. 91595: E /samgraph/samgraph/common/dist/pre_sampler.cc:129] presample spend 0.5129 on sample, 0.0330762 on copy, 0.660778 on count
[2022-12-06 07:47:43. 91665: E /samgraph/samgraph/common/dist/pre_sampler.cc:85] Dist Presampler doing presample epoch 1
[2022-12-06 07:47:44.299819: E /samgraph/samgraph/common/dist/pre_sampler.cc:129] presample spend 1.02638 on sample, 0.0657529 on copy, 1.31971 on count
[2022-12-06 07:47:44.299909: E /samgraph/samgraph/common/dist/pre_sampler.cc:136] max_num_inputs = 315666, min_num_inputs = 293248
[2022-12-06 07:47:44.781866: E /samgraph/samgraph/common/dist/pre_sampler.cc:148] presample spend 0.481891 on sort freq.
[2022-12-06 07:47:45.122435: E /samgraph/samgraph/common/dist/dist_engine.cc:524] pre sample done, delete it
[[[[[2022-12-06 07:47:452022-12-06 07:47:45[2022-12-06 07:47:452022-12-06 07:47:452022-12-06 07:47:45..2022-12-06 07:47:45...160406160421.160415160412160405: : 160421: : : WW: WWW  W   /samgraph/samgraph/common/dist/dist_engine.cc/samgraph/samgraph/common/dist/dist_engine.cc /samgraph/samgraph/common/dist/dist_engine.cc/samgraph/samgraph/common/dist/dist_engine.cc/samgraph/samgraph/common/dist/dist_engine.cc::/samgraph/samgraph/common/dist/dist_engine.cc:::711711:711711711] ] Trainer[1] building cache...711
] ] ] Trainer[2] building cache...Trainer[4] building cache...] Trainer[0] building cache...Trainer[3] building cache...

Trainer[5] building cache...


[[2022-12-06 07:47:45[2022-12-06 07:47:45.2022-12-06 07:47:45.161358.161359: 161364: E: E E /samgraph/3rdparty/collcachelib/coll_cache_lib/run_config.cc /samgraph/3rdparty/collcachelib/coll_cache_lib/run_config.cc:/samgraph/3rdparty/collcachelib/coll_cache_lib/run_config.cc:134:134] 134] using concurrent impl MPS] using concurrent impl MPS
using concurrent impl MPS

[2022-12-06 07:47:45.162226: E /samgraph/3rdparty/collcachelib/coll_cache_lib/run_config.cc:134] using concurrent impl MPS
[2022-12-06 07:47:45.162266: E[ /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] build symm link desc with 6X NVIDIA A100-SXM4-80GB out of 82022-12-06 07:47:45
.162265: E /samgraph/3rdparty/collcachelib/coll_cache_lib/run_config.cc:134] using concurrent impl MPS
[2022-12-06 07:47:45.162301: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:197] remote time is 10.8824
[2022-12-06 07:47:45.162313: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:198] cpu time is 41.1111
[2022-12-06 07:47:45.162610: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] build symm link desc with 6X NVIDIA A100-SXM4-80GB out of 8
[2022-12-06 07:47:45.162630: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:197] remote time is 10.8824
[2022-12-06 07:47:45.162641: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:198] cpu time is 41.1111
[2022-12-06 07:47:45.162754: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] build symm link desc with 6X NVIDIA A100-SXM4-80GB out of 8
[2022-12-06 07:47:45.162772: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:197] remote time is 10.8824
[2022-12-06 07:47:45.162783: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:198] cpu time is 41.1111
[2022-12-06 07:47:45.163296: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] build symm link desc with 6X NVIDIA A100-SXM4-80GB out of 8
[2022-12-06 07:47:45.163332: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:197] remote time is 10.8824
[2022-12-06 07:47:45.163343: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:198] cpu time is 41.1111
[2022-12-06 07:47:45.163420: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] build symm link desc with 6X NVIDIA A100-SXM4-80GB out of 8
[2022-12-06 07:47:45.163442: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:197] remote time is 10.8824
[2022-12-06 07:47:45.163453: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:198] cpu time is 41.1111
[2022-12-06 07:47:45.204621: E /samgraph/3rdparty/collcachelib/coll_cache_lib/run_config.cc:134] using concurrent impl MPS
[2022-12-06 07:47:45.205689: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] build symm link desc with 6X NVIDIA A100-SXM4-80GB out of 8
[2022-12-06 07:47:45.205715: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:197] remote time is 10.8824
[2022-12-06 07:47:45.205726: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:198] cpu time is 41.1111
[2022-12-06 07:49:11.586438: E /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:115] solver created. now build & solve
[2022-12-06 07:49:11.665528: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cpu/cpu_device.cc:39] WORKER[0] alloc host memory 931.40 MB
[2022-12-06 07:49:11.665579: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cpu/cpu_device.cc:39] WORKER[0] alloc host memory 931.40 MB
[2022-12-06 07:49:11.666125: W /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:68] mapping nid to rank...
[2022-12-06 07:49:12.113361: W /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:85] counting slots...
[2022-12-06 07:49:13.712401: W /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:99] Final num slot is 25
[2022-12-06 07:49:13.712477: W /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:103] counting blocks...
[2022-12-06 07:49:26.575957: W /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:112] Final num block is 1014
[2022-12-06 07:49:26.576030: W /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:117] counting freq and density...
[2022-12-06 07:49:29.419197: W /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:148] averaging freq and density...
[2022-12-06 07:49:29.419309: W /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:149] 1014
[2022-12-06 07:49:29.423534: E /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:120] solver built. now solve
[2022-12-06 07:49:29.423570: W /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:348] constructing optimal solver, device=6, stream=1
1014 blocks, 6 devices
[2022-12-06 07:49:30.366506: W /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:503] Add Var...
[2022-12-06 07:49:30.386246: W /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:521] Capacity...
[2022-12-06 07:49:30.387112: W /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:524] Connect CPU...
[2022-12-06 07:49:30.398831: W /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:526] Connect Access To Storage...
[2022-12-06 07:49:30.659198: W /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:530] Time...
[2022-12-06 07:49:36.396720: W /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:545] Coll Cache init block placement array
[2022-12-06 07:49:36.399896: W /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:621] Coll Cache init block placement array done
[2022-12-06 07:49:36.400022: W /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:623] Coll Cache model reset done
[2022-12-06 07:49:36.418697: E /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:124] solver solved
[2022-12-06 07:49:36.418755: E /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:187] 0 solved master
[2022-12-06 07:49:36.418786: E /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:194] 0 solved
[2022-12-06 07:49:36.418796: E /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:197] worker 0 thread 0 initing device 0
[2022-12-06 07:49:36.421483: E /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:1762] Building Coll Cache with ... num gpu device is 6
[2022-12-06 07:49:36.448091: E /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:194] 1 solved
[2022-12-06 07:49:36.448167: E /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:197] worker 1 thread 1 initing device 1
[2022-12-06 07:49:36.449137: E /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:1762] Building Coll Cache with ... num gpu device is 6
[2022-12-06 07:49:36.467901: E /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:194] 3 solved
[2022-12-06 07:49:36.467966: E /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:197] worker 3 thread 3 initing device 3
[2022-12-06 07:49:36.468924: E /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:1762] Building Coll Cache with ... num gpu device is 6
[2022-12-06 07:49:36.472911: E /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:194] 2 solved
[2022-12-06 07:49:36.472955: E /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:197] worker 2 thread 2 initing device 2
[2022-12-06 07:49:36.473918: E /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:1762] Building Coll Cache with ... num gpu device is 6
[2022-12-06 07:49:36.478863: [E /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:1942022-12-06 07:49:36] .5 solved478878
: E /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:194[] 2022-12-06 07:49:364 solved.
478917: E /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:197[] 2022-12-06 07:49:36worker 5 thread 5 initing device 5.
478925: E /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:197] worker 4 thread 4 initing device 4
[2022-12-06 07:49:36.480079: E /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:1762] Building Coll Cache with ... num gpu device is 6
[2022-12-06 07:49:36.480096: E /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:1762] Building Coll Cache with ... num gpu device is 6
[2022-12-06 07:49:36.581869: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cpu/cpu_device.cc:39] WORKER[0] alloc host memory 55.82 MB
[[[[[[2022-12-06 07:49:382022-12-06 07:49:382022-12-06 07:49:382022-12-06 07:49:382022-12-06 07:49:382022-12-06 07:49:38......453725453732453725453726453726453725: : : : : : EEEEEE      /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu/samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu/samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu/samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu/samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu/samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu::::::187118711871187118711871] ] ] ] ] ] Device 3 init p2p of link 4Device 0 init p2p of link 1Device 2 init p2p of link 3
Device 5 init p2p of link 0Device 4 init p2p of link 5Device 1 init p2p of link 2




[2022-12-06 07:49:38.459958: E /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:1871] Device 2 init p2p of link 4
[2022-12-06 07:49:38.460268: E /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:1871] Device 3 init p2p of link 5
[2022-12-06 07:49:38.460378: E /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:1871] Device 4 init p2p of link 0
[2022-12-06 07:49:38.460515: E /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:1871] Device 5 init p2p of link 1
[2022-12-06 07:49:38.460637: E /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:1871] Device 1 init p2p of link 3
[2022-12-06 07:49:38.460660: E /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:1871] Device 0 init p2p of link 2
[2022-12-06 07:49:38.463767: E /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:1871] Device 2 init p2p of link 5
[2022-12-06 07:49:38.464282: E /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:1871] Device 3 init p2p of link 0
[2022-12-06 07:49:38.465066: E /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:1871] Device 4 init p2p of link 1
[2022-12-06 07:49:38.465160: E /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:1871] Device 5 init p2p of link 2
[2022-12-06 07:49:38.465398: E /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:1871] Device 1 init p2p of link 4
[2022-12-06 07:49:38.465412: E /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:1871] Device 0 init p2p of link 3
[2022-12-06 07:49:38.467260: E /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:1871] Device 2 init p2p of link 0
[2022-12-06 07:49:38.468461: E /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:1871] Device 3 init p2p of link 1
[2022-12-06 07:49:38.469395: E /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:1871] Device 4 init p2p of link 2
[2022-12-06 07:49:38.469449: E /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:1871] Device 5 init p2p of link 3
[2022-12-06 07:49:38.469677: E /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:1871] Device 0 init p2p of link 4
[2022-12-06 07:49:38.469744: E /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:1871] Device 1 init p2p of link 5
[2022-12-06 07:49:38.471035: E /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:1871] Device 2 init p2p of link 1
[2022-12-06 07:49:38.472131: E /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:1871] Device 3 init p2p of link 2
[2022-12-06 07:49:38.473581: E /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:1871] Device 4 init p2p of link 3
[2022-12-06 07:49:38.473681: E /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:1871] Device 5 init p2p of link 4
[2022-12-06 07:49:38.474005: E /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:1871] Device 1 init p2p of link 0
[2022-12-06 07:49:38.474048: E /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:1871] Device 0 init p2p of link 5
[2022-12-06 07:49:38.475652: E /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:1900] Asymm Coll cache (policy: coll_cache_asymm_link) | local 14199111 / 244160499 nodes ( 5.82 %~6.00 %) | remote 23714196 / 244160499 nodes ( 9.71 %) | cpu 206247192 / 244160499 nodes ( 84.47 %) | 20.35 GB | 2.00171 secs 
[2022-12-06 07:49:38.478751: E /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:1900] Asymm Coll cache (policy: coll_cache_asymm_link) | local 14479095 / 244160499 nodes ( 5.93 %~6.00 %) | remote 23434212 / 244160499 nodes ( 9.60 %) | cpu 206247192 / 244160499 nodes ( 84.47 %) | 20.75 GB | 2.0098 secs 
[2022-12-06 07:49:38.481658: E /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:1900] Asymm Coll cache (policy: coll_cache_asymm_link) | local 14145687 / 244160499 nodes ( 5.79 %~6.00 %) | remote 23767620 / 244160499 nodes ( 9.73 %) | cpu 206247192 / 244160499 nodes ( 84.47 %) | 20.27 GB | 2.00155 secs 
[2022-12-06 07:49:38.482269: E /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:1900] Asymm Coll cache (policy: coll_cache_asymm_link) | local 14634007 / 244160499 nodes ( 5.99 %~6.00 %) | remote 23279300 / 244160499 nodes ( 9.53 %) | cpu 206247192 / 244160499 nodes ( 84.47 %) | 20.97 GB | 2.00215 secs 
[2022-12-06 07:49:38.485108: E /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:1900] Asymm Coll cache (policy: coll_cache_asymm_link) | local 14643510 / 244160499 nodes ( 6.00 %~6.00 %) | remote 23269797 / 244160499 nodes ( 9.53 %) | cpu 206247192 / 244160499 nodes ( 84.47 %) | 20.98 GB | 2.03594 secs 
[2022-12-06 07:49:38.485837: E /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:1900] Asymm Coll cache (policy: coll_cache_asymm_link) | local 14634007 / 244160499 nodes ( 5.99 %~6.00 %) | remote 23279300 / 244160499 nodes ( 9.53 %) | cpu 206247192 / 244160499 nodes ( 84.47 %) | 20.97 GB | 2.06432 secs 
[2022-12-06 07:49:38.486321: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:2004] before create ctx, mem is 24.44 GB
[2022-12-06 07:49:40.225345: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:2010] after create ctx, mem is 24.86 GB
[2022-12-06 07:49:40.225438: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:2017] after create stream, mem is 24.86 GB
[2022-12-06 07:49:40.225631: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:2004] before create ctx, mem is 24.86 GB
[2022-12-06 07:49:41.170228: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:2010] after create ctx, mem is 25.29 GB
[2022-12-06 07:49:41.170337: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:2017] after create stream, mem is 25.29 GB
[2022-12-06 07:49:41.170521: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:2004] before create ctx, mem is 25.29 GB
[2022-12-06 07:49:42.307274: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:2010] after create ctx, mem is 25.72 GB
[2022-12-06 07:49:42.307447: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:2017] after create stream, mem is 25.72 GB
[2022-12-06 07:49:42.307657: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:2004] before create ctx, mem is 25.72 GB
[2022-12-06 07:49:43.429562: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:2010] after create ctx, mem is 26.14 GB
[2022-12-06 07:49:43.429654: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:2017] after create stream, mem is 26.14 GB
[2022-12-06 07:49:43.429847: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:2004] before create ctx, mem is 26.14 GB
[2022-12-06 07:49:44.646349: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:2010] after create ctx, mem is 26.57 GB
[2022-12-06 07:49:44.646466: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:2017] after create stream, mem is 26.57 GB
[2022-12-06 07:49:44.646636: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:2004] before create ctx, mem is 26.57 GB
[2022-12-06 07:49:45.862036: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:2010] after create ctx, mem is 27.32 GB
[2022-12-06 07:49:45.862128: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:2017] after create stream, mem is 27.32 GB
[2022-12-06 07:49:45.862444: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:2004] before create ctx, mem is 27.32 GB
[2022-12-06 07:49:46.888579: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:2010] after create ctx, mem is 27.71 GB
[2022-12-06 07:49:46.888669: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:2017] after create stream, mem is 27.71 GB
[[2022-12-06 07:49:47.2022-12-06 07:49:47[. 80799: 2022-12-06 07:49:47 80799E.:  80833 E: /samgraph/3rdparty/collcachelib/coll_cache_lib/run_config.cc E:/samgraph/3rdparty/collcachelib/coll_cache_lib/run_config.cc 134:/samgraph/3rdparty/collcachelib/coll_cache_lib/run_config.cc] 134:[using concurrent impl MPS] 1342022-12-06 07:49:47
using concurrent impl MPS] .
using concurrent impl MPS 80859
: E /samgraph/3rdparty/collcachelib/coll_cache_lib/run_config.cc:134] using concurrent impl MPS
[2022-12-06 07:49:47. 81537: E /samgraph/3rdparty/collcachelib/coll_cache_lib/run_config.cc:134] using concurrent impl MPS
[2022-12-06 07:49:47. 81664: E /samgraph/3rdparty/collcachelib/coll_cache_lib/run_config.cc:134] using concurrent impl MPS
[2022-12-06 07:49:47. 82262: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] build symm link desc with 6X NVIDIA A100-SXM4-80GB out of 8
[2022-12-06 07:49:47. 82292: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:197] remote time is 10.8824
[2022-12-06 07:49:47. 82303: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:198] cpu time is 41.1111
[2022-12-06 07:49:47. 82401: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] build symm link desc with 6X NVIDIA A100-SXM4-80GB out of 8
[2022-12-06 07:49:47. 82420: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:197] remote time is 10.8824
[2022-12-06 07:49:47. 82430: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:198] cpu time is 41.1111
[2022-12-06 07:49:47. 82942: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] build symm link desc with 6X NVIDIA A100-SXM4-80GB out of 8
[2022-12-06 07:49:47. 82969: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:197] remote time is 10.8824
[2022-12-06 07:49:47. 82980: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:198] cpu time is 41.1111
[2022-12-06 07:49:47. 83270: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] build symm link desc with 6X NVIDIA A100-SXM4-80GB out of 8
[2022-12-06 07:49:47. 83300: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:197] remote time is 10.8824
[2022-12-06 07:49:47. 83312: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:198] cpu time is 41.1111
[2022-12-06 07:49:47. 83341: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] build symm link desc with 6X NVIDIA A100-SXM4-80GB out of 8
[2022-12-06 07:49:47. 83362: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:197] remote time is 10.8824
[2022-12-06 07:49:47. 83373: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:198] cpu time is 41.1111
[2022-12-06 07:49:47. 83564: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] build symm link desc with 6X NVIDIA A100-SXM4-80GB out of 8
[2022-12-06 07:49:47. 83584: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:197] remote time is 10.8824
[2022-12-06 07:49:47. 83595: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:198] cpu time is 41.1111
[2022-12-06 07:49:47.534346: E /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:115] solver created. now build & solve
[2022-12-06 07:49:47.566851: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cpu/cpu_device.cc:39] WORKER[0] alloc host memory 931.40 MB
[2022-12-06 07:49:47.566898: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cpu/cpu_device.cc:39] WORKER[0] alloc host memory 931.40 MB
[2022-12-06 07:49:47.566944: W /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:68] mapping nid to rank...
[2022-12-06 07:49:48. 19691: W /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:85] counting slots...
[2022-12-06 07:49:49.665710: W /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:99] Final num slot is 25
[2022-12-06 07:49:49.665764: W /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:103] counting blocks...
[2022-12-06 07:50:03.516791: W /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:112] Final num block is 1014
[2022-12-06 07:50:03.516869: W /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:117] counting freq and density...
[2022-12-06 07:50:06.586041: W /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:148] averaging freq and density...
[2022-12-06 07:50:06.586110: W /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:149] 1014
[2022-12-06 07:50:06.589888: E /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:120] solver built. now solve
[2022-12-06 07:50:06.589922: W /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:348] constructing optimal solver, device=6, stream=1
1014 blocks, 6 devices
[2022-12-06 07:50:06.604284: W /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:503] Add Var...
[2022-12-06 07:50:06.622908: W /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:521] Capacity...
[2022-12-06 07:50:06.623668: W /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:524] Connect CPU...
[2022-12-06 07:50:06.635139: W /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:526] Connect Access To Storage...
[2022-12-06 07:50:06.895832: W /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:530] Time...
[2022-12-06 07:50:12.188679: W /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:545] Coll Cache init block placement array
[2022-12-06 07:50:12.191874: W /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:621] Coll Cache init block placement array done
[2022-12-06 07:50:12.192010: W /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:623] Coll Cache model reset done
[2022-12-06 07:50:12.210394: E /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:124] solver solved
[2022-12-06 07:50:12.210434: E /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:187] 0 solved master
[2022-12-06 07:50:12.210448: E /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:194] 0 solved
[2022-12-06 07:50:12.210459: E /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:197] worker 0 thread 0 initing device 0
[[[2022-12-06 07:50:122022-12-06 07:50:12..2022-12-06 07:50:12239594239594.: : 239594EE:   E/samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc/samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc ::/samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc194194:] ] 194] 2 solved1 solved
3 solved

[2022-12-06 07:50:12.[[2396772022-12-06 07:50:122022-12-06 07:50:12: ..E239679239679 : : /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.ccEE:  197/samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc/samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc] ::worker 2 thread 2 initing device 2197197
] ] worker 1 thread 1 initing device 1worker 3 thread 3 initing device 3

[[2022-12-06 07:50:12.264509: E2022-12-06 07:50:12 ./samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc264504:: 194E]  /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:4 solved194
] 5 solved[
2022-12-06 07:50:12.264571: E /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc[:2022-12-06 07:50:12197.] 264575worker 4 thread 4 initing device 4: 
E /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:197] worker 5 thread 5 initing device 5
[2022-12-06 07:50:15.532210: W /samgraph/samgraph/common/cuda/cuda_device.cc:49] GPU[0] alloc cuda memory 494.17 MB
[2022-12-06 07:50:16.993237: W /samgraph/samgraph/common/cuda/cuda_device.cc:49] GPU[0] alloc cuda memory 494.17 MB
/usr/local/lib/python3.8/dist-packages/torch/nn/parallel/scatter_gather.py:9: UserWarning: is_namedtuple is deprecated, please use the python checks instead
  warnings.warn("is_namedtuple is deprecated, please use the python checks instead")
/usr/local/lib/python3.8/dist-packages/torch/nn/parallel/scatter_gather.py:9: UserWarning: is_namedtuple is deprecated, please use the python checks instead
  warnings.warn("is_namedtuple is deprecated, please use the python checks instead")
/usr/local/lib/python3.8/dist-packages/torch/nn/parallel/scatter_gather.py:9: UserWarning: is_namedtuple is deprecated, please use the python checks instead
  warnings.warn("is_namedtuple is deprecated, please use the python checks instead")
/usr/local/lib/python3.8/dist-packages/torch/nn/parallel/scatter_gather.py:9: UserWarning: is_namedtuple is deprecated, please use the python checks instead
  warnings.warn("is_namedtuple is deprecated, please use the python checks instead")
/usr/local/lib/python3.8/dist-packages/torch/nn/parallel/scatter_gather.py:9: UserWarning: is_namedtuple is deprecated, please use the python checks instead
  warnings.warn("is_namedtuple is deprecated, please use the python checks instead")
/usr/local/lib/python3.8/dist-packages/torch/nn/parallel/scatter_gather.py:9: UserWarning: is_namedtuple is deprecated, please use the python checks instead
  warnings.warn("is_namedtuple is deprecated, please use the python checks instead")
