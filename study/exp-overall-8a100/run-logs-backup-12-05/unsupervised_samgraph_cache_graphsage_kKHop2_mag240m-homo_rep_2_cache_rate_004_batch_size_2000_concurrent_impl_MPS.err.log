[2022-12-05 19:25:41.201786: W /samgraph/samgraph/common/cpu/mmap_cpu_device.cc:92] mmap allocating space 12.87 GB
[2022-12-05 19:25:41.201867: W /samgraph/samgraph/common/cpu/mmap_cpu_device.cc:97] mmap allocating space 12.87 GB done
[2022-12-05 19:25:44.899243: W /samgraph/samgraph/common/cpu/mmap_cpu_device.cc:92] mmap allocating space 349.28 GB
[2022-12-05 19:25:44.899317: W /samgraph/samgraph/common/cpu/mmap_cpu_device.cc:97] mmap allocating space 349.28 GB done
[2022-12-05 19:25:44.899335: W /samgraph/samgraph/common/cpu/mmap_cpu_device.cc:92] mmap allocating space 1.82 GB
[2022-12-05 19:25:44.899349: W /samgraph/samgraph/common/cpu/mmap_cpu_device.cc:97] mmap allocating space 1.82 GB done
[2022-12-05 19:25:44.899387: W /samgraph/samgraph/common/cpu/cpu_device.cc:39] WORKER[0] alloc host memory 12.87 GB
[2022-12-05 19:25:45.529324: E /samgraph/samgraph/common/engine.cc:272] Train set size 7.64 MB
[2022-12-05 19:25:45.529738: W /samgraph/samgraph/common/cpu/mmap_cpu_device.cc:92] mmap allocating space 68.50 GB
[2022-12-05 19:25:45.529758: W /samgraph/samgraph/common/cpu/mmap_cpu_device.cc:97] mmap allocating space 68.50 GB done
/usr/lib/python3/dist-packages/requests/__init__.py:89: RequestsDependencyWarning: urllib3 (1.26.12) or chardet (3.0.4) doesn't match a supported version!
  warnings.warn("urllib3 ({}) or chardet ({}) doesn't match a supported "
[2022-12-05 19:25:46.838575: W /samgraph/samgraph/common/dist/dist_engine.cc:662] Trainer[2] initializing...
[2022-12-05 19:25:46.862485: W /samgraph/samgraph/common/dist/dist_engine.cc:662] Trainer[1] initializing...
[2022-12-05 19:25:46.895143: W /samgraph/samgraph/common/dist/dist_engine.cc:662] Trainer[0] initializing...
[2022-12-05 19:25:46.942690: W /samgraph/samgraph/common/dist/dist_engine.cc:662] Trainer[3] initializing...
[2022-12-05 19:25:46.982300: W /samgraph/samgraph/common/dist/dist_engine.cc:662] Trainer[5] initializing...
[2022-12-05 19:25:47. 88441: W /samgraph/samgraph/common/dist/dist_engine.cc:662] Trainer[4] initializing...
[2022-12-05 19:25:48.376903: W /samgraph/samgraph/common/dist/dist_engine.cc:666] Trainer[0] pin memory queue...
[2022-12-05 19:25:48.380496: W /samgraph/samgraph/common/dist/dist_engine.cc:666] Trainer[1] pin memory queue...
[[2022-12-05 19:25:48.2022-12-05 19:25:48395894.: 395900W:  W/samgraph/samgraph/common/dist/dist_engine.cc :/samgraph/samgraph/common/dist/dist_engine.cc666:] 666] Trainer[5] pin memory queue...Trainer[3] pin memory queue...

[2022-12-05 19:25:48.397589: W /samgraph/samgraph/common/dist/dist_engine.cc:666] Trainer[2] pin memory queue...
[2022-12-05 19:25:48.407991: W /samgraph/samgraph/common/dist/dist_engine.cc:666] Trainer[4] pin memory queue...
[2022-12-05 19:26:08.409771: E /samgraph/samgraph/common/dist/dist_engine.cc:85] Running on A100
[2022-12-05 19:26:08.410509: W /samgraph/samgraph/common/dist/dist_engine.cc:701] Trainer[2] register host memory...
[2022-12-05 19:26:08.412702: E /samgraph/samgraph/common/dist/dist_engine.cc:85] Running on A100
[2022-12-05 19:26:08.412840: E /samgraph/samgraph/common/dist/dist_engine.cc:85] Running on A100
[2022-12-05 19:26:08.413798: W /samgraph/samgraph/common/dist/dist_engine.cc:701] Trainer[4] register host memory...[
2022-12-05 19:26:08.413806: W /samgraph/samgraph/common/dist/dist_engine.cc:701] Trainer[0] register host memory...
[2022-12-05 19:26:08.414877: E /samgraph/samgraph/common/dist/dist_engine.cc:85] Running on A100
[2022-12-05 19:26:08.415515: W /samgraph/samgraph/common/dist/dist_engine.cc:701] Trainer[1] register host memory...
[2022-12-05 19:26:08.465767: E /samgraph/samgraph/common/dist/dist_engine.cc:85] Running on A100
[2022-12-05 19:26:08.465933: W /samgraph/samgraph/common/dist/dist_engine.cc:701] Trainer[3] register host memory...
[2022-12-05 19:26:08.478577: E /samgraph/samgraph/common/dist/dist_engine.cc:85] Running on A100
[2022-12-05 19:26:08.478640: W /samgraph/samgraph/common/dist/dist_engine.cc:701] Trainer[5] register host memory...
[2022-12-05 19:26:08.621382: E /samgraph/samgraph/common/dist/dist_engine.cc:85] Running on A100
[2022-12-05 19:26:08.624635: W /samgraph/samgraph/common/cuda/cuda_device.cc:49] GPU[6] alloc cuda memory 931.40 MB
[2022-12-05 19:26:08.635459: E /samgraph/samgraph/common/dist/dist_engine.cc:85] Running on A100
[2022-12-05 19:26:08.762979: W /samgraph/samgraph/common/cuda/cuda_device.cc:49] GPU[6] alloc cuda memory 12.87 GB
[2022-12-05 19:26:10.579082: W /samgraph/samgraph/common/cuda/cuda_device.cc:49] GPU[6] alloc cuda memory 64.00 MB
[2022-12-05 19:26:10.582551: E /samgraph/samgraph/common/dist/pre_sampler.cc:41] Dist Presampler making shuffler...
[2022-12-05 19:26:10.585108: E /samgraph/samgraph/common/dist/pre_sampler.cc:44] Dist Presampler making shuffler...Done
[2022-12-05 19:26:10.585133: W /samgraph/samgraph/common/cpu/cpu_device.cc:39] WORKER[0] alloc host memory 1.82 GB
[2022-12-05 19:26:10.874112: E /samgraph/samgraph/common/dist/pre_sampler.cc:85] Dist Presampler doing presample epoch 0
[2022-12-05 19:26:18.489248: E /samgraph/samgraph/common/dist/pre_sampler.cc:129] presample spend 1.73871 on sample, 0.171973 on copy, 5.69703 on count
[2022-12-05 19:26:18.489368: E /samgraph/samgraph/common/dist/pre_sampler.cc:85] Dist Presampler doing presample epoch 1
[2022-12-05 19:26:26.221756: E /samgraph/samgraph/common/dist/pre_sampler.cc:129] presample spend 3.4755 on sample, 0.342861 on copy, 11.5145 on count
[2022-12-05 19:26:26.221855: E /samgraph/samgraph/common/dist/pre_sampler.cc:136] max_num_inputs = 974413, min_num_inputs = 929184
[2022-12-05 19:26:26.780399: E /samgraph/samgraph/common/dist/pre_sampler.cc:148] presample spend 0.55846 on sort freq.
[2022-12-05 19:26:27.122036: E /samgraph/samgraph/common/dist/dist_engine.cc:524] pre sample done, delete it
[[[[2022-12-05 19:26:272022-12-05 19:26:27[[2022-12-05 19:26:272022-12-05 19:26:27..2022-12-05 19:26:27.2022-12-05 19:26:27.163268163265.163264.163270: : 163282: 163282: WW: W: W  W W /samgraph/samgraph/common/dist/dist_engine.cc/samgraph/samgraph/common/dist/dist_engine.cc /samgraph/samgraph/common/dist/dist_engine.cc /samgraph/samgraph/common/dist/dist_engine.cc::/samgraph/samgraph/common/dist/dist_engine.cc:/samgraph/samgraph/common/dist/dist_engine.cc:711711:711:711] ] 711] 711] Trainer[0] building cache...Trainer[4] building cache...] Trainer[2] building cache...] Trainer[3] building cache...

Trainer[1] building cache...
Trainer[5] building cache...


[[[2022-12-05 19:26:272022-12-05 19:26:272022-12-05 19:26:27...164700164701164701: : : EEE   /samgraph/3rdparty/collcachelib/coll_cache_lib/run_config.cc/samgraph/3rdparty/collcachelib/coll_cache_lib/run_config.cc/samgraph/3rdparty/collcachelib/coll_cache_lib/run_config.cc:::134134134] ] ] using concurrent impl MPSusing concurrent impl MPSusing concurrent impl MPS


[2022-12-05 19:26:27.164750: E /samgraph/3rdparty/collcachelib/coll_cache_lib/run_config.cc:134] using concurrent impl MPS
[2022-12-05 19:26:27.164812: E /samgraph/3rdparty/collcachelib/coll_cache_lib/run_config.cc:134] using concurrent impl MPS
[2022-12-05 19:26:27.165828: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] build symm link desc with 6X NVIDIA A100-SXM4-80GB out of 8
[2022-12-05 19:26:27.165860: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:197] remote time is 10.8824
[2022-12-05 19:26:27.165871: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:198] cpu time is 41.1111
[2022-12-05 19:26:27.166191: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] build symm link desc with 6X NVIDIA A100-SXM4-80GB out of 8
[2022-12-05 19:26:27.166218: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:197] remote time is 10.8824
[2022-12-05 19:26:27.166229: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:198] cpu time is 41.1111
[2022-12-05 19:26:27.166578: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] build symm link desc with 6X NVIDIA A100-SXM4-80GB out of 8
[2022-12-05 19:26:27.166601: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:197] remote time is 10.8824
[2022-12-05 19:26:27.166620: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:198] cpu time is 41.1111
[2022-12-05 19:26:27.166658: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] build symm link desc with 6X NVIDIA A100-SXM4-80GB out of 8
[2022-12-05 19:26:27.166680: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:197] remote time is 10.8824
[2022-12-05 19:26:27.166691: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:198] cpu time is 41.1111
[2022-12-05 19:26:27.166826: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] build symm link desc with 6X NVIDIA A100-SXM4-80GB out of 8
[2022-12-05 19:26:27.166856: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:197] remote time is 10.8824
[2022-12-05 19:26:27.166868: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:198] cpu time is 41.1111
[2022-12-05 19:26:27.215050: E /samgraph/3rdparty/collcachelib/coll_cache_lib/run_config.cc:134] using concurrent impl MPS
[2022-12-05 19:26:27.216166: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] build symm link desc with 6X NVIDIA A100-SXM4-80GB out of 8
[2022-12-05 19:26:27.216202: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:197] remote time is 10.8824
[2022-12-05 19:26:27.216213: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:198] cpu time is 41.1111
[2022-12-05 19:27:58.885317: E /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:115] solver created. now build & solve
[2022-12-05 19:27:58.978577: E /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:120] solver built. now solve
[2022-12-05 19:27:58.978618: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:895] num_cached_nodes = 9766419
[2022-12-05 19:28:00.838112: E /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:124] solver solved
[2022-12-05 19:28:00.838199: E /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:187] 0 solved master
[2022-12-05 19:28:00.838218: E /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:194] 0 solved
[2022-12-05 19:28:00.838229: E /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:197] worker 0 thread 0 initing device 0
[[2022-12-05 19:28:00[.2022-12-05 19:28:002022-12-05 19:28:00889298..: 889321889321E: :  EE/samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc  :/samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc/samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc194::] 194194] 2 solved] 5 solved4 solved


[2022-12-05 19:28:00[[.2022-12-05 19:28:002022-12-05 19:28:00889372..: 889372889373E: :  EE/samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc  :/samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc/samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc197::] 197197worker 2 thread 2 initing device 2] ] 
worker 5 thread 5 initing device 5worker 4 thread 4 initing device 4

[2022-12-05 19:28:00.891748: E /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:194] 3 solved
[[2022-12-05 19:28:002022-12-05 19:28:00..891798891778: : EE  /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc/samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc::197194] ] worker 3 thread 3 initing device 31 solved

[2022-12-05 19:28:00.891819: E /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:197] worker 1 thread 1 initing device 1
[2022-12-05 19:28:02.314444: E /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:1740] Collaborative GPU cache (policy: rep_cache) | local 9766419 / 244160499 nodes ( 4.00 %~4.00 %) | remote 0 / 244160499 nodes ( 0.00 %) | cpu 234394080 / 244160499 nodes ( 96.00 %) | 13.97 GB | 1.42372 secs 
[2022-12-05 19:28:02.315765: E /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:1740] Collaborative GPU cache (policy: rep_cache) | local 9766419 / 244160499 nodes ( 4.00 %~4.00 %) | remote 0 / 244160499 nodes ( 0.00 %) | cpu 234394080 / 244160499 nodes ( 96.00 %) | 13.97 GB | 1.42515 secs 
[2022-12-05 19:28:02.317561: E /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:1740] Collaborative GPU cache (policy: rep_cache) | local 9766419 / 244160499 nodes ( 4.00 %~4.00 %) | remote 0 / 244160499 nodes ( 0.00 %) | cpu 234394080 / 244160499 nodes ( 96.00 %) | 13.97 GB | 1.4268 secs 
[2022-12-05 19:28:02.319300: E /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:1740] Collaborative GPU cache (policy: rep_cache) | local 9766419 / 244160499 nodes ( 4.00 %~4.00 %) | remote 0 / 244160499 nodes ( 0.00 %) | cpu 234394080 / 244160499 nodes ( 96.00 %) | 13.97 GB | 1.46536 secs 
[2022-12-05 19:28:02.320340: E /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:1740] Collaborative GPU cache (policy: rep_cache) | local 9766419 / 244160499 nodes ( 4.00 %~4.00 %) | remote 0 / 244160499 nodes ( 0.00 %) | cpu 234394080 / 244160499 nodes ( 96.00 %) | 13.97 GB | 1.42509 secs 
[[2022-12-05 19:28:02.2022-12-05 19:28:02321673.: 321667E:  W/samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu :/samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu1740:] 2004] Collaborative GPU cache (policy: rep_cache) | local 9766419 / 244160499 nodes ( 4.00 %~4.00 %) | remote 0 / 244160499 nodes ( 0.00 %) | cpu 234394080 / 244160499 nodes ( 96.00 %) | 13.97 GB | 1.42676 secs before create ctx, mem is 17.51 GB

[2022-12-05 19:28:03.474462: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:2010] after create ctx, mem is 17.94 GB
[2022-12-05 19:28:03.474585: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:2017] after create stream, mem is 17.94 GB
[2022-12-05 19:28:03.474846: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:2004] before create ctx, mem is 17.94 GB
[2022-12-05 19:28:04.649037: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:2010] after create ctx, mem is 18.37 GB
[2022-12-05 19:28:04.652548: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:2017] after create stream, mem is 18.37 GB
[2022-12-05 19:28:04.653419: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:2004] before create ctx, mem is 18.37 GB
[2022-12-05 19:28:06.  1852: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:2010] after create ctx, mem is 18.79 GB
[2022-12-05 19:28:06.  1959: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:2017] after create stream, mem is 18.79 GB
[2022-12-05 19:28:06.  2245: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:2004] before create ctx, mem is 18.79 GB
[2022-12-05 19:28:07.162098: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:2010] after create ctx, mem is 19.22 GB
[2022-12-05 19:28:07.162196: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:2017] after create stream, mem is 19.22 GB
[2022-12-05 19:28:07.162393: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:2004] before create ctx, mem is 19.22 GB
[2022-12-05 19:28:08.379219: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:2010] after create ctx, mem is 19.65 GB
[2022-12-05 19:28:08.379336: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:2017] after create stream, mem is 19.65 GB
[2022-12-05 19:28:08.379522: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:2004] before create ctx, mem is 19.65 GB
[2022-12-05 19:28:09.881309: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:2010] after create ctx, mem is 20.40 GB
[2022-12-05 19:28:09.882211: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:2017] after create stream, mem is 20.40 GB
[2022-12-05 19:28:09.882470: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:2004] before create ctx, mem is 20.40 GB
[2022-12-05 19:28:11.521917: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:2010] after create ctx, mem is 20.79 GB
[2022-12-05 19:28:11.522043: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:2017] after create stream, mem is 20.79 GB
[2022-12-05 19:28:15.311494: W /samgraph/samgraph/common/cuda/cuda_device.cc:49] GPU[0] alloc cuda memory 1.49 GB
[2022-12-05 19:28:17.396399: W /samgraph/samgraph/common/cuda/cuda_device.cc:49] GPU[0] alloc cuda memory 1.49 GB
/usr/local/lib/python3.8/dist-packages/torch/nn/parallel/scatter_gather.py:9: UserWarning: is_namedtuple is deprecated, please use the python checks instead
  warnings.warn("is_namedtuple is deprecated, please use the python checks instead")
/usr/local/lib/python3.8/dist-packages/torch/nn/parallel/scatter_gather.py:9: UserWarning: is_namedtuple is deprecated, please use the python checks instead
  warnings.warn("is_namedtuple is deprecated, please use the python checks instead")
/usr/local/lib/python3.8/dist-packages/torch/nn/parallel/scatter_gather.py:9: UserWarning: is_namedtuple is deprecated, please use the python checks instead
  warnings.warn("is_namedtuple is deprecated, please use the python checks instead")
/usr/local/lib/python3.8/dist-packages/torch/nn/parallel/scatter_gather.py:9: UserWarning: is_namedtuple is deprecated, please use the python checks instead
  warnings.warn("is_namedtuple is deprecated, please use the python checks instead")
/usr/local/lib/python3.8/dist-packages/torch/nn/parallel/scatter_gather.py:9: UserWarning: is_namedtuple is deprecated, please use the python checks instead
  warnings.warn("is_namedtuple is deprecated, please use the python checks instead")
/usr/local/lib/python3.8/dist-packages/torch/nn/parallel/scatter_gather.py:9: UserWarning: is_namedtuple is deprecated, please use the python checks instead
  warnings.warn("is_namedtuple is deprecated, please use the python checks instead")
