[2022-12-05 20:41:36.638325: W /samgraph/samgraph/common/cpu/mmap_cpu_device.cc:92] mmap allocating space 12.03 GB
[2022-12-05 20:41:36.638403: W /samgraph/samgraph/common/cpu/mmap_cpu_device.cc:97] mmap allocating space 12.03 GB done
[2022-12-05 20:41:40.185652: W /samgraph/samgraph/common/cpu/mmap_cpu_device.cc:92] mmap allocating space 52.96 GB
[2022-12-05 20:41:40.185727: W /samgraph/samgraph/common/cpu/mmap_cpu_device.cc:97] mmap allocating space 52.96 GB done
[2022-12-05 20:41:40.188362: W /samgraph/samgraph/common/cpu/mmap_cpu_device.cc:92] mmap allocating space 8.38 GB
[2022-12-05 20:41:40.188398: W /samgraph/samgraph/common/cpu/mmap_cpu_device.cc:97] mmap allocating space 8.38 GB done
/usr/lib/python3/dist-packages/requests/__init__.py:89: RequestsDependencyWarning: urllib3 (1.26.12) or chardet (3.0.4) doesn't match a supported version!
  warnings.warn("urllib3 ({}) or chardet ({}) doesn't match a supported "
[2022-12-05 20:41:41.396720: W /samgraph/samgraph/common/dist/dist_engine.cc:662] Trainer[2] initializing...
[2022-12-05 20:41:41.443062: W /samgraph/samgraph/common/dist/dist_engine.cc:662] Trainer[0] initializing...
[2022-12-05 20:41:41.566858: W /samgraph/samgraph/common/dist/dist_engine.cc:662] Trainer[3] initializing...
[2022-12-05 20:41:41.585656: W /samgraph/samgraph/common/dist/dist_engine.cc:662] Trainer[1] initializing...
[2022-12-05 20:41:41.639648: W /samgraph/samgraph/common/dist/dist_engine.cc:662] Trainer[5] initializing...
[2022-12-05 20:41:41.685177: W /samgraph/samgraph/common/dist/dist_engine.cc:662] Trainer[4] initializing...
[2022-12-05 20:41:42.975882: W /samgraph/samgraph/common/dist/dist_engine.cc:666] Trainer[2] pin memory queue...
[2022-12-05 20:41:42.977920: W /samgraph/samgraph/common/dist/dist_engine.cc:666] Trainer[0] pin memory queue...
[2022-12-05 20:41:43.  3878: W /samgraph/samgraph/common/dist/dist_engine.cc:666] Trainer[3] pin memory queue...
[2022-12-05 20:41:43. 15136: W /samgraph/samgraph/common/dist/dist_engine.cc:666] Trainer[1] pin memory queue...
[2022-12-05 20:41:43. 15516: W /samgraph/samgraph/common/dist/dist_engine.cc:666] Trainer[5] pin memory queue...
[2022-12-05 20:41:43. 23001: W /samgraph/samgraph/common/dist/dist_engine.cc:666] Trainer[4] pin memory queue...
[2022-12-05 20:41:45.522864: E /samgraph/samgraph/common/dist/dist_engine.cc:85] Running on A100
[2022-12-05 20:41:45.523583: E /samgraph/samgraph/common/dist/dist_engine.cc:85] Running on A100
[2022-12-05 20:41:45.524292: W /samgraph/samgraph/common/dist/dist_engine.cc:701] Trainer[3] register host memory...
[2022-12-05 20:41:45.524486: W /samgraph/samgraph/common/dist/dist_engine.cc:701] Trainer[2] register host memory...
[2022-12-05 20:41:45.525455: E /samgraph/samgraph/common/dist/dist_engine.cc:85] Running on A100
[2022-12-05 20:41:45.526650: W /samgraph/samgraph/common/dist/dist_engine.cc:701] Trainer[0] register host memory...
[2022-12-05 20:41:45.526893: E /samgraph/samgraph/common/dist/dist_engine.cc:85] Running on A100
[2022-12-05 20:41:45.527369: W /samgraph/samgraph/common/dist/dist_engine.cc:701] Trainer[5] register host memory...
[2022-12-05 20:41:45.534304: E /samgraph/samgraph/common/dist/dist_engine.cc:85] Running on A100
[2022-12-05 20:41:45.534547: W /samgraph/samgraph/common/dist/dist_engine.cc:701] Trainer[1] register host memory...
[2022-12-05 20:41:45.536159: E /samgraph/samgraph/common/dist/dist_engine.cc:85] Running on A100
[2022-12-05 20:41:45.536211: W /samgraph/samgraph/common/dist/dist_engine.cc:701] Trainer[4] register host memory...
[2022-12-05 20:41:45.713320: E /samgraph/samgraph/common/dist/dist_engine.cc:85] Running on A100
[2022-12-05 20:41:45.714167: E /samgraph/samgraph/common/dist/dist_engine.cc:85] Running on A100
[2022-12-05 20:41:45.716520: W /samgraph/samgraph/common/cuda/cuda_device.cc:49] GPU[6] alloc cuda memory 423.66 MB
[2022-12-05 20:41:45.781749: W /samgraph/samgraph/common/cuda/cuda_device.cc:49] GPU[6] alloc cuda memory 12.03 GB
[2022-12-05 20:41:47.310956: W /samgraph/samgraph/common/cuda/cuda_device.cc:49] GPU[6] alloc cuda memory 128.00 MB
[2022-12-05 20:41:47.313334: E /samgraph/samgraph/common/dist/pre_sampler.cc:41] Dist Presampler making shuffler...
[2022-12-05 20:41:47.315148: E /samgraph/samgraph/common/dist/pre_sampler.cc:44] Dist Presampler making shuffler...Done
[2022-12-05 20:41:47.315174: W /samgraph/samgraph/common/cpu/cpu_device.cc:39] WORKER[0] alloc host memory 847.32 MB
[2022-12-05 20:41:47.449676: E /samgraph/samgraph/common/dist/pre_sampler.cc:85] Dist Presampler doing presample epoch 0
[2022-12-05 20:41:48.584830: E /samgraph/samgraph/common/dist/pre_sampler.cc:129] presample spend 0.265172 on sample, 0.0281117 on copy, 0.840879 on count
[2022-12-05 20:41:48.584909: E /samgraph/samgraph/common/dist/pre_sampler.cc:85] Dist Presampler doing presample epoch 1
[2022-12-05 20:41:49.860303: E /samgraph/samgraph/common/dist/pre_sampler.cc:129] presample spend 0.559652 on sample, 0.0574028 on copy, 1.79161 on count
[2022-12-05 20:41:49.860390: E /samgraph/samgraph/common/dist/pre_sampler.cc:136] max_num_inputs = 1115731, min_num_inputs = 1090377
[2022-12-05 20:41:50.120476: E /samgraph/samgraph/common/dist/pre_sampler.cc:148] presample spend 0.260025 on sort freq.
[2022-12-05 20:41:50.295928: E /samgraph/samgraph/common/dist/dist_engine.cc:524] pre sample done, delete it
[[[[[[2022-12-05 20:41:502022-12-05 20:41:502022-12-05 20:41:502022-12-05 20:41:502022-12-05 20:41:502022-12-05 20:41:50......314198314197314203314203314205314208: : : : : : WWWWWW      /samgraph/samgraph/common/dist/dist_engine.cc/samgraph/samgraph/common/dist/dist_engine.cc/samgraph/samgraph/common/dist/dist_engine.cc/samgraph/samgraph/common/dist/dist_engine.cc/samgraph/samgraph/common/dist/dist_engine.cc/samgraph/samgraph/common/dist/dist_engine.cc::::::711711711711711711] ] ] ] ] ] Trainer[2] building cache...Trainer[3] building cache...Trainer[0] building cache...Trainer[5] building cache...

Trainer[1] building cache...Trainer[4] building cache...



[2022-12-05 20:41:50[.2022-12-05 20:41:50315987.: 315988E:  E/samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc :/samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc196:] 196build symm link desc with 6X NVIDIA A100-SXM4-80GB out of 8] 
build symm link desc with 6X NVIDIA A100-SXM4-80GB out of 8
[[2022-12-05 20:41:502022-12-05 20:41:50..316021316022: : EE  /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc/samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc::197197] ] remote time is 10.8824remote time is 10.8824

[[2022-12-05 20:41:502022-12-05 20:41:50..316041316042: : EE  /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc/samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc::198198] ] cpu time is 41.1111cpu time is 41.1111

[2022-12-05 20:41:50.316137: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] build symm link desc with 6X NVIDIA A100-SXM4-80GB out of 8
[2022-12-05 20:41:50.316168: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:197] remote time is 10.8824
[2022-12-05 20:41:50.316179: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:198] cpu time is 41.1111
[2022-12-05 20:41:50.316196: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] build symm link desc with 6X NVIDIA A100-SXM4-80GB out of 8
[2022-12-05 20:41:50.316222: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:197] remote time is 10.8824
[2022-12-05 20:41:50.316233: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:198] cpu time is 41.1111
[2022-12-05 20:41:50.316923: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] build symm link desc with 6X NVIDIA A100-SXM4-80GB out of 8
[2022-12-05 20:41:50.316949: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:197] remote time is 10.8824
[2022-12-05 20:41:50.316960: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:198] cpu time is 41.1111
[2022-12-05 20:41:50.427420: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] build symm link desc with 6X NVIDIA A100-SXM4-80GB out of 8
[2022-12-05 20:41:50.427475: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:197] remote time is 10.8824
[2022-12-05 20:41:50.427486: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:198] cpu time is 41.1111
[2022-12-05 20:42:03.908245: E /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:115] solver created. now build & solve
[2022-12-05 20:42:03.959767: E /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:120] solver built. now solve
[2022-12-05 20:42:03.959795: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:895] num_cached_nodes = 16658993
[2022-12-05 20:42:04.571278: E /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:124] solver solved
[2022-12-05 20:42:04.571363: E /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:187] 0 solved master
[2022-12-05 20:42:04.571381: E /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:194] 0 solved
[2022-12-05 20:42:04.571392: E /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:197] worker 0 thread 0 initing device 0
[2022-12-05 20:42:04.587730: E /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:194] 1 solved
[2022-12-05 20:42:04.587805: E /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:197] worker 1 thread 1 initing device 1
[[[2022-12-05 20:42:042022-12-05 20:42:04..5904762022-12-05 20:42:04590476: .: E590476E :  /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.ccE/samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc: :194/samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc194] :] 3 solved1942 solved
] 
5 solved
[[2022-12-05 20:42:042022-12-05 20:42:04.[.5905582022-12-05 20:42:04590559: .: E590561E :  /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.ccE/samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc: :197/samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc197] :] 197worker 3 thread 3 initing device 3] worker 2 thread 2 initing device 2

worker 5 thread 5 initing device 5
[2022-12-05 20:42:04.592613: E /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:194] 4 solved
[2022-12-05 20:42:04.592659: E /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:197] worker 4 thread 4 initing device 4
[2022-12-05 20:42:05.364637: E /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:1740] Collaborative GPU cache (policy: rep_cache) | local 16658993 / 111059956 nodes ( 15.00 %~15.00 %) | remote 0 / 111059956 nodes ( 0.00 %) | cpu 94400963 / 111059956 nodes ( 85.00 %) | 7.94 GB | 0.792484 secs 
[2022-12-05 20:42:05.364931: E /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:1740] Collaborative GPU cache (policy: rep_cache) | local 16658993 / 111059956 nodes ( 15.00 %~15.00 %) | remote 0 / 111059956 nodes ( 0.00 %) | cpu 94400963 / 111059956 nodes ( 85.00 %) | 7.94 GB | 0.773304 secs 
[2022-12-05 20:42:05.365413: E /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:1740] Collaborative GPU cache (policy: rep_cache) | local 16658993 / 111059956 nodes ( 15.00 %~15.00 %) | remote 0 / 111059956 nodes ( 0.00 %) | cpu 94400963 / 111059956 nodes ( 85.00 %) | 7.94 GB | 0.772998 secs 
[2022-12-05 20:42:05.365936: E /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:1740] Collaborative GPU cache (policy: rep_cache) | local 16658993 / 111059956 nodes ( 15.00 %~15.00 %) | remote 0 / 111059956 nodes ( 0.00 %) | cpu 94400963 / 111059956 nodes ( 85.00 %) | 7.94 GB | 0.770562 secs 
[2022-12-05 20:42:05.366255: E /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:1740] Collaborative GPU cache (policy: rep_cache) | local 16658993 / 111059956 nodes ( 15.00 %~15.00 %) | remote 0 / 111059956 nodes ( 0.00 %) | cpu 94400963 / 111059956 nodes ( 85.00 %) | 7.94 GB | 0.774174 secs 
[2022-12-05 20:42:05.366527: E /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:1740] Collaborative GPU cache (policy: rep_cache) | local 16658993 / 111059956 nodes ( 15.00 %~15.00 %) | remote 0 / 111059956 nodes ( 0.00 %) | cpu 94400963 / 111059956 nodes ( 85.00 %) | 7.94 GB | 0.774826 secs 
[2022-12-05 20:42:05.367940: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] build symm link desc with 6X NVIDIA A100-SXM4-80GB out of 8
[2022-12-05 20:42:05.368383: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:197] remote time is 10.8824
[2022-12-05 20:42:05.368401: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:198] cpu time is 41.1111
[2022-12-05 20:42:05.368401: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] build symm link desc with 6X NVIDIA A100-SXM4-80GB out of 8
[2022-12-05 20:42:05.368426: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:197] remote time is 10.8824
[2022-12-05 20:42:05.368437: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:198] cpu time is 41.1111
[2022-12-05 20:42:05.368727: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] build symm link desc with 6X NVIDIA A100-SXM4-80GB out of 8
[2022-12-05 20:42:05.368751: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:197] remote time is 10.8824
[2022-12-05 20:42:05.368762: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:198] cpu time is 41.1111
[2022-12-05 20:42:05.368810: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] build symm link desc with 6X NVIDIA A100-SXM4-80GB out of 8
[2022-12-05 20:42:05.368833: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:197] remote time is 10.8824
[2022-12-05 20:42:05.368844: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:198] cpu time is 41.1111
[2022-12-05 20:42:05.368884: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] build symm link desc with 6X NVIDIA A100-SXM4-80GB out of 8
[2022-12-05 20:42:05.368909: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:197] remote time is 10.8824
[2022-12-05 20:42:05.368920: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:198] cpu time is 41.1111
[2022-12-05 20:42:05.369171: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] build symm link desc with 6X NVIDIA A100-SXM4-80GB out of 8
[2022-12-05 20:42:05.369629: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:197] remote time is 10.8824
[2022-12-05 20:42:05.369646: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:198] cpu time is 41.1111
[2022-12-05 20:42:05.579500: E /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:115] solver created. now build & solve
[2022-12-05 20:42:05.594901: E /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:120] solver built. now solve
[2022-12-05 20:42:05.594927: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:895] num_cached_nodes = 16658993
[2022-12-05 20:42:06.210809: E /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:124] solver solved
[2022-12-05 20:42:06.210867: E /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:187] 0 solved master
[2022-12-05 20:42:06.210878: E /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:194] 0 solved
[2022-12-05 20:42:06.210888: E /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:197] worker 0 thread 0 initing device 0
[2022-12-05 20:42:06.225512: E /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:194] 1 solved
[2022-12-05 20:42:06.225585: E /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:197] worker 1 thread 1 initing device 1
[[[2022-12-05 20:42:06.2022-12-05 20:42:06230473[.2022-12-05 20:42:06: 230474.2022-12-05 20:42:06E: 230474. E: 230479/samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc E: :/samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc E194:/samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc ] 194:/samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc3 solved] 194:
5 solved] 1944 solved
] 
[2 solved2022-12-05 20:42:06[
.2022-12-05 20:42:06[230554.2022-12-05 20:42:06[: 230558.2022-12-05 20:42:06E: 230560. E: 230563/samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc E: :/samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc E197:/samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc ] 197:/samgraph/3rdparty/collcachelib/coll_cache_lib/facade.ccworker 3 thread 3 initing device 3] 197:
] worker 5 thread 5 initing device 5197
worker 4 thread 4 initing device 4] 
worker 2 thread 2 initing device 2
[2022-12-05 20:42:08. 16726: W /samgraph/samgraph/common/cuda/cuda_device.cc:49] GPU[0] alloc cuda memory 579.44 MB
[2022-12-05 20:42:09.249770: W /samgraph/samgraph/common/cuda/cuda_device.cc:49] GPU[0] alloc cuda memory 579.44 MB
/usr/local/lib/python3.8/dist-packages/torch/nn/parallel/scatter_gather.py:9: UserWarning: is_namedtuple is deprecated, please use the python checks instead
  warnings.warn("is_namedtuple is deprecated, please use the python checks instead")
/usr/local/lib/python3.8/dist-packages/torch/nn/parallel/scatter_gather.py:9: UserWarning: is_namedtuple is deprecated, please use the python checks instead
  warnings.warn("is_namedtuple is deprecated, please use the python checks instead")
/usr/local/lib/python3.8/dist-packages/torch/nn/parallel/scatter_gather.py:9: UserWarning: is_namedtuple is deprecated, please use the python checks instead
  warnings.warn("is_namedtuple is deprecated, please use the python checks instead")
/usr/local/lib/python3.8/dist-packages/torch/nn/parallel/scatter_gather.py:9: UserWarning: is_namedtuple is deprecated, please use the python checks instead
  warnings.warn("is_namedtuple is deprecated, please use the python checks instead")
/usr/local/lib/python3.8/dist-packages/torch/nn/parallel/scatter_gather.py:9: UserWarning: is_namedtuple is deprecated, please use the python checks instead
  warnings.warn("is_namedtuple is deprecated, please use the python checks instead")
/usr/local/lib/python3.8/dist-packages/torch/nn/parallel/scatter_gather.py:9: UserWarning: is_namedtuple is deprecated, please use the python checks instead
  warnings.warn("is_namedtuple is deprecated, please use the python checks instead")
