succeed=True
config:eval_tsp="2023-03-30 15:48:11"
config:arch=arch6
config:num_worker=4
config:sample_type=khop2
config:root_path=/nvme/graph-learning-copy/samgraph/
config:dataset=mag240m-homo
config:pipeline=False
config:cache_policy=coll_cache_asymm_link
config:cache_percentage=0.02
config:num_epoch=4
config:batch_size=4000
config:num_hidden=256
config:max_sampling_jobs=1
config:max_copying_jobs=1
config:barriered_epoch=1
config:presample_epoch=2
config:omp_thread_num=40
config:unsupervised=False
config:amp=True
config:rolling=0
config:fanout=[25, 10]
config:lr=0.003
config:dropout=0.5
config:max_num_step=100000
config:validate_configs=False
config:report_acc=0
config:dataset_path=/nvme/graph-learning-copy/samgraph/mag240m-homo
config:workers=['cuda:0', 'cuda:1', 'cuda:2', 'cuda:3']
config:num_fanout=2
config:num_layer=2
config:_run_mode=RunMode.SGNN
config:_log_level=warn
config:_profile_level=3
config:_empty_feat=25
config:_arch=6
config:_sample_type=5
config:_cache_policy=13
test_result:init:input_scale_factor=1.1
0 :  {link #0 : 1}, {link #1 : 2}, {link #2 : 3},
1 :  {link #0 : 2}, {link #1 : 3}, {link #2 : 0},
2 :  {link #0 : 3}, {link #1 : 0}, {link #2 : 1},
3 :  {link #0 : 0}, {link #1 : 1}, {link #2 : 2},
0 :  {link #0 : 1}, {link #1 : 2}, {link #2 : 3},
1 :  {link #0 : 2}, {link #1 : 3}, {link #2 : 0},
2 :  {link #0 : 3}, {link #1 : 0}, {link #2 : 1},
3 :  {link #0 : 0}, {link #1 : 1}, {link #2 : 2},
0 :  {link #0 : 1}, {link #1 : 2}, {link #2 : 3},
1 :  {link #0 : 2}, {link #1 : 3}, {link #2 : 0},
2 :  {link #0 : 3}, {link #1 : 0}, {link #2 : 1},
3 :  {link #0 : 0}, {link #1 : 1}, {link #2 : 2},
0 :  {link #0 : 1}, {link #1 : 2}, {link #2 : 3},
1 :  {link #0 : 2}, {link #1 : 3}, {link #2 : 0},
2 :  {link #0 : 3}, {link #1 : 0}, {link #2 : 1},
3 :  {link #0 : 0}, {link #1 : 1}, {link #2 : 2},
Set parameter WLSAccessID
Set parameter WLSSecret
Set parameter LicenseID
Set parameter TimeLimit to value 200
Set parameter MIPGap to value 0.05
Set parameter LogFile to value "cppsolver.log"
Set parameter Threads to value 40
Academic license - for non-commercial use only - registered to xiaoniu.sxn@sjtu.edu.cn
Gurobi Optimizer version 9.5.1 build v9.5.1rc2 (linux64)
Thread count: 40 physical cores, 80 logical processors, using up to 40 threads
Academic license - for non-commercial use only - registered to xiaoniu.sxn@sjtu.edu.cn
Optimize a model with 7256 rows, 2368 columns and 22264 nonzeros
Model fingerprint: 0x4c13cc21
Variable types: 5 continuous, 2363 integer (2363 binary)
Coefficient statistics:
  Matrix range     [5e-04, 7e+02]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 6e+02]
Found heuristic solution: objective 2789.0330956
Presolve removed 5043 rows and 38 columns
Presolve time: 0.03s
Presolved: 2213 rows, 2330 columns, 10566 nonzeros
Variable types: 1 continuous, 2329 integer (2329 binary)

Root relaxation: objective 2.235466e+02, 1704 iterations, 0.03 seconds (0.02 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0  223.54661    0   39 2789.03310  223.54661  92.0%     -    0s
H    0     0                     232.0045774  223.54661  3.65%     -    0s

Explored 1 nodes (2395 simplex iterations) in 0.09 seconds (0.06 work units)
Thread count was 40 (of 80 available processors)

Solution count 2: 232.005 2789.03 

Optimal solution found (tolerance 5.00e-02)
Best objective 2.320045774320e+02, best bound 2.235466119367e+02, gap 3.6456%
coll_cache:optimal_local_rate=0.575356,0.588533,0.558759,0.590754,
coll_cache:optimal_remote_rate=0.386246,0.373069,0.402843,0.370847,
coll_cache:optimal_cpu_rate=0.0383984,0.0383984,0.0383984,0.0383984,
z=232.005
test_result:init:feat_nbytes=375030526464
test_result:init:cache_nbytes=7875640320
test_result:init:feat_nbytes=375030526464
test_result:init:cache_nbytes=7875640320
test_result:init:feat_nbytes=375030526464
test_result:init:cache_nbytes=7875640320
test_result:init:feat_nbytes=375030526464
test_result:init:cache_nbytes=7875640320
0 :  {link #0 : 1}, {link #1 : 2}, {link #2 : 3},
1 :  {link #0 : 2}, {link #1 : 3}, {link #2 : 0},
2 :  {link #0 : 3}, {link #1 : 0}, {link #2 : 1},
3 :  {link #0 : 0}, {link #1 : 1}, {link #2 : 2},
0 :  {link #0 : 1}, {link #1 : 2}, {link #2 : 3},
1 :  {link #0 : 2}, {link #1 : 3}, {link #2 : 0},
2 :  {link #0 : 3}, {link #1 : 0}, {link #2 : 1},
3 :  {link #0 : 0}, {link #1 : 1}, {link #2 : 2},
0 :  {link #0 : 1}, {link #1 : 2}, {link #2 : 3},
1 :  {link #0 : 2}, {link #1 : 3}, {link #2 : 0},
2 :  {link #0 : 3}, {link #1 : 0}, {link #2 : 1},
3 :  {link #0 : 0}, {link #1 : 1}, {link #2 : 2},
0 :  {link #0 : 1}, {link #1 : 2}, {link #2 : 3},
1 :  {link #0 : 2}, {link #1 : 3}, {link #2 : 0},
2 :  {link #0 : 3}, {link #1 : 0}, {link #2 : 1},
3 :  {link #0 : 0}, {link #1 : 1}, {link #2 : 2},
test_result:init:cache_nbytes=0
test_result:init:cache_nbytes=0
test_result:init:cache_nbytes=0
test_result:init:cache_nbytes=0
[CUDA] cuda0: usage: 14.14 GB
[SAM] cuda0 data alloc        : 73.12 MB
[SAM] cuda0 workspace         : 2.77 GB
[SAM] cuda0 workspace reserve : 946.08 MB
[SAM] cuda0 total             : 2.84 GB
    [Step(average) Profiler Level 1 E3 S69]
        L1  sample           0.023245 | send           0.000000
        L1  recv             0.000000 | copy           0.005528 | convert time 0.000430 | train  0.012550
        L1  feature nbytes  843.00 MB | label nbytes   31.25 KB
        L1  id nbytes      0.00 Bytes | graph nbytes 0.00 Bytes
        L1  miss nbytes      39.18 MB | remote nbytes  318.25 MB
        L1  num nodes          575485 | num samples      744334
    [Step(average) Profiler Level 2 E3 S69]
        L2  shuffle     0.000113 | core sample  0.021465 | id remap        0.001535
        L2  graph copy  0.000000 | id copy      0.000000 | cache feat copy 0.004814
        L2  last layer sample time 0.000508 | size 33452.025437
    [Step(average) Profiler Level 3 E3 S69]
        L3  khop sample coo  0.021216 | khop sort coo      0.000000 | khop count edge     0.000037 | khop compact edge 0.000166
        L3  walk sample coo  0.000000 | walk topk total    0.000000 | walk topk step1     0.000000 | walk topk step2   0.000000
        L3  walk topk step3  0.000000 | walk topk step4    0.000000 | walk topk step5     0.000000
        L3  walk topk step6  0.000000 | walk topk step7    0.000000
        L3  remap unique     0.000000 | remap populate     0.001301 | remap mapnode       0.000000 | remap mapedge     0.000234
        L3  cache get_index  0.000491 | cache copy_index   0.000000 | cache extract_miss  0.000000
        L3  cache copy_miss  0.000000 | cache combine_miss 0.003636 | cache combine cache 0.004249 | cache combine remote 0.002913
        L3  label extract  0.000141
    [Init Profiler Level 1]
        L1  init    12.1340 | sampler init    16.7011 | trainer init 22.8241
    [Init Profiler Level 2]
        L2  load ds        21.6675 | init queue           0.0000
        L2  presample       5.3019 | build interal ds     1.8635
        L2  build cache    22.8205
    [Init Profiler Level 3]
        L3  load dataset: mmap    12.1318 | copy         0.0000
        L3  dist queue: alloc      0.0000 | pin          0.0000 | push     0.0000
        L3  presample: init        0.6661
        L3  presample: sample      1.3684 | copy         0.1062
        L3  presample: count       0.6532 | sort         0.5426
        L3  presample: reset       0.0015 | get rank     0.0684
        L3  internal: cuda ctx     0.0004 | cuda stream     0.0001
[Worker 1/4] Started with PID 29985(Tesla V100-SXM2-16GB)
worker 1 at process 29985
[Worker 1] run for 4 epochs with 70 steps
[Train  Worker 1] Avg Epoch 2.9323 | Sample 1.6278 | Copy 0.3872 | Train Total (Profiler) 0.9099
[Worker 3/4] Started with PID 29988(Tesla V100-SXM2-16GB)
worker 3 at process 29988
[Worker 3] run for 4 epochs with 70 steps
[Train  Worker 3] Avg Epoch 2.9322 | Sample 1.6279 | Copy 0.3899 | Train Total (Profiler) 0.9074
[Worker 0/4] Started with PID 29984(Tesla V100-SXM2-16GB)
worker 0 at process 29984
[Worker 0] run for 4 epochs with 70 steps
Epoch 00000 | Epoch Time 4.1131 | Sample 1.6554 | Copy 0.4135 | Total Train(Profiler) 2.0372
Epoch 00001 | Epoch Time 2.9350 | Sample 1.6270 | Copy 0.3946 | Total Train(Profiler) 0.9068
Epoch 00002 | Epoch Time 2.9218 | Sample 1.6232 | Copy 0.3836 | Total Train(Profiler) 0.9081
Epoch 00003 | Epoch Time 2.9400 | Sample 1.6281 | Copy 0.3944 | Total Train(Profiler) 0.9107
[Train  Worker 0] Avg Epoch 2.9322 | Sample 1.6261 | Copy 0.3909 | Train Total (Profiler) 0.9085
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   26636 KB |  401317 KB |  323589 MB |  323563 MB |
|       from large pool |   17742 KB |  398487 KB |  320565 MB |  320547 MB |
|       from small pool |    8894 KB |   11214 KB |    3024 MB |    3015 MB |
|---------------------------------------------------------------------------|
| Active memory         |   26637 KB |  401317 KB |  323589 MB |  323563 MB |
|       from large pool |   17742 KB |  398487 KB |  320565 MB |  320547 MB |
|       from small pool |    8895 KB |   11214 KB |    3024 MB |    3015 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  487424 KB |  487424 KB |  487424 KB |       0 B  |
|       from large pool |  473088 KB |  473088 KB |  473088 KB |       0 B  |
|       from small pool |   14336 KB |   14336 KB |   14336 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   24563 KB |  402288 KB |  280787 MB |  280763 MB |
|       from large pool |   23218 KB |  400057 KB |  277482 MB |  277459 MB |
|       from small pool |    1345 KB |    4684 KB |    3304 MB |    3303 MB |
|---------------------------------------------------------------------------|
| Allocations           |      42    |      57    |   33080    |   33038    |
|       from large pool |       7    |      18    |   14563    |   14556    |
|       from small pool |      35    |      41    |   18517    |   18482    |
|---------------------------------------------------------------------------|
| Active allocs         |      43    |      57    |   33080    |   33037    |
|       from large pool |       7    |      18    |   14563    |   14556    |
|       from small pool |      36    |      41    |   18517    |   18481    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      14    |      14    |      14    |       0    |
|       from large pool |       7    |       7    |       7    |       0    |
|       from small pool |       7    |       7    |       7    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      17    |      28    |   15577    |   15560    |
|       from large pool |       4    |      14    |    8910    |    8906    |
|       from small pool |      13    |      21    |    6667    |    6654    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

test_result:sample_time=nan
test_result:epoch_time:sample_total=1.6261
test_result:epoch_time:copy_time=0.3909
test_result:convert_time=0.0293
test_result:train_time=0.8792
test_result:epoch_time:train_total=0.9085
test_result:cache_percentage=0.0200
test_result:cache_hit_rate=1.0000
test_result:epoch_time:total=2.9322
test_result:run_time=12.9121
[Worker 2/4] Started with PID 29987(Tesla V100-SXM2-16GB)
worker 2 at process 29987
[Worker 2] run for 4 epochs with 70 steps
[Train  Worker 2] Avg Epoch 2.9323 | Sample 1.6276 | Copy 0.3846 | Train Total (Profiler) 0.9124

