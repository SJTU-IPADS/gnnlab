succeed=True
config:eval_tsp="2023-03-30 14:53:12"
config:arch=arch6
config:num_worker=4
config:sample_type=khop2
config:root_path=/nvme/graph-learning-copy/samgraph/
config:dataset=papers100M-undir
config:pipeline=False
config:cache_policy=coll_cache_asymm_link
config:cache_percentage=0.16
config:num_epoch=4
config:batch_size=2000
config:num_hidden=256
config:max_sampling_jobs=1
config:max_copying_jobs=1
config:barriered_epoch=1
config:presample_epoch=2
config:omp_thread_num=40
config:unsupervised=True
config:amp=True
config:rolling=0
config:fanout=[25, 10]
config:lr=0.003
config:dropout=0.5
config:max_num_step=1000
config:validate_configs=False
config:report_acc=0
config:dataset_path=/nvme/graph-learning-copy/samgraph/papers100M-undir
config:workers=['cuda:0', 'cuda:1', 'cuda:2', 'cuda:3']
config:num_fanout=2
config:num_layer=2
config:_run_mode=RunMode.SGNN
config:_log_level=warn
config:_profile_level=3
config:_empty_feat=25
config:_arch=6
config:_sample_type=5
config:_cache_policy=13
test_result:init:input_scale_factor=1.1
0 :  {link #0 : 1}, {link #1 : 2}, {link #2 : 3},
1 :  {link #0 : 2}, {link #1 : 3}, {link #2 : 0},
2 :  {link #0 : 3}, {link #1 : 0}, {link #2 : 1},
3 :  {link #0 : 0}, {link #1 : 1}, {link #2 : 2},
0 :  {link #0 : 1}, {link #1 : 2}, {link #2 : 3},
1 :  {link #0 : 2}, {link #1 : 3}, {link #2 : 0},
2 :  {link #0 : 3}, {link #1 : 0}, {link #2 : 1},
3 :  {link #0 : 0}, {link #1 : 1}, {link #2 : 2},
0 :  {link #0 : 1}, {link #1 : 2}, {link #2 : 3},
1 :  {link #0 : 2}, {link #1 : 3}, {link #2 : 0},
2 :  {link #0 : 3}, {link #1 : 0}, {link #2 : 1},
3 :  {link #0 : 0}, {link #1 : 1}, {link #2 : 2},
0 :  {link #0 : 1}, {link #1 : 2}, {link #2 : 3},
1 :  {link #0 : 2}, {link #1 : 3}, {link #2 : 0},
2 :  {link #0 : 3}, {link #1 : 0}, {link #2 : 1},
3 :  {link #0 : 0}, {link #1 : 1}, {link #2 : 2},
Set parameter WLSAccessID
Set parameter WLSSecret
Set parameter LicenseID
Set parameter TimeLimit to value 200
Set parameter MIPGap to value 0.05
Set parameter LogFile to value "cppsolver.log"
Set parameter Threads to value 40
Academic license - for non-commercial use only - registered to xiaoniu.sxn@sjtu.edu.cn
Gurobi Optimizer version 9.5.1 build v9.5.1rc2 (linux64)
Thread count: 40 physical cores, 80 logical processors, using up to 40 threads
Academic license - for non-commercial use only - registered to xiaoniu.sxn@sjtu.edu.cn
Optimize a model with 34140 rows, 11157 columns and 104984 nonzeros
Model fingerprint: 0x522091dd
Variable types: 5 continuous, 11152 integer (11152 binary)
Coefficient statistics:
  Matrix range     [6e-04, 4e+03]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 1e+04]
Found heuristic solution: objective 2.000000e+09
Presolve removed 23623 rows and 4 columns
Presolve time: 0.17s
Presolved: 10517 rows, 11153 columns, 50557 nonzeros
Found heuristic solution: objective 63735.522810
Variable types: 1 continuous, 11152 integer (11152 binary)

Root relaxation: objective 3.996181e+03, 9768 iterations, 0.28 seconds (0.25 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 3996.18103    0   35 63735.5228 3996.18103  93.7%     -    0s
H    0     0                    4018.8240121 3996.18103  0.56%     -    0s

Cutting planes:
  Cover: 1
  MIR: 4
  RLT: 3

Explored 1 nodes (14015 simplex iterations) in 0.88 seconds (0.63 work units)
Thread count was 40 (of 80 available processors)

Solution count 3: 4018.82 63735.5 2e+09 

Optimal solution found (tolerance 5.00e-02)
Best objective 4.018824012080e+03, best bound 3.996181030075e+03, gap 0.5634%
coll_cache:optimal_local_rate=0.449359,0.442799,0.441695,0.445145,
coll_cache:optimal_remote_rate=0.506517,0.513077,0.514181,0.510731,
coll_cache:optimal_cpu_rate=0.0441239,0.0441239,0.0441239,0.0441239,
z=4018.82
test_result:init:feat_nbytes=56862697472
test_result:init:cache_nbytes=9154893824
test_result:init:feat_nbytes=56862697472
test_result:init:cache_nbytes=9154893824
test_result:init:feat_nbytes=56862697472
test_result:init:cache_nbytes=9154893824
test_result:init:feat_nbytes=56862697472
test_result:init:cache_nbytes=9154893824
[CUDA] cuda0: usage: 14.96 GB
[SAM] cuda0 data alloc        : 77.69 MB
[SAM] cuda0 workspace         : 1.72 GB
[SAM] cuda0 workspace reserve : 657.47 MB
[SAM] cuda0 total             : 1.80 GB
    [Step(average) Profiler Level 1 E3 S999]
        L1  sample           0.057196 | send           0.000000
        L1  recv             0.000000 | copy           0.006233 | convert time 0.000504 | train  0.007775
        L1  feature nbytes  564.62 MB | label nbytes   15.62 KB
        L1  id nbytes      0.00 Bytes | graph nbytes 0.00 Bytes
        L1  miss nbytes      29.26 MB | remote nbytes  286.46 MB
        L1  num nodes         1156338 | num samples     1337754
    [Step(average) Profiler Level 2 E3 S999]
        L2  shuffle     0.000076 | core sample  0.053821 | id remap        0.002982
        L2  graph copy  0.000000 | id copy      0.000000 | cache feat copy 0.005373
        L2  last layer sample time 0.000889 | size 57559.957653
    [Step(average) Profiler Level 3 E3 S999]
        L3  khop sample coo  0.053490 | khop sort coo      0.000000 | khop count edge     0.000043 | khop compact edge 0.000223
        L3  walk sample coo  0.000000 | walk topk total    0.000000 | walk topk step1     0.000000 | walk topk step2   0.000000
        L3  walk topk step3  0.000000 | walk topk step4    0.000000 | walk topk step5     0.000000
        L3  walk topk step6  0.000000 | walk topk step7    0.000000
        L3  remap unique     0.000299 | remap populate     0.002531 | remap mapnode       0.000000 | remap mapedge     0.000465
        L3  cache get_index  0.000935 | cache copy_index   0.000000 | cache extract_miss  0.000000
        L3  cache copy_miss  0.000000 | cache combine_miss 0.004354 | cache combine cache 0.004196 | cache combine remote 0.003801
        L3  label extract  0.000026
    [Init Profiler Level 1]
        L1  init     8.1163 | sampler init    35.7490 | trainer init 15.1550
    [Init Profiler Level 2]
        L2  load ds        21.7914 | init queue           0.0000
        L2  presample      20.1936 | build interal ds     1.8781
        L2  build cache    15.1533
    [Init Profiler Level 3]
        L3  load dataset: mmap     8.1141 | copy         0.0000
        L3  dist queue: alloc      0.0000 | pin          0.0000 | push     0.0000
        L3  presample: init        0.5975
        L3  presample: sample      9.2939 | copy         0.7318
        L3  presample: count       7.5155 | sort         0.4335
        L3  presample: reset       0.0023 | get rank     0.0385
        L3  internal: cuda ctx     0.0002 | cuda stream     0.0000
[Worker 3/4] Started with PID 22186(Tesla V100-SXM2-16GB)
worker 3 at process 22186
[Worker 3] run for 4 epochs with 250 steps
[Train  Worker 3] Avg Epoch 17.9530 | Sample 14.3121 | Copy 1.5514 | Train Total (Profiler) 2.0637
[Worker 0/4] Started with PID 22180(Tesla V100-SXM2-16GB)
worker 0 at process 22180
[Worker 0] run for 4 epochs with 250 steps
Epoch 00000 | Epoch Time 19.3756 | Sample 14.3674 | Copy 1.6117 | Total Train(Profiler) 3.3675
Epoch 00001 | Epoch Time 17.9794 | Sample 14.2926 | Copy 1.5757 | Total Train(Profiler) 2.0852
Epoch 00002 | Epoch Time 17.9396 | Sample 14.3107 | Copy 1.5439 | Total Train(Profiler) 2.0603
Epoch 00003 | Epoch Time 17.9399 | Sample 14.2787 | Copy 1.5713 | Total Train(Profiler) 2.0646
[Train  Worker 0] Avg Epoch 17.9530 | Sample 14.2940 | Copy 1.5637 | Train Total (Profiler) 2.0700
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    8133 KB |  390845 KB |    1177 GB |    1177 GB |
|       from large pool |    4031 KB |  389641 KB |    1168 GB |    1168 GB |
|       from small pool |    4102 KB |    6138 KB |       8 GB |       8 GB |
|---------------------------------------------------------------------------|
| Active memory         |    8134 KB |  390845 KB |    1177 GB |    1177 GB |
|       from large pool |    4031 KB |  389641 KB |    1168 GB |    1168 GB |
|       from small pool |    4102 KB |    6138 KB |       8 GB |       8 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  468992 KB |  468992 KB |  468992 KB |       0 B  |
|       from large pool |  460800 KB |  460800 KB |  460800 KB |       0 B  |
|       from small pool |    8192 KB |    8192 KB |    8192 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   10298 KB |  350782 KB |    1271 GB |    1271 GB |
|       from large pool |    8256 KB |  348487 KB |    1261 GB |    1261 GB |
|       from small pool |    2041 KB |    3436 KB |       9 GB |       9 GB |
|---------------------------------------------------------------------------|
| Allocations           |      36    |      56    |  137037    |  137001    |
|       from large pool |       1    |      14    |   49000    |   48999    |
|       from small pool |      35    |      45    |   88037    |   88002    |
|---------------------------------------------------------------------------|
| Active allocs         |      37    |      56    |  137037    |  137000    |
|       from large pool |       1    |      14    |   49000    |   48999    |
|       from small pool |      36    |      45    |   88037    |   88001    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      11    |      11    |      11    |       0    |
|       from large pool |       7    |       7    |       7    |       0    |
|       from small pool |       4    |       4    |       4    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       9    |      24    |   53655    |   53646    |
|       from large pool |       1    |      10    |   27084    |   27083    |
|       from small pool |       8    |      17    |   26571    |   26563    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

test_result:sample_time=nan
test_result:epoch_time:sample_total=14.2940
test_result:epoch_time:copy_time=1.5637
test_result:convert_time=0.1257
test_result:train_time=1.9443
test_result:epoch_time:train_total=2.0700
test_result:cache_percentage=0.1600
test_result:cache_hit_rate=1.0000
test_result:epoch_time:total=17.9530
test_result:run_time=73.2377
[Worker 2/4] Started with PID 22184(Tesla V100-SXM2-16GB)
worker 2 at process 22184
[Worker 2] run for 4 epochs with 250 steps
[Train  Worker 2] Avg Epoch 17.9530 | Sample 14.3075 | Copy 1.5465 | Train Total (Profiler) 2.0727
[Worker 1/4] Started with PID 22182(Tesla V100-SXM2-16GB)
worker 1 at process 22182
[Worker 1] run for 4 epochs with 250 steps
[Train  Worker 1] Avg Epoch 17.9530 | Sample 14.2834 | Copy 1.5706 | Train Total (Profiler) 2.0732

