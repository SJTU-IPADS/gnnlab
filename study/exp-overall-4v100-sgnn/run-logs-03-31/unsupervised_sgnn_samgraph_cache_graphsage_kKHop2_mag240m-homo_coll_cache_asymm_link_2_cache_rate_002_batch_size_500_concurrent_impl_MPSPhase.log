succeed=True
config:eval_tsp="2023-03-31 04:55:45"
config:arch=arch6
config:num_worker=4
config:sample_type=khop2
config:root_path=/nvme/graph-learning-copy/samgraph/
config:dataset=mag240m-homo
config:pipeline=False
config:cache_policy=coll_cache_asymm_link
config:cache_percentage=0.0203
config:num_epoch=5
config:batch_size=500
config:num_hidden=256
config:max_sampling_jobs=1
config:max_copying_jobs=1
config:barriered_epoch=1
config:presample_epoch=2
config:omp_thread_num=40
config:unsupervised=True
config:amp=True
config:rolling=0
config:fanout=[25, 10]
config:lr=0.003
config:dropout=0.5
config:max_num_step=1000
config:validate_configs=False
config:report_acc=0
config:dataset_path=/nvme/graph-learning-copy/samgraph/mag240m-homo
config:workers=['cuda:0', 'cuda:1', 'cuda:2', 'cuda:3']
config:num_fanout=2
config:num_layer=2
config:_run_mode=RunMode.SGNN
config:_log_level=warn
config:_profile_level=3
config:_empty_feat=25
config:_arch=6
config:_sample_type=5
config:_cache_policy=13
test_result:init:input_scale_factor=1.15014
0 :  {link #0 : 1}, {link #1 : 2}, {link #2 : 3},
1 :  {link #0 : 2}, {link #1 : 3}, {link #2 : 0},
2 :  {link #0 : 3}, {link #1 : 0}, {link #2 : 1},
3 :  {link #0 : 0}, {link #1 : 1}, {link #2 : 2},
0 :  {link #0 : 1}, {link #1 : 2}, {link #2 : 3},
1 :  {link #0 : 2}, {link #1 : 3}, {link #2 : 0},
2 :  {link #0 : 3}, {link #1 : 0}, {link #2 : 1},
3 :  {link #0 : 0}, {link #1 : 1}, {link #2 : 2},
0 :  {link #0 : 1}, {link #1 : 2}, {link #2 : 3},
1 :  {link #0 : 2}, {link #1 : 3}, {link #2 : 0},
2 :  {link #0 : 3}, {link #1 : 0}, {link #2 : 1},
3 :  {link #0 : 0}, {link #1 : 1}, {link #2 : 2},
0 :  {link #0 : 1}, {link #1 : 2}, {link #2 : 3},
1 :  {link #0 : 2}, {link #1 : 3}, {link #2 : 0},
2 :  {link #0 : 3}, {link #1 : 0}, {link #2 : 1},
3 :  {link #0 : 0}, {link #1 : 1}, {link #2 : 2},
Set parameter WLSAccessID
Set parameter WLSSecret
Set parameter LicenseID
Set parameter TimeLimit to value 200
Set parameter MIPGap to value 0.05
Set parameter LogFile to value "cppsolver.log"
Set parameter Threads to value 40
Academic license - for non-commercial use only - registered to xiaoniu.sxn@sjtu.edu.cn
Gurobi Optimizer version 9.5.1 build v9.5.1rc2 (linux64)
Thread count: 40 physical cores, 80 logical processors, using up to 40 threads
Academic license - for non-commercial use only - registered to xiaoniu.sxn@sjtu.edu.cn
Optimize a model with 11364 rows, 3711 columns and 34904 nonzeros
Model fingerprint: 0x45e75368
Variable types: 5 continuous, 3706 integer (3706 binary)
Coefficient statistics:
  Matrix range     [1e-05, 3e+03]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+03]
Found heuristic solution: objective 4920.0273919
Presolve removed 7952 rows and 90 columns
Presolve time: 0.04s
Presolved: 3412 rows, 3621 columns, 10224 nonzeros
Found heuristic solution: objective 4866.5450066
Variable types: 0 continuous, 3621 integer (3621 binary)

Root relaxation: objective 2.536713e+03, 2779 iterations, 0.02 seconds (0.01 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 2536.71302    0   25 4866.54501 2536.71302  47.9%     -    0s
H    0     0                    2655.6041902 2536.71302  4.48%     -    0s

Explored 1 nodes (4361 simplex iterations) in 0.11 seconds (0.08 work units)
Thread count was 40 (of 80 available processors)

Solution count 3: 2655.6 4866.55 4920.03 

Optimal solution found (tolerance 5.00e-02)
Best objective 2.655604190213e+03, best bound 2.536713023470e+03, gap 4.4770%
coll_cache:optimal_local_rate=0.15638,0.166207,0.184942,0.151313,
coll_cache:optimal_remote_rate=0.502463,0.492636,0.473901,0.50753,
coll_cache:optimal_cpu_rate=0.341157,0.341157,0.341157,0.341157,
z=2655.6
test_result:init:feat_nbytes=375030526464
test_result:init:cache_nbytes=7988149248
test_result:init:feat_nbytes=375030526464
test_result:init:cache_nbytes=7988149248
test_result:init:feat_nbytes=375030526464
test_result:init:cache_nbytes=7988149248
test_result:init:feat_nbytes=375030526464
test_result:init:cache_nbytes=7988149248
[CUDA] cuda0: usage: 13.16 GB
[SAM] cuda0 data alloc        : 19.42 MB
[SAM] cuda0 workspace         : 1.74 GB
[SAM] cuda0 workspace reserve : 422.40 MB
[SAM] cuda0 total             : 1.76 GB
    [Step(average) Profiler Level 1 E4 S999]
        L1  sample           0.005217 | send           0.000000
        L1  recv             0.000000 | copy           0.012425 | convert time 0.000488 | train  0.009451
        L1  feature nbytes  357.61 MB | label nbytes    3.91 KB
        L1  id nbytes      0.00 Bytes | graph nbytes 0.00 Bytes
        L1  miss nbytes     134.73 MB | remote nbytes  167.15 MB
        L1  num nodes          244126 | num samples      275489
    [Step(average) Profiler Level 2 E4 S999]
        L2  shuffle     0.000039 | core sample  0.004469 | id remap        0.000485
        L2  graph copy  0.000000 | id copy      0.000000 | cache feat copy 0.011913
        L2  last layer sample time 0.000398 | size 12478.600900
    [Step(average) Profiler Level 3 E4 S999]
        L3  khop sample coo  0.004235 | khop sort coo      0.000000 | khop count edge     0.000032 | khop compact edge 0.000145
        L3  walk sample coo  0.000000 | walk topk total    0.000000 | walk topk step1     0.000000 | walk topk step2   0.000000
        L3  walk topk step3  0.000000 | walk topk step4    0.000000 | walk topk step5     0.000000
        L3  walk topk step6  0.000000 | walk topk step7    0.000000
        L3  remap unique     0.000207 | remap populate     0.000411 | remap mapnode       0.000000 | remap mapedge     0.000087
        L3  cache get_index  0.000225 | cache copy_index   0.000000 | cache extract_miss  0.000000
        L3  cache copy_miss  0.000000 | cache combine_miss 0.011681 | cache combine cache 0.001620 | cache combine remote 0.001583
        L3  label extract  0.000026
    [Init Profiler Level 1]
        L1  init    12.3750 | sampler init    22.5979 | trainer init 20.7603
    [Init Profiler Level 2]
        L2  load ds        23.6260 | init queue           0.0000
        L2  presample       9.4633 | build interal ds     1.8815
        L2  build cache    20.7589
    [Init Profiler Level 3]
        L3  load dataset: mmap    12.3729 | copy         0.0000
        L3  dist queue: alloc      0.0000 | pin          0.0000 | push     0.0000
        L3  presample: init        1.2920
        L3  presample: sample      2.4051 | copy         0.1748
        L3  presample: count       1.7469 | sort         0.9796
        L3  presample: reset       0.0031 | get rank     0.0826
        L3  internal: cuda ctx     0.0002 | cuda stream     0.0000
[Worker 1/4] Started with PID 54205(Tesla V100-SXM2-16GB)
worker 1 at process 54205
[Worker 1] run for 5 epochs with 250 steps
[Train  Worker 1] Avg Epoch 6.9199 | Sample 1.3314 | Copy 3.0813 | Train Total (Profiler) 2.4830
[Worker 3/4] Started with PID 54210(Tesla V100-SXM2-16GB)
worker 3 at process 54210
[Worker 3] run for 5 epochs with 250 steps
[Train  Worker 3] Avg Epoch 6.9199 | Sample 1.2819 | Copy 3.1311 | Train Total (Profiler) 2.4829
[Worker 2/4] Started with PID 54207(Tesla V100-SXM2-16GB)
worker 2 at process 54207
[Worker 2] run for 5 epochs with 250 steps
[Train  Worker 2] Avg Epoch 6.9199 | Sample 1.2778 | Copy 3.1345 | Train Total (Profiler) 2.4820
[Worker 0/4] Started with PID 54203(Tesla V100-SXM2-16GB)
worker 0 at process 54203
[Worker 0] run for 5 epochs with 250 steps
Epoch 00000 | Epoch Time 8.0535 | Sample 1.3400 | Copy 3.0760 | Total Train(Profiler) 3.6156
Epoch 00001 | Epoch Time 6.9549 | Sample 1.3213 | Copy 3.0830 | Total Train(Profiler) 2.5282
Epoch 00002 | Epoch Time 6.8875 | Sample 1.3261 | Copy 3.0829 | Total Train(Profiler) 2.4542
Epoch 00003 | Epoch Time 6.9545 | Sample 1.3327 | Copy 3.0733 | Total Train(Profiler) 2.5196
Epoch 00004 | Epoch Time 6.8826 | Sample 1.3223 | Copy 3.0716 | Total Train(Profiler) 2.4637
[Train  Worker 0] Avg Epoch 6.9199 | Sample 1.3256 | Copy 3.0777 | Train Total (Profiler) 2.4915
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   17121 KB |  177863 KB |  584711 MB |  584694 MB |
|       from large pool |    6838 KB |  175166 KB |  555817 MB |  555811 MB |
|       from small pool |   10283 KB |   18231 KB |   28893 MB |   28883 MB |
|---------------------------------------------------------------------------|
| Active memory         |   17121 KB |  177863 KB |  584711 MB |  584694 MB |
|       from large pool |    6838 KB |  175166 KB |  555817 MB |  555811 MB |
|       from small pool |   10283 KB |   18231 KB |   28893 MB |   28883 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  223232 KB |  223232 KB |  223232 KB |       0 B  |
|       from large pool |  200704 KB |  200704 KB |  200704 KB |       0 B  |
|       from small pool |   22528 KB |   22528 KB |   22528 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   34078 KB |  182582 KB |  635826 MB |  635793 MB |
|       from large pool |   30026 KB |  173830 KB |  605235 MB |  605205 MB |
|       from small pool |    4052 KB |   10721 KB |   30591 MB |   30587 MB |
|---------------------------------------------------------------------------|
| Allocations           |      43    |      62    |  180039    |  179996    |
|       from large pool |       5    |      15    |   45018    |   45013    |
|       from small pool |      38    |      58    |  135021    |  134983    |
|---------------------------------------------------------------------------|
| Active allocs         |      44    |      62    |  180039    |  179995    |
|       from large pool |       5    |      15    |   45018    |   45013    |
|       from small pool |      39    |      58    |  135021    |  134982    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      15    |      15    |      15    |       0    |
|       from large pool |       4    |       4    |       4    |       0    |
|       from small pool |      11    |      11    |      11    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      19    |      31    |   66232    |   66213    |
|       from large pool |       2    |       8    |   24284    |   24282    |
|       from small pool |      17    |      29    |   41948    |   41931    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

test_result:sample_time=nan
test_result:epoch_time:sample_total=1.3256
test_result:epoch_time:copy_time=3.0777
test_result:convert_time=0.1229
test_result:train_time=2.3686
test_result:epoch_time:train_total=2.4915
test_result:cache_percentage=0.0203
test_result:cache_hit_rate=1.0000
test_result:epoch_time:total=6.9199
test_result:run_time=35.7357

