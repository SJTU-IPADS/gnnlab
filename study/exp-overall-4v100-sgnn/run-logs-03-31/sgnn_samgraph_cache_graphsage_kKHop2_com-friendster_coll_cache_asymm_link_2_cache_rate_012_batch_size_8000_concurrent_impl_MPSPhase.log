succeed=True
config:eval_tsp="2023-03-30 15:46:49"
config:arch=arch6
config:num_worker=4
config:sample_type=khop2
config:root_path=/nvme/graph-learning-copy/samgraph/
config:dataset=com-friendster
config:pipeline=False
config:cache_policy=coll_cache_asymm_link
config:cache_percentage=0.12
config:num_epoch=4
config:batch_size=8000
config:num_hidden=256
config:max_sampling_jobs=1
config:max_copying_jobs=1
config:barriered_epoch=1
config:presample_epoch=2
config:omp_thread_num=40
config:unsupervised=False
config:amp=True
config:rolling=0
config:fanout=[25, 10]
config:lr=0.003
config:dropout=0.5
config:max_num_step=100000
config:validate_configs=False
config:report_acc=0
config:dataset_path=/nvme/graph-learning-copy/samgraph/com-friendster
config:workers=['cuda:0', 'cuda:1', 'cuda:2', 'cuda:3']
config:num_fanout=2
config:num_layer=2
config:_run_mode=RunMode.SGNN
config:_log_level=warn
config:_profile_level=3
config:_empty_feat=25
config:_arch=6
config:_sample_type=5
config:_cache_policy=13
test_result:init:input_scale_factor=1.1
0 :  {link #0 : 1}, {link #1 : 2}, {link #2 : 3},
1 :  {link #0 : 2}, {link #1 : 3}, {link #2 : 0},
2 :  {link #0 : 3}, {link #1 : 0}, {link #2 : 1},
3 :  {link #0 : 0}, {link #1 : 1}, {link #2 : 2},
0 :  {link #0 : 1}, {link #1 : 2}, {link #2 : 3},
1 :  {link #0 : 2}, {link #1 : 3}, {link #2 : 0},
2 :  {link #0 : 3}, {link #1 : 0}, {link #2 : 1},
3 :  {link #0 : 0}, {link #1 : 1}, {link #2 : 2},
0 :  {link #0 : 1}, {link #1 : 2}, {link #2 : 3},
1 :  {link #0 : 2}, {link #1 : 3}, {link #2 : 0},
2 :  {link #0 : 3}, {link #1 : 0}, {link #2 : 1},
3 :  {link #0 : 0}, {link #1 : 1}, {link #2 : 2},
0 :  {link #0 : 1}, {link #1 : 2}, {link #2 : 3},
1 :  {link #0 : 2}, {link #1 : 3}, {link #2 : 0},
2 :  {link #0 : 3}, {link #1 : 0}, {link #2 : 1},
3 :  {link #0 : 0}, {link #1 : 1}, {link #2 : 2},
Set parameter WLSAccessID
Set parameter WLSSecret
Set parameter LicenseID
Set parameter TimeLimit to value 200
Set parameter MIPGap to value 0.05
Set parameter LogFile to value "cppsolver.log"
Set parameter Threads to value 40
Academic license - for non-commercial use only - registered to xiaoniu.sxn@sjtu.edu.cn
Gurobi Optimizer version 9.5.1 build v9.5.1rc2 (linux64)
Thread count: 40 physical cores, 80 logical processors, using up to 40 threads
Academic license - for non-commercial use only - registered to xiaoniu.sxn@sjtu.edu.cn
Optimize a model with 25456 rows, 8318 columns and 78264 nonzeros
Model fingerprint: 0x0ffbcb3f
Variable types: 5 continuous, 8313 integer (8313 binary)
Coefficient statistics:
  Matrix range     [8e-05, 3e+03]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 2e+03]
Found heuristic solution: objective 2.000000e+09
Presolve removed 17643 rows and 38 columns
Presolve time: 0.10s
Presolved: 7813 rows, 8280 columns, 37516 nonzeros
Found heuristic solution: objective 13876.250808
Variable types: 1 continuous, 8279 integer (8279 binary)

Root relaxation: objective 9.004631e+02, 7667 iterations, 0.18 seconds (0.15 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0  900.46309    0   52 13876.2508  900.46309  93.5%     -    0s
H    0     0                     933.9875603  900.46309  3.59%     -    0s

Explored 1 nodes (10114 simplex iterations) in 0.39 seconds (0.31 work units)
Thread count was 40 (of 80 available processors)

Solution count 3: 933.988 13876.3 2e+09 

Optimal solution found (tolerance 5.00e-02)
Best objective 9.339875602879e+02, best bound 9.004630857922e+02, gap 3.5894%
coll_cache:optimal_local_rate=0.397914,0.4059,0.40639,0.393628,
coll_cache:optimal_remote_rate=0.553432,0.545446,0.544956,0.557718,
coll_cache:optimal_cpu_rate=0.0486545,0.0486545,0.0486545,0.0486545,
z=933.988
test_result:init:feat_nbytes=67182966784
test_result:init:cache_nbytes=8129138688
test_result:init:feat_nbytes=67182966784
test_result:init:cache_nbytes=8129138688
test_result:init:feat_nbytes=67182966784
test_result:init:cache_nbytes=8129138688
test_result:init:feat_nbytes=67182966784
test_result:init:cache_nbytes=8129138688
0 :  {link #0 : 1}, {link #1 : 2}, {link #2 : 3},
1 :  {link #0 : 2}, {link #1 : 3}, {link #2 : 0},
2 :  {link #0 : 3}, {link #1 : 0}, {link #2 : 1},
3 :  {link #0 : 0}, {link #1 : 1}, {link #2 : 2},
0 :  {link #0 : 1}, {link #1 : 2}, {link #2 : 3},
1 :  {link #0 : 2}, {link #1 : 3}, {link #2 : 0},
2 :  {link #0 : 3}, {link #1 : 0}, {link #2 : 1},
3 :  {link #0 : 0}, {link #1 : 1}, {link #2 : 2},
0 :  {link #0 : 1}, {link #1 : 2}, {link #2 : 3},
1 :  {link #0 : 2}, {link #1 : 3}, {link #2 : 0},
2 :  {link #0 : 3}, {link #1 : 0}, {link #2 : 1},
3 :  {link #0 : 0}, {link #1 : 1}, {link #2 : 2},
0 :  {link #0 : 1}, {link #1 : 2}, {link #2 : 3},
1 :  {link #0 : 2}, {link #1 : 3}, {link #2 : 0},
2 :  {link #0 : 3}, {link #1 : 0}, {link #2 : 1},
3 :  {link #0 : 0}, {link #1 : 1}, {link #2 : 2},
test_result:init:cache_nbytes=0
test_result:init:cache_nbytes=0
test_result:init:cache_nbytes=0
test_result:init:cache_nbytes=0
[CUDA] cuda0: usage: 15.00 GB
[SAM] cuda0 data alloc        : 146.25 MB
[SAM] cuda0 workspace         : 2.84 GB
[SAM] cuda0 workspace reserve : 1.29 GB
[SAM] cuda0 total             : 2.98 GB
    [Step(average) Profiler Level 1 E3 S31]
        L1  sample           0.065173 | send           0.000000
        L1  recv             0.000000 | copy           0.010205 | convert time 0.000516 | train  0.009089
        L1  feature nbytes    1.13 GB | label nbytes   62.50 KB
        L1  id nbytes      0.00 Bytes | graph nbytes 0.00 Bytes
        L1  miss nbytes      85.03 MB | remote nbytes  624.41 MB
        L1  num nodes         1188707 | num samples     1335067
    [Step(average) Profiler Level 2 E3 S31]
        L2  shuffle     0.000201 | core sample  0.061518 | id remap        0.003315
        L2  graph copy  0.000000 | id copy      0.000000 | cache feat copy 0.008619
        L2  last layer sample time 0.000725 | size 58909.651568
    [Step(average) Profiler Level 3 E3 S31]
        L3  khop sample coo  0.061203 | khop sort coo      0.000000 | khop count edge     0.000045 | khop compact edge 0.000220
        L3  walk sample coo  0.000000 | walk topk total    0.000000 | walk topk step1     0.000000 | walk topk step2   0.000000
        L3  walk topk step3  0.000000 | walk topk step4    0.000000 | walk topk step5     0.000000
        L3  walk topk step6  0.000000 | walk topk step7    0.000000
        L3  remap unique     0.000000 | remap populate     0.002835 | remap mapnode       0.000000 | remap mapedge     0.000479
        L3  cache get_index  0.000949 | cache copy_index   0.000000 | cache extract_miss  0.000000
        L3  cache copy_miss  0.000000 | cache combine_miss 0.007664 | cache combine cache 0.006794 | cache combine remote 0.005533
        L3  label extract  0.000186
    [Init Profiler Level 1]
        L1  init    13.7846 | sampler init    15.9049 | trainer init 15.0148
    [Init Profiler Level 2]
        L2  load ds        23.8876 | init queue           0.0000
        L2  presample       3.9359 | build interal ds     1.8638
        L2  build cache    15.0133
    [Init Profiler Level 3]
        L3  load dataset: mmap    13.7825 | copy         0.0000
        L3  dist queue: alloc      0.0000 | pin          0.0000 | push     0.0000
        L3  presample: init        0.1777
        L3  presample: sample      1.3475 | copy         0.0958
        L3  presample: count       0.6955 | sort         0.1848
        L3  presample: reset       0.0011 | get rank     0.0184
        L3  internal: cuda ctx     0.0001 | cuda stream     0.0000
[Worker 0/4] Started with PID 29511(Tesla V100-SXM2-16GB)
worker 0 at process 29511
[Worker 0] run for 4 epochs with 32 steps
Epoch 00000 | Epoch Time 3.7074 | Sample 2.1245 | Copy 0.3563 | Total Train(Profiler) 1.2225
Epoch 00001 | Epoch Time 2.7246 | Sample 2.0870 | Copy 0.3244 | Total Train(Profiler) 0.3099
Epoch 00002 | Epoch Time 2.7203 | Sample 2.0886 | Copy 0.3253 | Total Train(Profiler) 0.3031
Epoch 00003 | Epoch Time 2.7260 | Sample 2.0877 | Copy 0.3325 | Total Train(Profiler) 0.3020
[Train  Worker 0] Avg Epoch 2.7236 | Sample 2.0878 | Copy 0.3274 | Train Total (Profiler) 0.3050
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    8309 KB |  743393 KB |  195699 MB |  195691 MB |
|       from large pool |    3678 KB |  741966 KB |  194556 MB |  194553 MB |
|       from small pool |    4631 KB |    6579 KB |    1142 MB |    1138 MB |
|---------------------------------------------------------------------------|
| Active memory         |    8310 KB |  743393 KB |  195699 MB |  195691 MB |
|       from large pool |    3678 KB |  741966 KB |  194556 MB |  194553 MB |
|       from small pool |    4632 KB |    6579 KB |    1142 MB |    1138 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  757760 KB |  757760 KB |  757760 KB |       0 B  |
|       from large pool |  749568 KB |  749568 KB |  749568 KB |       0 B  |
|       from small pool |    8192 KB |    8192 KB |    8192 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   16266 KB |  658089 KB |  187467 MB |  187451 MB |
|       from large pool |   14754 KB |  656422 KB |  186055 MB |  186040 MB |
|       from small pool |    1512 KB |    3149 KB |    1412 MB |    1410 MB |
|---------------------------------------------------------------------------|
| Allocations           |      35    |      51    |   14245    |   14210    |
|       from large pool |       1    |      14    |    5632    |    5631    |
|       from small pool |      34    |      39    |    8613    |    8579    |
|---------------------------------------------------------------------------|
| Active allocs         |      36    |      51    |   14245    |   14209    |
|       from large pool |       1    |      14    |    5632    |    5631    |
|       from small pool |      35    |      39    |    8613    |    8578    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      10    |      10    |      10    |       0    |
|       from large pool |       6    |       6    |       6    |       0    |
|       from small pool |       4    |       4    |       4    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      10    |      21    |    6643    |    6633    |
|       from large pool |       1    |       8    |    3296    |    3295    |
|       from small pool |       9    |      17    |    3347    |    3338    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

test_result:sample_time=nan
test_result:epoch_time:sample_total=2.0878
test_result:epoch_time:copy_time=0.3274
test_result:convert_time=0.0157
test_result:train_time=0.2893
test_result:epoch_time:train_total=0.3050
test_result:cache_percentage=0.1200
test_result:cache_hit_rate=1.0000
test_result:epoch_time:total=2.7236
test_result:run_time=11.8804
[Worker 1/4] Started with PID 29512(Tesla V100-SXM2-16GB)
worker 1 at process 29512
[Worker 1] run for 4 epochs with 32 steps
[Train  Worker 1] Avg Epoch 2.7237 | Sample 2.0861 | Copy 0.3252 | Train Total (Profiler) 0.3088
[Worker 2/4] Started with PID 29514(Tesla V100-SXM2-16GB)
worker 2 at process 29514
[Worker 2] run for 4 epochs with 32 steps
[Train  Worker 2] Avg Epoch 2.7236 | Sample 2.0798 | Copy 0.3360 | Train Total (Profiler) 0.3044
[Worker 3/4] Started with PID 29515(Tesla V100-SXM2-16GB)
worker 3 at process 29515
[Worker 3] run for 4 epochs with 32 steps
[Train  Worker 3] Avg Epoch 2.7236 | Sample 2.0871 | Copy 0.3256 | Train Total (Profiler) 0.3071

