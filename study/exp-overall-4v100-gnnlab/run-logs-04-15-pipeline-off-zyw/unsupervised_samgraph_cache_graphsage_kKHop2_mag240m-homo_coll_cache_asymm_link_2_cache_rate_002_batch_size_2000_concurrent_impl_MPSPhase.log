succeed=True
config:eval_tsp="2023-04-15 09:17:03"
config:arch=arch5
config:num_train_worker=3
config:num_sample_worker=1
config:sample_type=khop2
config:root_path=/nvme/graph-learning-copy/samgraph/
config:dataset=mag240m-homo
config:pipeline=False
config:cache_policy=coll_cache_asymm_link
config:cache_percentage=0.02
config:num_epoch=4
config:batch_size=2000
config:num_hidden=256
config:max_sampling_jobs=1
config:max_copying_jobs=1
config:barriered_epoch=1
config:presample_epoch=2
config:omp_thread_num=40
config:unsupervised=True
config:amp=True
config:rolling=0
config:fanout=[25, 10]
config:lr=0.003
config:dropout=0.5
config:single_gpu=False
config:max_num_step=1000
config:validate_configs=False
config:report_acc=0
config:dataset_path=/nvme/graph-learning-copy/samgraph/mag240m-homo
config:torch_thread_num=13
config:train_workers=['cuda:0', 'cuda:1', 'cuda:2']
config:sample_workers=['cuda:3']
config:num_fanout=2
config:num_layer=2
config:_run_mode=RunMode.FGNN
config:_log_level=warn
config:_profile_level=3
config:_empty_feat=25
config:_arch=5
config:_sample_type=5
config:_cache_policy=13
test_result:init:input_scale_factor=1.10327
0 :  {link #0 : 1}, {link #1 : 2},
1 :  {link #0 : 2}, {link #1 : 0},
2 :  {link #0 : 0}, {link #1 : 1},
0 : local 72, cpu 8 {link #0 : g1 36}, {link #1 : g2 36},
1 : local 72, cpu 8 {link #0 : g2 36}, {link #1 : g0 36},
2 : local 72, cpu 8 {link #0 : g0 36}, {link #1 : g1 36},
0 :  {link #0 : 1}, {link #1 : 2},
1 :  {link #0 : 2}, {link #1 : 0},
2 :  {link #0 : 0}, {link #1 : 1},
0 :  {link #0 : 1}, {link #1 : 2},
1 :  {link #0 : 2}, {link #1 : 0},
2 :  {link #0 : 0}, {link #1 : 1},
0 : local 72, cpu 8 {link #0 : g1 36}, {link #1 : g2 36},
1 : local 72, cpu 8 {link #0 : g2 36}, {link #1 : g0 36},
2 : local 72, cpu 8 {link #0 : g0 36}, {link #1 : g1 36},
0 : local 72, cpu 8 {link #0 : g1 36}, {link #1 : g2 36},
1 : local 72, cpu 8 {link #0 : g2 36}, {link #1 : g0 36},
2 : local 72, cpu 8 {link #0 : g0 36}, {link #1 : g1 36},
Set parameter WLSAccessID
Set parameter WLSSecret
Set parameter LicenseID
Set parameter TimeLimit to value 200
Set parameter MIPGap to value 0.05
Set parameter LogFile to value "cppsolver.log"
Set parameter Threads to value 40
Academic license - for non-commercial use only - registered to xiaoniu.sxn@sjtu.edu.cn
Gurobi Optimizer version 9.5.1 build v9.5.1rc2 (linux64)
Thread count: 40 physical cores, 80 logical processors, using up to 40 threads
Academic license - for non-commercial use only - registered to xiaoniu.sxn@sjtu.edu.cn
Optimize a model with 3420 rows, 1624 columns and 12165 nonzeros
Model fingerprint: 0x6acdf70f
Variable types: 4 continuous, 1620 integer (1620 binary)
Coefficient statistics:
  Matrix range     [2e-09, 2e+04]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+03]
Warning: Model contains large matrix coefficient range
         Consider reformulating model or setting NumericFocus parameter
         to avoid numerical issues.
Found heuristic solution: objective 2.000000e+09
Presolve removed 2087 rows and 153 columns
Presolve time: 0.02s
Presolved: 1333 rows, 1471 columns, 4974 nonzeros
Found heuristic solution: objective 25354.207748
Variable types: 1 continuous, 1470 integer (1470 binary)

Root relaxation: objective 1.120707e+04, 1101 iterations, 0.01 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 11207.0685    0   13 25354.2077 11207.0685  55.8%     -    0s
H    0     0                    11504.622313 11207.0685  2.59%     -    0s

Explored 1 nodes (1484 simplex iterations) in 0.05 seconds (0.03 work units)
Thread count was 40 (of 80 available processors)

Solution count 3: 11504.6 25354.2 2e+09 

Optimal solution found (tolerance 5.00e-02)
Best objective 1.150462231258e+04, best bound 1.120706852437e+04, gap 2.5864%
coll_cache:optimal_local_rate=0.167244,0.166807,0.223117,
coll_cache:optimal_remote_rate=0.389925,0.390362,0.334052,
coll_cache:optimal_cpu_rate=0.442831,0.442831,0.442831,
z=11504.6
test_result:init:feat_nbytes=375030526464
test_result:init:cache_nbytes=7875640320
test_result:init:feat_nbytes=375030526464
test_result:init:cache_nbytes=7875640320
test_result:init:feat_nbytes=375030526464
test_result:init:cache_nbytes=7875640320
[Train  Worker 2/3] Started with PID 40316(Tesla V100-SXM2-16GB)
[Train  Worker 2] run train for 4 epochs with 1002 steps
[CUDA] cuda0: usage: 14.20 GB
[SAM] cuda0 data alloc        : 0.00 Bytes
[SAM] cuda0 workspace         : 3.03 GB
[SAM] cuda0 workspace reserve : 1.50 GB
[SAM] cuda0 total             : 3.03 GB
[Train  Worker 1/3] Started with PID 40312(Tesla V100-SXM2-16GB)
[Train  Worker 1] run train for 4 epochs with 1002 steps
[Train  Worker 0/3] Started with PID 40310(Tesla V100-SXM2-16GB)
[Train  Worker 0] run train for 4 epochs with 1002 steps
Epoch 00000 | Epoch Time 26.9460 | Total Train Time(Profiler) 7.9190 | Copy Time 18.9899
[CUDA] cuda0: usage: 14.20 GB
[SAM] cuda0 data alloc        : 0.00 Bytes
[SAM] cuda0 workspace         : 3.03 GB
[SAM] cuda0 workspace reserve : 1.50 GB
[SAM] cuda0 total             : 3.03 GB
Epoch 00001 | Epoch Time 25.4409 | Total Train Time(Profiler) 6.4312 | Copy Time 18.9776
[CUDA] cuda0: usage: 14.20 GB
[SAM] cuda0 data alloc        : 0.00 Bytes
[SAM] cuda0 workspace         : 3.03 GB
[SAM] cuda0 workspace reserve : 1.50 GB
[SAM] cuda0 total             : 3.03 GB
Epoch 00002 | Epoch Time 25.4584 | Total Train Time(Profiler) 6.4402 | Copy Time 18.9848
[CUDA] cuda0: usage: 14.20 GB
[SAM] cuda0 data alloc        : 0.00 Bytes
[SAM] cuda0 workspace         : 3.03 GB
[SAM] cuda0 workspace reserve : 1.50 GB
[SAM] cuda0 total             : 3.03 GB
Epoch 00003 | Epoch Time 25.4944 | Total Train Time(Profiler) 6.4814 | Copy Time 18.9799
[Train  Worker 2] Avg Epoch Time 25.4650 | Train Total Time(Profiler) 6.4438 | Copy Time 18.9890
[Train  Worker 1] Avg Epoch Time 25.4650 | Train Total Time(Profiler) 6.4467 | Copy Time 18.9860
[Train  Worker 0] Avg Epoch Time 25.4646 | Train Total Time(Profiler) 6.4510 | Copy Time 18.9808
    [Step(average) Profiler Level 1 E3 S1001]
        L1  sample           0.003684 | send           0.000988
        L1  recv             0.001130 | copy           0.056842 | convert time 0.000487 | train  0.018816
        L1  feature nbytes    1.36 GB | label nbytes   15.62 KB
        L1  id nbytes      0.00 Bytes | graph nbytes    8.41 MB
        L1  miss nbytes     632.35 MB | remote nbytes  509.98 MB
        L1  num nodes          953874 | num samples     1098829
    [Step(average) Profiler Level 2 E3 S1001]
        L2  shuffle     0.000085 | core sample  0.001056 | id remap        0.002358
        L2  graph copy  0.000003 | id copy      0.000000 | cache feat copy 0.055709
        L2  last layer sample time 0.000279 | size 49777.131448
    [Step(average) Profiler Level 3 E3 S1001]
        L3  khop sample coo  0.000771 | khop sort coo      0.000000 | khop count edge     0.000034 | khop compact edge 0.000200
        L3  walk sample coo  0.000000 | walk topk total    0.000000 | walk topk step1     0.000000 | walk topk step2   0.000000
        L3  walk topk step3  0.000000 | walk topk step4    0.000000 | walk topk step5     0.000000
        L3  walk topk step6  0.000000 | walk topk step7    0.000000
        L3  remap unique     0.000176 | remap populate     0.002008 | remap mapnode       0.000000 | remap mapedge     0.000362
        L3  cache get_index  0.000716 | cache copy_index   0.000000 | cache extract_miss  0.000000
        L3  cache copy_miss  0.000000 | cache combine_miss 0.054509 | cache combine cache 0.000974 | cache combine remote 0.006450
        L3  label extract  0.000033
    [Init Profiler Level 1]
        L1  init    12.4073 | sampler init    65.3412 | trainer init 0.0000
    [Init Profiler Level 2]
        L2  load ds        15.6333 | init queue          40.7239
        L2  presample      19.6243 | build interal ds     1.7645
        L2  build cache     0.0000
    [Init Profiler Level 3]
        L3  load dataset: mmap    12.4044 | copy         3.2289
        L3  dist queue: alloc      0.0007 | pin         40.7231 | push     0.0000
        L3  presample: init        1.2865
        L3  presample: sample      7.5470 | copy         0.6076
        L3  presample: count       6.9473 | sort         1.1280
        L3  presample: reset       0.0024 | get rank     0.0868
        L3  internal: cuda ctx     1.4614 | cuda stream     0.2933
[Sample Worker 0/1] Started with PID 40308(Tesla V100-SXM2-16GB)
[Sample Worker 0] run sample for 4 epochs with 1002 steps
[Sample Worker 0] Avg Sample Total Time 4.6925 | Sampler Total Time(Profiler) 4.6818
test_result:sample_time=3.6917
test_result:get_cache_miss_index_time=0.0000
test_result:enqueue_samples_time=0.9900
test_result:epoch_time:sample_total=4.6925
[CUDA] cuda0: usage: 14.20 GB
[SAM] cuda0 data alloc        : 0.00 Bytes
[SAM] cuda0 workspace         : 3.03 GB
[SAM] cuda0 workspace reserve : 1.50 GB
[SAM] cuda0 total             : 3.03 GB
    [Step(average) Profiler Level 1 E3 S1001]
        L1  sample           0.003684 | send           0.000988
        L1  recv             0.001130 | copy           0.056842 | convert time 0.000487 | train  0.018816
        L1  feature nbytes    1.36 GB | label nbytes   15.62 KB
        L1  id nbytes      0.00 Bytes | graph nbytes    8.41 MB
        L1  miss nbytes     632.35 MB | remote nbytes  509.98 MB
        L1  num nodes          953874 | num samples     1098829
        L1  seq duration     0.000000 | refresh duration   0.000000
    [Step(average) Profiler Level 2 E3 S1001]
        L2  shuffle     0.000085 | core sample  0.001056 | id remap        0.002358
        L2  graph copy  0.000003 | id copy      0.000000 | cache feat copy 0.055709
        L2  last layer sample time 0.000279 | size 49777.131448
    [Step(average) Profiler Level 3 E3 S1001]
        L3  khop sample coo  0.000771 | khop sort coo      0.000000 | khop count edge     0.000034 | khop compact edge 0.000200
        L3  walk sample coo  0.000000 | walk topk total    0.000000 | walk topk step1     0.000000 | walk topk step2   0.000000
        L3  walk topk step3  0.000000 | walk topk step4    0.000000 | walk topk step5     0.000000
        L3  walk topk step6  0.000000 | walk topk step7    0.000000
        L3  remap unique     0.000176 | remap populate     0.002008 | remap mapnode       0.000000 | remap mapedge     0.000362
        L3  cache get_index  0.000716 | cache copy_index   0.000000 | cache extract_miss  0.000000
        L3  cache copy_miss  0.000000 | cache combine_miss 0.054509 | cache combine cache 0.000974 | cache combine remote 0.006450
        L3  label extract  0.000033
    [Step(max) Profiler Level 1 E3 S1001]
        L1  sample           0.076893 | send           0.001046
        L1  recv             0.007340 | copy           0.063808 | convert time 0.002661 | train  0.024512
        L1  feature nbytes    1.40 GB | label nbytes   15.62 KB
        L1  id nbytes      0.00 Bytes | graph nbytes    8.62 MB
        L1  miss nbytes     651.34 MB | remote nbytes  558.33 MB
        L1  num nodes          978815 | num samples     1126331
    [Step(max) Profiler Level 2 E3 S1001]
        L2  shuffle     0.073053 | core sample  0.001185 | id remap        0.002447
        L2  graph copy  0.000020 | id copy      0.000000 | cache feat copy 0.062670
        L2  last layer sample time 0.000327 | size 50626.000000
    [Step(max) Profiler Level 3 E3 S1001]
        L3  khop sample coo  0.000873 | khop sort coo      0.000000 | khop count edge     0.000045 | khop compact edge 0.000228
        L3  walk sample coo  0.000000 | walk topk total    0.000000 | walk topk step1     0.000000 | walk topk step2   0.000000
        L3  walk topk step3  0.000000 | walk topk step4    0.000000 | walk topk step5     0.000000
        L3  walk topk step6  0.000000 | walk topk step7    0.000000
        L3  remap unique     0.000243 | remap populate     0.002087 | remap mapnode       0.000000 | remap mapedge     0.000379
        L3  cache get_index  0.001701 | cache copy_index   0.000000 | cache extract_miss  0.000000
        L3  cache copy_miss  0.000000 | cache combine_miss 0.056328 | cache combine cache 0.001222 | cache combine remote 0.007031
        L3  label extract  0.000147
    [Step(min) Profiler Level 1 E3 S1001]
        L1  sample           0.003457 | send           0.000965
        L1  recv             0.001084 | copy           0.055566 | convert time 0.000427 | train  0.018326
        L1  feature nbytes    1.33 GB | label nbytes   15.62 KB
        L1  id nbytes      0.00 Bytes | graph nbytes    8.21 MB
        L1  miss nbytes     611.93 MB | remote nbytes  441.35 MB
        L1  num nodes          928953 | num samples     1072387
    [Step(min) Profiler Level 2 E3 S1001]
        L2  shuffle     0.000011 | core sample  0.000983 | id remap        0.002279
        L2  graph copy  0.000003 | id copy      0.000000 | cache feat copy 0.054473
        L2  last layer sample time 0.000267 | size 48983.000000
    [Step(min) Profiler Level 3 E3 S1001]
        L3  khop sample coo  0.000704 | khop sort coo      0.000000 | khop count edge     0.000032 | khop compact edge 0.000193
        L3  walk sample coo  0.000000 | walk topk total    0.000000 | walk topk step1     0.000000 | walk topk step2   0.000000
        L3  walk topk step3  0.000000 | walk topk step4    0.000000 | walk topk step5     0.000000
        L3  walk topk step6  0.000000 | walk topk step7    0.000000
        L3  remap unique     0.000169 | remap populate     0.001940 | remap mapnode       0.000000 | remap mapedge     0.000351
        L3  cache get_index  0.000678 | cache copy_index   0.000000 | cache extract_miss  0.000000
        L3  cache copy_miss  0.000000 | cache combine_miss 0.052768 | cache combine cache 0.000848 | cache combine remote 0.005642
        L3  label extract  0.000015
    [Init Profiler Level 1]
        L1  init    12.4073 | sampler init     0.0000 | trainer init 80.0460
    [Init Profiler Level 2]
        L2  load ds        12.4044 | init queue          40.6223
        L2  presample       0.0000 | build interal ds     1.4509
        L2  build cache    37.9679
    [Init Profiler Level 3]
        L3  load dataset: mmap    12.4044 | copy         0.0000
        L3  dist queue: alloc      0.0007 | pin         40.6216 | push     0.0000
        L3  presample: init        0.0000
        L3  presample: sample      0.0000 | copy         0.0000
        L3  presample: count       0.0000 | sort         0.0000
        L3  presample: reset       0.0000 | get rank     0.0000
        L3  internal: cuda ctx     1.4509 | cuda stream     0.0000
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   35017 KB |  643632 KB |    2351 GB |    2351 GB |
|       from large pool |   25732 KB |  640701 KB |    2333 GB |    2333 GB |
|       from small pool |    9285 KB |   11607 KB |      17 GB |      17 GB |
|---------------------------------------------------------------------------|
| Active memory         |   35017 KB |  643632 KB |    2351 GB |    2351 GB |
|       from large pool |   25732 KB |  640701 KB |    2333 GB |    2333 GB |
|       from small pool |    9285 KB |   11607 KB |      17 GB |      17 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  784384 KB |  784384 KB |  784384 KB |       0 B  |
|       from large pool |  768000 KB |  768000 KB |  768000 KB |       0 B  |
|       from small pool |   16384 KB |   16384 KB |   16384 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   81718 KB |  613963 KB |    1848 GB |    1848 GB |
|       from large pool |   78716 KB |  610172 KB |    1830 GB |    1829 GB |
|       from small pool |    3002 KB |    5577 KB |      18 GB |      18 GB |
|---------------------------------------------------------------------------|
| Allocations           |      43    |      62    |  195093    |  195050    |
|       from large pool |       7    |      18    |   76155    |   76148    |
|       from small pool |      36    |      47    |  118938    |  118902    |
|---------------------------------------------------------------------------|
| Active allocs         |      44    |      62    |  195093    |  195049    |
|       from large pool |       7    |      18    |   76155    |   76148    |
|       from small pool |      37    |      47    |  118938    |  118901    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      17    |      17    |      17    |       0    |
|       from large pool |       9    |       9    |       9    |       0    |
|       from small pool |       8    |       8    |       8    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      20    |      33    |   84121    |   84101    |
|       from large pool |       4    |      13    |   51932    |   51928    |
|       from small pool |      16    |      23    |   32189    |   32173    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

test_result:epoch_time:copy_time=18.9808
test_result:convert_time=0.1635
test_result:train_time=6.2874
test_result:epoch_time:train_total=6.4510
test_result:cache_percentage=0.0200
test_result:cache_hit_rate=1.0000
test_result:run_time=122.0923

