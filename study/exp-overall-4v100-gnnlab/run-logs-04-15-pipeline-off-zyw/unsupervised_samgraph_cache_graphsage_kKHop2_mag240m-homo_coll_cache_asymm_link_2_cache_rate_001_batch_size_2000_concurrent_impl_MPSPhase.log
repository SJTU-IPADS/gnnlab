succeed=True
config:eval_tsp="2023-04-15 09:12:29"
config:arch=arch5
config:num_train_worker=3
config:num_sample_worker=1
config:sample_type=khop2
config:root_path=/nvme/graph-learning-copy/samgraph/
config:dataset=mag240m-homo
config:pipeline=False
config:cache_policy=coll_cache_asymm_link
config:cache_percentage=0.01
config:num_epoch=4
config:batch_size=2000
config:num_hidden=256
config:max_sampling_jobs=1
config:max_copying_jobs=1
config:barriered_epoch=1
config:presample_epoch=2
config:omp_thread_num=40
config:unsupervised=True
config:amp=True
config:rolling=0
config:fanout=[25, 10]
config:lr=0.003
config:dropout=0.5
config:single_gpu=False
config:max_num_step=1000
config:validate_configs=False
config:report_acc=0
config:dataset_path=/nvme/graph-learning-copy/samgraph/mag240m-homo
config:torch_thread_num=13
config:train_workers=['cuda:0', 'cuda:1', 'cuda:2']
config:sample_workers=['cuda:3']
config:num_fanout=2
config:num_layer=2
config:_run_mode=RunMode.FGNN
config:_log_level=warn
config:_profile_level=3
config:_empty_feat=25
config:_arch=5
config:_sample_type=5
config:_cache_policy=13
test_result:init:input_scale_factor=1.1
0 :  {link #0 : 1}, {link #1 : 2},
1 :  {link #0 : 2}, {link #1 : 0},
2 :  {link #0 : 0}, {link #1 : 1},
0 : local 72, cpu 8 {link #0 : g1 36}, {link #1 : g2 36},
1 : local 72, cpu 8 {link #0 : g2 36}, {link #1 : g0 36},
2 : local 72, cpu 8 {link #0 : g0 36}, {link #1 : g1 36},
0 :  {link #0 : 1}, {link #1 : 2},
1 :  {link #0 : 2}, {link #1 : 0},
2 :  {link #0 : 0}, {link #1 : 1},
0 : local 72, cpu 8 {link #0 : g1 36}, {link #1 : g2 36},
1 : local 72, cpu 8 {link #0 : g2 36}, {link #1 : g0 36},
2 : local 72, cpu 8 {link #0 : g0 36}, {link #1 : g1 36},
0 :  {link #0 : 1}, {link #1 : 2},
1 :  {link #0 : 2}, {link #1 : 0},
2 :  {link #0 : 0}, {link #1 : 1},
0 : local 72, cpu 8 {link #0 : g1 36}, {link #1 : g2 36},
1 : local 72, cpu 8 {link #0 : g2 36}, {link #1 : g0 36},
2 : local 72, cpu 8 {link #0 : g0 36}, {link #1 : g1 36},
Set parameter WLSAccessID
Set parameter WLSSecret
Set parameter LicenseID
Set parameter TimeLimit to value 200
Set parameter MIPGap to value 0.05
Set parameter LogFile to value "cppsolver.log"
Set parameter Threads to value 40
Academic license - for non-commercial use only - registered to xiaoniu.sxn@sjtu.edu.cn
Gurobi Optimizer version 9.5.1 build v9.5.1rc2 (linux64)
Thread count: 40 physical cores, 80 logical processors, using up to 40 threads
Academic license - for non-commercial use only - registered to xiaoniu.sxn@sjtu.edu.cn
Optimize a model with 2475 rows, 1174 columns and 8790 nonzeros
Model fingerprint: 0x5dce70e4
Variable types: 4 continuous, 1170 integer (1170 binary)
Coefficient statistics:
  Matrix range     [2e-09, 2e+04]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+03]
Warning: Model contains large matrix coefficient range
         Consider reformulating model or setting NumericFocus parameter
         to avoid numerical issues.
Found heuristic solution: objective 22589.132252
Presolve removed 1653 rows and 264 columns
Presolve time: 0.01s
Presolved: 822 rows, 910 columns, 2457 nonzeros
Variable types: 0 continuous, 910 integer (910 binary)
Found heuristic solution: objective 19998.226932

Root relaxation: objective 1.547825e+04, 620 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 15478.2507    0   16 19998.2269 15478.2507  22.6%     -    0s
H    0     0                    15612.130522 15478.2507  0.86%     -    0s

Explored 1 nodes (784 simplex iterations) in 0.03 seconds (0.01 work units)
Thread count was 40 (of 80 available processors)

Solution count 3: 15612.1 19998.2 22589.1 

Optimal solution found (tolerance 5.00e-02)
Best objective 1.561213052190e+04, best bound 1.547825070596e+04, gap 0.8575%
coll_cache:optimal_local_rate=0.145184,0.104386,0.142904,
coll_cache:optimal_remote_rate=0.246759,0.287558,0.24904,
coll_cache:optimal_cpu_rate=0.608056,0.608056,0.608056,
z=15612.1
test_result:init:feat_nbytes=375030526464
test_result:init:cache_nbytes=4125335040
test_result:init:feat_nbytes=375030526464
test_result:init:cache_nbytes=4125335040
test_result:init:feat_nbytes=375030526464
test_result:init:cache_nbytes=4125335040
[Train  Worker 2/3] Started with PID 39824(Tesla V100-SXM2-16GB)
[Train  Worker 2] run train for 4 epochs with 1002 steps
[CUDA] cuda0: usage: 10.58 GB
[SAM] cuda0 data alloc        : 0.00 Bytes
[SAM] cuda0 workspace         : 3.03 GB
[SAM] cuda0 workspace reserve : 1.50 GB
[SAM] cuda0 total             : 3.03 GB
[Train  Worker 1/3] Started with PID 39821(Tesla V100-SXM2-16GB)
[Train  Worker 1] run train for 4 epochs with 1002 steps
[Train  Worker 0/3] Started with PID 39818(Tesla V100-SXM2-16GB)
[Train  Worker 0] run train for 4 epochs with 1002 steps
Epoch 00000 | Epoch Time 33.3756 | Total Train Time(Profiler) 7.8502 | Copy Time 25.4923
[CUDA] cuda0: usage: 10.58 GB
[SAM] cuda0 data alloc        : 0.00 Bytes
[SAM] cuda0 workspace         : 3.03 GB
[SAM] cuda0 workspace reserve : 1.50 GB
[SAM] cuda0 total             : 3.03 GB
Epoch 00001 | Epoch Time 31.9218 | Total Train Time(Profiler) 6.4462 | Copy Time 25.4428
[CUDA] cuda0: usage: 10.58 GB
[SAM] cuda0 data alloc        : 0.00 Bytes
[SAM] cuda0 workspace         : 3.03 GB
[SAM] cuda0 workspace reserve : 1.50 GB
[SAM] cuda0 total             : 3.03 GB
Epoch 00002 | Epoch Time 31.9111 | Total Train Time(Profiler) 6.4270 | Copy Time 25.4538
[CUDA] cuda0: usage: 10.58 GB
[SAM] cuda0 data alloc        : 0.00 Bytes
[SAM] cuda0 workspace         : 3.03 GB
[SAM] cuda0 workspace reserve : 1.50 GB
[SAM] cuda0 total             : 3.03 GB
Epoch 00003 | Epoch Time 31.9231 | Total Train Time(Profiler) 6.4329 | Copy Time 25.4592
[Train  Worker 1] Avg Epoch Time 31.9189 | Train Total Time(Profiler) 6.4340 | Copy Time 25.4540
[Train  Worker 2] Avg Epoch Time 31.9191 | Train Total Time(Profiler) 6.4424 | Copy Time 25.4450
[Train  Worker 0] Avg Epoch Time 31.9187 | Train Total Time(Profiler) 6.4353 | Copy Time 25.4519
    [Step(average) Profiler Level 1 E3 S1001]
        L1  sample           0.003670 | send           0.000988
        L1  recv             0.001127 | copy           0.076199 | convert time 0.000474 | train  0.018799
        L1  feature nbytes    1.36 GB | label nbytes   15.62 KB
        L1  id nbytes      0.00 Bytes | graph nbytes    8.41 MB
        L1  miss nbytes     858.25 MB | remote nbytes  358.94 MB
        L1  num nodes          953680 | num samples     1098628
    [Step(average) Profiler Level 2 E3 S1001]
        L2  shuffle     0.000082 | core sample  0.001053 | id remap        0.002353
        L2  graph copy  0.000003 | id copy      0.000000 | cache feat copy 0.075068
        L2  last layer sample time 0.000275 | size 49771.819301
    [Step(average) Profiler Level 3 E3 S1001]
        L3  khop sample coo  0.000770 | khop sort coo      0.000000 | khop count edge     0.000034 | khop compact edge 0.000199
        L3  walk sample coo  0.000000 | walk topk total    0.000000 | walk topk step1     0.000000 | walk topk step2   0.000000
        L3  walk topk step3  0.000000 | walk topk step4    0.000000 | walk topk step5     0.000000
        L3  walk topk step6  0.000000 | walk topk step7    0.000000
        L3  remap unique     0.000173 | remap populate     0.002004 | remap mapnode       0.000000 | remap mapedge     0.000361
        L3  cache get_index  0.000678 | cache copy_index   0.000000 | cache extract_miss  0.000000
        L3  cache copy_miss  0.000000 | cache combine_miss 0.073825 | cache combine cache 0.000629 | cache combine remote 0.004553
        L3  label extract  0.000036
    [Init Profiler Level 1]
        L1  init    12.7641 | sampler init    65.5402 | trainer init 0.0000
    [Init Profiler Level 2]
        L2  load ds        15.9598 | init queue          41.1750
        L2  presample      19.3380 | build interal ds     1.8287
        L2  build cache     0.0000
    [Init Profiler Level 3]
        L3  load dataset: mmap    12.7612 | copy         3.1986
        L3  dist queue: alloc      0.0008 | pin         41.1743 | push     0.0000
        L3  presample: init        1.2861
        L3  presample: sample      7.5738 | copy         0.6085
        L3  presample: count       7.1159 | sort         1.0642
        L3  presample: reset       0.0024 | get rank     0.0789
        L3  internal: cuda ctx     1.5248 | cuda stream     0.2940
[Sample Worker 0/1] Started with PID 39816(Tesla V100-SXM2-16GB)
[Sample Worker 0] run sample for 4 epochs with 1002 steps
[Sample Worker 0] Avg Sample Total Time 4.6773 | Sampler Total Time(Profiler) 4.6669
test_result:sample_time=3.6774
test_result:get_cache_miss_index_time=0.0000
test_result:enqueue_samples_time=0.9895
test_result:epoch_time:sample_total=4.6773
[CUDA] cuda0: usage: 10.58 GB
[SAM] cuda0 data alloc        : 0.00 Bytes
[SAM] cuda0 workspace         : 3.03 GB
[SAM] cuda0 workspace reserve : 1.50 GB
[SAM] cuda0 total             : 3.03 GB
    [Step(average) Profiler Level 1 E3 S1001]
        L1  sample           0.003670 | send           0.000988
        L1  recv             0.001127 | copy           0.076199 | convert time 0.000474 | train  0.018799
        L1  feature nbytes    1.36 GB | label nbytes   15.62 KB
        L1  id nbytes      0.00 Bytes | graph nbytes    8.41 MB
        L1  miss nbytes     858.25 MB | remote nbytes  358.94 MB
        L1  num nodes          953680 | num samples     1098628
        L1  seq duration     0.000000 | refresh duration 258635603891673578032499465471040368692917689553174382624255442899804235057945098996725259703462428934340533923706672323218496852159962373383961948407597700743168.000000
    [Step(average) Profiler Level 2 E3 S1001]
        L2  shuffle     0.000082 | core sample  0.001053 | id remap        0.002353
        L2  graph copy  0.000003 | id copy      0.000000 | cache feat copy 0.075068
        L2  last layer sample time 0.000275 | size 49771.819301
    [Step(average) Profiler Level 3 E3 S1001]
        L3  khop sample coo  0.000770 | khop sort coo      0.000000 | khop count edge     0.000034 | khop compact edge 0.000199
        L3  walk sample coo  0.000000 | walk topk total    0.000000 | walk topk step1     0.000000 | walk topk step2   0.000000
        L3  walk topk step3  0.000000 | walk topk step4    0.000000 | walk topk step5     0.000000
        L3  walk topk step6  0.000000 | walk topk step7    0.000000
        L3  remap unique     0.000173 | remap populate     0.002004 | remap mapnode       0.000000 | remap mapedge     0.000361
        L3  cache get_index  0.000678 | cache copy_index   0.000000 | cache extract_miss  0.000000
        L3  cache copy_miss  0.000000 | cache combine_miss 0.073825 | cache combine cache 0.000629 | cache combine remote 0.004553
        L3  label extract  0.000036
    [Step(max) Profiler Level 1 E3 S1001]
        L1  sample           0.075400 | send           0.001012
        L1  recv             0.001722 | copy           0.078500 | convert time 0.001791 | train  0.022036
        L1  feature nbytes    1.40 GB | label nbytes   15.62 KB
        L1  id nbytes      0.00 Bytes | graph nbytes    8.63 MB
        L1  miss nbytes     883.00 MB | remote nbytes  411.21 MB
        L1  num nodes          981218 | num samples     1127134
    [Step(max) Profiler Level 2 E3 S1001]
        L2  shuffle     0.071583 | core sample  0.001174 | id remap        0.002455
        L2  graph copy  0.000022 | id copy      0.000000 | cache feat copy 0.077228
        L2  last layer sample time 0.000329 | size 50689.000000
    [Step(max) Profiler Level 3 E3 S1001]
        L3  khop sample coo  0.000864 | khop sort coo      0.000000 | khop count edge     0.000044 | khop compact edge 0.000232
        L3  walk sample coo  0.000000 | walk topk total    0.000000 | walk topk step1     0.000000 | walk topk step2   0.000000
        L3  walk topk step3  0.000000 | walk topk step4    0.000000 | walk topk step5     0.000000
        L3  walk topk step6  0.000000 | walk topk step7    0.000000
        L3  remap unique     0.000230 | remap populate     0.002091 | remap mapnode       0.000000 | remap mapedge     0.000400
        L3  cache get_index  0.000984 | cache copy_index   0.000000 | cache extract_miss  0.000000
        L3  cache copy_miss  0.000000 | cache combine_miss 0.076126 | cache combine cache 0.001024 | cache combine remote 0.005280
        L3  label extract  0.000117
    [Step(min) Profiler Level 1 E3 S1001]
        L1  sample           0.003474 | send           0.000961
        L1  recv             0.001089 | copy           0.074556 | convert time 0.000420 | train  0.018328
        L1  feature nbytes    1.33 GB | label nbytes   15.62 KB
        L1  id nbytes      0.00 Bytes | graph nbytes    8.18 MB
        L1  miss nbytes     835.34 MB | remote nbytes  326.85 MB
        L1  num nodes          927073 | num samples     1068613
    [Step(min) Profiler Level 2 E3 S1001]
        L2  shuffle     0.000011 | core sample  0.000988 | id remap        0.002276
        L2  graph copy  0.000003 | id copy      0.000000 | cache feat copy 0.073436
        L2  last layer sample time 0.000268 | size 48718.000000
    [Step(min) Profiler Level 3 E3 S1001]
        L3  khop sample coo  0.000709 | khop sort coo      0.000000 | khop count edge     0.000033 | khop compact edge 0.000194
        L3  walk sample coo  0.000000 | walk topk total    0.000000 | walk topk step1     0.000000 | walk topk step2   0.000000
        L3  walk topk step3  0.000000 | walk topk step4    0.000000 | walk topk step5     0.000000
        L3  walk topk step6  0.000000 | walk topk step7    0.000000
        L3  remap unique     0.000169 | remap populate     0.001938 | remap mapnode       0.000000 | remap mapedge     0.000350
        L3  cache get_index  0.000654 | cache copy_index   0.000000 | cache extract_miss  0.000000
        L3  cache copy_miss  0.000000 | cache combine_miss 0.071774 | cache combine cache 0.000196 | cache combine remote 0.004178
        L3  label extract  0.000016
    [Init Profiler Level 1]
        L1  init    12.7641 | sampler init     0.0000 | trainer init 80.6016
    [Init Profiler Level 2]
        L2  load ds        12.7612 | init queue          41.1070
        L2  presample       0.0000 | build interal ds     1.4828
        L2  build cache    38.0073
    [Init Profiler Level 3]
        L3  load dataset: mmap    12.7612 | copy         0.0000
        L3  dist queue: alloc      0.0008 | pin         41.1062 | push     0.0000
        L3  presample: init        0.0000
        L3  presample: sample      0.0000 | copy         0.0000
        L3  presample: count       0.0000 | sort         0.0000
        L3  presample: reset       0.0000 | get rank     0.0000
        L3  internal: cuda ctx     1.4827 | cuda stream     0.0000
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   35199 KB |  643753 KB |    2351 GB |    2351 GB |
|       from large pool |   25910 KB |  640822 KB |    2333 GB |    2333 GB |
|       from small pool |    9289 KB |   11608 KB |      17 GB |      17 GB |
|---------------------------------------------------------------------------|
| Active memory         |   35199 KB |  643753 KB |    2351 GB |    2351 GB |
|       from large pool |   25910 KB |  640822 KB |    2333 GB |    2333 GB |
|       from small pool |    9289 KB |   11608 KB |      17 GB |      17 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  784384 KB |  784384 KB |  784384 KB |       0 B  |
|       from large pool |  768000 KB |  768000 KB |  768000 KB |       0 B  |
|       from small pool |   16384 KB |   16384 KB |   16384 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   32384 KB |  631861 KB |    1851 GB |    1851 GB |
|       from large pool |   29386 KB |  630121 KB |    1830 GB |    1830 GB |
|       from small pool |    2998 KB |    5574 KB |      20 GB |      20 GB |
|---------------------------------------------------------------------------|
| Allocations           |      43    |      62    |  195093    |  195050    |
|       from large pool |       7    |      18    |   76155    |   76148    |
|       from small pool |      36    |      47    |  118938    |  118902    |
|---------------------------------------------------------------------------|
| Active allocs         |      44    |      62    |  195093    |  195049    |
|       from large pool |       7    |      18    |   76155    |   76148    |
|       from small pool |      37    |      47    |  118938    |  118901    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      17    |      17    |      17    |       0    |
|       from large pool |       9    |       9    |       9    |       0    |
|       from small pool |       8    |       8    |       8    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      18    |      30    |   88781    |   88763    |
|       from large pool |       3    |      14    |   51941    |   51938    |
|       from small pool |      15    |      21    |   36840    |   36825    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

test_result:epoch_time:copy_time=25.4519
test_result:convert_time=0.1582
test_result:train_time=6.2771
test_result:epoch_time:train_total=6.4353
test_result:cache_percentage=0.0100
test_result:cache_hit_rate=1.0000
test_result:run_time=147.9159

