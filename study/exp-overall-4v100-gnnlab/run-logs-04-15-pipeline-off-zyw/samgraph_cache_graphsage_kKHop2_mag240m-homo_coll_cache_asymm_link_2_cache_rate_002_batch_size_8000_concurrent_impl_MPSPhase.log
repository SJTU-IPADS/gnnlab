succeed=True
config:eval_tsp="2023-04-15 09:27:37"
config:arch=arch5
config:num_train_worker=3
config:num_sample_worker=1
config:sample_type=khop2
config:root_path=/nvme/graph-learning-copy/samgraph/
config:dataset=mag240m-homo
config:pipeline=False
config:cache_policy=coll_cache_asymm_link
config:cache_percentage=0.02
config:num_epoch=4
config:batch_size=8000
config:num_hidden=256
config:max_sampling_jobs=1
config:max_copying_jobs=1
config:barriered_epoch=1
config:presample_epoch=2
config:omp_thread_num=40
config:unsupervised=False
config:amp=True
config:rolling=0
config:fanout=[25, 10]
config:lr=0.003
config:dropout=0.5
config:single_gpu=False
config:max_num_step=100000
config:validate_configs=False
config:report_acc=0
config:dataset_path=/nvme/graph-learning-copy/samgraph/mag240m-homo
config:torch_thread_num=13
config:train_workers=['cuda:0', 'cuda:1', 'cuda:2']
config:sample_workers=['cuda:3']
config:num_fanout=2
config:num_layer=2
config:_run_mode=RunMode.FGNN
config:_log_level=warn
config:_profile_level=3
config:_empty_feat=25
config:_arch=5
config:_sample_type=5
config:_cache_policy=13
test_result:init:input_scale_factor=1.1
0 :  {link #0 : 1}, {link #1 : 2},
1 :  {link #0 : 2}, {link #1 : 0},
2 :  {link #0 : 0}, {link #1 : 1},
0 :  {link #0 : 1}, {link #1 : 2},
1 :  {link #0 : 2}, {link #1 : 0},
2 :  {link #0 : 0}, {link #1 : 1},
0 : local 72, cpu 8 {link #0 : g1 36}, {link #1 : g2 36},
1 : local 72, cpu 8 {link #0 : g2 36}, {link #1 : g0 36},
2 : local 72, cpu 8 {link #0 : g0 36}, {link #1 : g1 36},
0 : local 72, cpu 8 {link #0 : g1 36}, {link #1 : g2 36},
1 : local 72, cpu 8 {link #0 : g2 36}, {link #1 : g0 36},
2 : local 72, cpu 8 {link #0 : g0 36}, {link #1 : g1 36},
0 :  {link #0 : 1}, {link #1 : 2},
1 :  {link #0 : 2}, {link #1 : 0},
2 :  {link #0 : 0}, {link #1 : 1},
0 : local 72, cpu 8 {link #0 : g1 36}, {link #1 : g2 36},
1 : local 72, cpu 8 {link #0 : g2 36}, {link #1 : g0 36},
2 : local 72, cpu 8 {link #0 : g0 36}, {link #1 : g1 36},
Set parameter WLSAccessID
Set parameter WLSSecret
Set parameter LicenseID
Set parameter TimeLimit to value 200
Set parameter MIPGap to value 0.05
Set parameter LogFile to value "cppsolver.log"
Set parameter Threads to value 40
Academic license - for non-commercial use only - registered to xiaoniu.sxn@sjtu.edu.cn
Gurobi Optimizer version 9.5.1 build v9.5.1rc2 (linux64)
Thread count: 40 physical cores, 80 logical processors, using up to 40 threads
Academic license - for non-commercial use only - registered to xiaoniu.sxn@sjtu.edu.cn
Optimize a model with 2832 rows, 1344 columns and 10065 nonzeros
Model fingerprint: 0xd969d60f
Variable types: 4 continuous, 1340 integer (1340 binary)
Coefficient statistics:
  Matrix range     [2e-09, 9e+02]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 6e+02]
Found heuristic solution: objective 2781.9568095
Presolve removed 1703 rows and 103 columns
Presolve time: 0.01s
Presolved: 1129 rows, 1241 columns, 5341 nonzeros
Variable types: 1 continuous, 1240 integer (1240 binary)

Root relaxation: objective 2.839829e+02, 1175 iterations, 0.01 seconds (0.01 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0  283.98292    0   23 2781.95681  283.98292  89.8%     -    0s
H    0     0                     314.9390985  283.98292  9.83%     -    0s
H    0     0                     291.3955853  283.98292  2.54%     -    0s

Explored 1 nodes (1448 simplex iterations) in 0.06 seconds (0.03 work units)
Thread count was 40 (of 80 available processors)

Solution count 3: 291.396 314.939 2781.96 

Optimal solution found (tolerance 5.00e-02)
Best objective 2.913955852599e+02, best bound 2.839829229974e+02, gap 2.5438%
coll_cache:optimal_local_rate=0.536756,0.577714,0.553124,
coll_cache:optimal_remote_rate=0.40847,0.367512,0.392102,
coll_cache:optimal_cpu_rate=0.0547742,0.0547742,0.0547742,
z=291.396
test_result:init:feat_nbytes=375030526464
test_result:init:cache_nbytes=7875640320
test_result:init:feat_nbytes=375030526464
test_result:init:cache_nbytes=7875640320
test_result:init:feat_nbytes=375030526464
test_result:init:cache_nbytes=7875640320
0 :  {link #0 : 1}, {link #1 : 2},
1 :  {link #0 : 2}, {link #1 : 0},
2 :  {link #0 : 0}, {link #1 : 1},
0 : local 72, cpu 8 {link #0 : g1 36}, {link #1 : g2 36},
1 : local 72, cpu 8 {link #0 : g2 36}, {link #1 : g0 36},
2 : local 72, cpu 8 {link #0 : g0 36}, {link #1 : g1 36},
0 :  {link #0 : 1}, {link #1 : 2},
1 :  {link #0 : 2}, {link #1 : 0},
2 :  {link #0 : 0}, {link #1 : 1},
0 : local 72, cpu 8 {link #0 : g1 36}, {link #1 : g2 36},
1 : local 72, cpu 8 {link #0 : g2 36}, {link #1 : g0 36},
2 : local 72, cpu 8 {link #0 : g0 36}, {link #1 : g1 36},
0 :  {link #0 : 1}, {link #1 : 2},
1 :  {link #0 : 2}, {link #1 : 0},
2 :  {link #0 : 0}, {link #1 : 1},
0 : local 72, cpu 8 {link #0 : g1 36}, {link #1 : g2 36},
1 : local 72, cpu 8 {link #0 : g2 36}, {link #1 : g0 36},
2 : local 72, cpu 8 {link #0 : g0 36}, {link #1 : g1 36},
test_result:init:cache_nbytes=0
test_result:init:cache_nbytes=0
test_result:init:cache_nbytes=0
[Train  Worker 2/3] Started with PID 44235(Tesla V100-SXM2-16GB)
[Train  Worker 2] run train for 4 epochs with 141 steps
[Train  Worker 2] Avg Epoch Time 1.6499 | Train Total Time(Profiler) 1.0407 | Copy Time 0.6042
[Train  Worker 0/3] Started with PID 44232(Tesla V100-SXM2-16GB)
[Train  Worker 0] run train for 4 epochs with 141 steps
Epoch 00000 | Epoch Time 2.8280 | Total Train Time(Profiler) 2.2007 | Copy Time 0.6210
Epoch 00001 | Epoch Time 1.6639 | Total Train Time(Profiler) 1.0466 | Copy Time 0.6124
Epoch 00002 | Epoch Time 1.6335 | Total Train Time(Profiler) 1.0382 | Copy Time 0.5901
Epoch 00003 | Epoch Time 1.6526 | Total Train Time(Profiler) 1.0448 | Copy Time 0.6030
[Train  Worker 0] Avg Epoch Time 1.6500 | Train Total Time(Profiler) 1.0432 | Copy Time 0.6018
[Train  Worker 1/3] Started with PID 44233(Tesla V100-SXM2-16GB)
[Train  Worker 1] run train for 4 epochs with 141 steps
[Train  Worker 1] Avg Epoch Time 1.6499 | Train Total Time(Profiler) 1.0435 | Copy Time 0.6006
    [Step(average) Profiler Level 1 E3 S140]
        L1  sample           0.004718 | send           0.001233
        L1  recv             0.001567 | copy           0.012814 | convert time 0.000514 | train  0.021666
        L1  feature nbytes    1.51 GB | label nbytes   62.50 KB
        L1  id nbytes      0.00 Bytes | graph nbytes   11.14 MB
        L1  miss nbytes     106.39 MB | remote nbytes  588.54 MB
        L1  num nodes         1052496 | num samples     1459993
    [Step(average) Profiler Level 2 E3 S140]
        L2  shuffle     0.000277 | core sample  0.001506 | id remap        0.002839
        L2  graph copy  0.000005 | id copy      0.000000 | cache feat copy 0.011242
        L2  last layer sample time 0.000289 | size 65742.286730
    [Step(average) Profiler Level 3 E3 S140]
        L3  khop sample coo  0.001227 | khop sort coo      0.000000 | khop count edge     0.000036 | khop compact edge 0.000206
        L3  walk sample coo  0.000000 | walk topk total    0.000000 | walk topk step1     0.000000 | walk topk step2   0.000000
        L3  walk topk step3  0.000000 | walk topk step4    0.000000 | walk topk step5     0.000000
        L3  walk topk step6  0.000000 | walk topk step7    0.000000
        L3  remap unique     0.000000 | remap populate     0.002390 | remap mapnode       0.000000 | remap mapedge     0.000449
        L3  cache get_index  0.000812 | cache copy_index   0.000000 | cache extract_miss  0.000000
        L3  cache copy_miss  0.000000 | cache combine_miss 0.009477 | cache combine cache 0.002557 | cache combine remote 0.007448
        L3  label extract  0.000176
    [Init Profiler Level 1]
        L1  init    12.0793 | sampler init    12.0735 | trainer init 0.0000
    [Init Profiler Level 2]
        L2  load ds        15.2688 | init queue           3.1713
        L2  presample       4.0174 | build interal ds     1.6921
        L2  build cache     0.0000
    [Init Profiler Level 3]
        L3  load dataset: mmap    12.0744 | copy         3.1944
        L3  dist queue: alloc      0.0026 | pin          3.1687 | push     0.0000
        L3  presample: init        0.6384
        L3  presample: sample      1.3589 | copy         0.0953
        L3  presample: count       0.5799 | sort         0.5562
        L3  presample: reset       0.0004 | get rank     0.0739
        L3  internal: cuda ctx     1.4502 | cuda stream     0.2375
[Sample Worker 0/1] Started with PID 44230(Tesla V100-SXM2-16GB)
[Sample Worker 0] run sample for 4 epochs with 141 steps
[Sample Worker 0] Avg Sample Total Time 0.8402 | Sampler Total Time(Profiler) 0.8390
test_result:sample_time=0.6652
test_result:get_cache_miss_index_time=0.0000
test_result:enqueue_samples_time=0.1738
test_result:epoch_time:sample_total=0.8402
[CUDA] cuda0: usage: 14.49 GB
[SAM] cuda0 data alloc        : 0.00 Bytes
[SAM] cuda0 workspace         : 3.32 GB
[SAM] cuda0 workspace reserve : 1.64 GB
[SAM] cuda0 total             : 3.32 GB
    [Step(average) Profiler Level 1 E3 S140]
        L1  sample           0.004718 | send           0.001233
        L1  recv             0.001567 | copy           0.012814 | convert time 0.000514 | train  0.021666
        L1  feature nbytes    1.51 GB | label nbytes   62.50 KB
        L1  id nbytes      0.00 Bytes | graph nbytes   11.14 MB
        L1  miss nbytes     106.39 MB | remote nbytes  588.54 MB
        L1  num nodes         1052496 | num samples     1459993
        L1  seq duration     0.000000 | refresh duration 4070163530314327327313063537306732719785068278229688891223812028941415077793210802882182381568.000000
    [Step(average) Profiler Level 2 E3 S140]
        L2  shuffle     0.000277 | core sample  0.001506 | id remap        0.002839
        L2  graph copy  0.000005 | id copy      0.000000 | cache feat copy 0.011242
        L2  last layer sample time 0.000289 | size 65742.286730
    [Step(average) Profiler Level 3 E3 S140]
        L3  khop sample coo  0.001227 | khop sort coo      0.000000 | khop count edge     0.000036 | khop compact edge 0.000206
        L3  walk sample coo  0.000000 | walk topk total    0.000000 | walk topk step1     0.000000 | walk topk step2   0.000000
        L3  walk topk step3  0.000000 | walk topk step4    0.000000 | walk topk step5     0.000000
        L3  walk topk step6  0.000000 | walk topk step7    0.000000
        L3  remap unique     0.000000 | remap populate     0.002390 | remap mapnode       0.000000 | remap mapedge     0.000449
        L3  cache get_index  0.000812 | cache copy_index   0.000000 | cache extract_miss  0.000000
        L3  cache copy_miss  0.000000 | cache combine_miss 0.009477 | cache combine cache 0.002557 | cache combine remote 0.007448
        L3  label extract  0.000176
    [Init Profiler Level 1]
        L1  init    12.0793 | sampler init     0.0000 | trainer init 26.2690
    [Init Profiler Level 2]
        L2  load ds        12.0744 | init queue           3.2567
        L2  presample       0.0000 | build interal ds     1.4778
        L2  build cache    21.5356
    [Init Profiler Level 3]
        L3  load dataset: mmap    12.0744 | copy         0.0000
        L3  dist queue: alloc      0.0026 | pin          3.2540 | push     0.0000
        L3  presample: init        0.0000
        L3  presample: sample      0.0000 | copy         0.0000
        L3  presample: count       0.0000 | sort         0.0000
        L3  presample: reset       0.0000 | get rank     0.0000
        L3  internal: cuda ctx     1.4778 | cuda stream     0.0001
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   42130 KB |  730680 KB |  401013 MB |  400971 MB |
|       from large pool |   32501 KB |  727644 KB |  398203 MB |  398171 MB |
|       from small pool |    9629 KB |   11961 KB |    2809 MB |    2800 MB |
|---------------------------------------------------------------------------|
| Active memory         |   42131 KB |  730680 KB |  401013 MB |  400971 MB |
|       from large pool |   32501 KB |  727644 KB |  398203 MB |  398171 MB |
|       from small pool |    9629 KB |   11961 KB |    2809 MB |    2800 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |     882 MB |     882 MB |     882 MB |       0 B  |
|       from large pool |     866 MB |     866 MB |     866 MB |       0 B  |
|       from small pool |      16 MB |      16 MB |      16 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  113517 KB |  711454 KB |  296200 MB |  296089 MB |
|       from large pool |  110858 KB |  708096 KB |  293215 MB |  293107 MB |
|       from small pool |    2658 KB |    5985 KB |    2984 MB |    2981 MB |
|---------------------------------------------------------------------------|
| Allocations           |      42    |      57    |   22597    |   22555    |
|       from large pool |       7    |      18    |    9779    |    9772    |
|       from small pool |      35    |      41    |   12818    |   12783    |
|---------------------------------------------------------------------------|
| Active allocs         |      43    |      57    |   22597    |   22554    |
|       from large pool |       7    |      18    |    9779    |    9772    |
|       from small pool |      36    |      41    |   12818    |   12782    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      18    |      18    |      18    |       0    |
|       from large pool |      10    |      10    |      10    |       0    |
|       from small pool |       8    |       8    |       8    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      18    |      28    |   10997    |   10979    |
|       from large pool |       6    |      13    |    6456    |    6450    |
|       from small pool |      12    |      20    |    4541    |    4529    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

test_result:epoch_time:copy_time=0.6018
test_result:convert_time=0.0245
test_result:train_time=1.0188
test_result:epoch_time:train_total=1.0432
test_result:cache_percentage=0.0200
test_result:cache_hit_rate=1.0000
test_result:run_time=11.1476

