succeed=True
config:eval_tsp="2023-04-15 12:43:59"
config:arch=arch5
config:num_train_worker=6
config:num_sample_worker=2
config:sample_type=khop2
config:root_path=/nvme/graph-learning-copy/samgraph/
config:dataset=mag240m-homo
config:pipeline=True
config:cache_policy=coll_cache_asymm_link
config:cache_percentage=0.1
config:num_epoch=4
config:batch_size=2000
config:num_hidden=256
config:max_sampling_jobs=1
config:max_copying_jobs=1
config:barriered_epoch=1
config:presample_epoch=2
config:omp_thread_num=40
config:unsupervised=True
config:amp=True
config:rolling=0
config:fanout=[25, 10]
config:lr=0.003
config:dropout=0.5
config:single_gpu=False
config:max_num_step=1000
config:validate_configs=False
config:report_acc=0
config:dataset_path=/nvme/graph-learning-copy/samgraph/mag240m-homo
config:torch_thread_num=9
config:train_workers=['cuda:0', 'cuda:1', 'cuda:2', 'cuda:3', 'cuda:4', 'cuda:5']
config:sample_workers=['cuda:6', 'cuda:7']
config:num_fanout=2
config:num_layer=2
config:_run_mode=RunMode.FGNN
config:_log_level=warn
config:_profile_level=3
config:_empty_feat=25
config:_arch=5
config:_sample_type=5
config:_cache_policy=13
test_result:init:input_scale_factor=1.1
0 :  {link #0 : 1}, {link #1 : 2}, {link #2 : 3}, {link #3 : 4}, {link #4 : 5},
1 :  {link #0 : 2}, {link #1 : 3}, {link #2 : 4}, {link #3 : 5}, {link #4 : 0},
2 :  {link #0 : 3}, {link #1 : 4}, {link #2 : 5}, {link #3 : 0}, {link #4 : 1},
3 :  {link #0 : 4}, {link #1 : 5}, {link #2 : 0}, {link #3 : 1}, {link #4 : 2},
4 :  {link #0 : 5}, {link #1 : 0}, {link #2 : 1}, {link #3 : 2}, {link #4 : 3},
5 :  {link #0 : 0}, {link #1 : 1}, {link #2 : 2}, {link #3 : 3}, {link #4 : 4},
0 :  {link #0 : 1}, {link #1 : 2}, {link #2 : 3}, {link #3 : 4}, {link #4 : 5},
1 :  {link #0 : 2}, {link #1 : 3}, {link #2 : 4}, {link #3 : 5}, {link #4 : 0},
2 :  {link #0 : 3}, {link #1 : 4}, {link #2 : 5}, {link #3 : 0}, {link #4 : 1},
3 :  {link #0 : 4}, {link #1 : 5}, {link #2 : 0}, {link #3 : 1}, {link #4 : 2},
4 :  {link #0 : 5}, {link #1 : 0}, {link #2 : 1}, {link #3 : 2}, {link #4 : 3},
5 :  {link #0 : 0}, {link #1 : 1}, {link #2 : 2}, {link #3 : 3}, {link #4 : 4},
0 : local 98, cpu 10 {link #0 : g1 11}, {link #1 : g2 11}, {link #2 : g3 11}, {link #3 : g4 11}, {link #4 : g5 11},
1 : local 98, cpu 10 {link #0 : g2 11}, {link #1 : g3 11}, {link #2 : g4 11}, {link #3 : g5 11}, {link #4 : g0 11},
2 : local 98, cpu 10 {link #0 : g3 11}, {link #1 : g4 11}, {link #2 : g5 11}, {link #3 : g0 11}, {link #4 : g1 11},
3 : local 98, cpu 10 {link #0 : g4 11}, {link #1 : g5 11}, {link #2 : g0 11}, {link #3 : g1 11}, {link #4 : g2 11},
4 : local 98, cpu 10 {link #0 : g5 11}, {link #1 : g0 11}, {link #2 : g1 11}, {link #3 : g2 11}, {link #4 : g3 11},
5 : local 98, cpu 10 {link #0 : g0 11}, {link #1 : g1 11}, {link #2 : g2 11}, {link #3 : g3 11}, {link #4 : g4 11},
0 : local 98, cpu 10 {link #0 : g1 11}, {link #1 : g2 11}, {link #2 : g3 11}, {link #3 : g4 11}, {link #4 : g5 11},
1 : local 98, cpu 10 {link #0 : g2 11}, {link #1 : g3 11}, {link #2 : g4 11}, {link #3 : g5 11}, {link #4 : g0 11},
2 : local 98, cpu 10 {link #0 : g3 11}, {link #1 : g4 11}, {link #2 : g5 11}, {link #3 : g0 11}, {link #4 : g1 11},
3 : local 98, cpu 10 {link #0 : g4 11}, {link #1 : g5 11}, {link #2 : g0 11}, {link #3 : g1 11}, {link #4 : g2 11},
4 : local 98, cpu 10 {link #0 : g5 11}, {link #1 : g0 11}, {link #2 : g1 11}, {link #3 : g2 11}, {link #4 : g3 11},
5 : local 98, cpu 10 {link #0 : g0 11}, {link #1 : g1 11}, {link #2 : g2 11}, {link #3 : g3 11}, {link #4 : g4 11},
0 :  {link #0 : 1}, {link #1 : 2}, {link #2 : 3}, {link #3 : 4}, {link #4 : 5},
1 :  {link #0 : 2}, {link #1 : 3}, {link #2 : 4}, {link #3 : 5}, {link #4 : 0},
2 :  {link #0 : 3}, {link #1 : 4}, {link #2 : 5}, {link #3 : 0}, {link #4 : 1},
3 :  {link #0 : 4}, {link #1 : 5}, {link #2 : 0}, {link #3 : 1}, {link #4 : 2},
4 :  {link #0 : 5}, {link #1 : 0}, {link #2 : 1}, {link #3 : 2}, {link #4 : 3},
5 :  {link #0 : 0}, {link #1 : 1}, {link #2 : 2}, {link #3 : 3}, {link #4 : 4},
0 : local 98, cpu 10 {link #0 : g1 11}, {link #1 : g2 11}, {link #2 : g3 11}, {link #3 : g4 11}, {link #4 : g5 11},
1 : local 98, cpu 10 {link #0 : g2 11}, {link #1 : g3 11}, {link #2 : g4 11}, {link #3 : g5 11}, {link #4 : g0 11},
2 : local 98, cpu 10 {link #0 : g3 11}, {link #1 : g4 11}, {link #2 : g5 11}, {link #3 : g0 11}, {link #4 : g1 11},
3 : local 98, cpu 10 {link #0 : g4 11}, {link #1 : g5 11}, {link #2 : g0 11}, {link #3 : g1 11}, {link #4 : g2 11},
4 : local 98, cpu 10 {link #0 : g5 11}, {link #1 : g0 11}, {link #2 : g1 11}, {link #3 : g2 11}, {link #4 : g3 11},
5 : local 98, cpu 10 {link #0 : g0 11}, {link #1 : g1 11}, {link #2 : g2 11}, {link #3 : g3 11}, {link #4 : g4 11},
0 :  {link #0 : 1}, {link #1 : 2}, {link #2 : 3}, {link #3 : 4}, {link #4 : 5},
1 :  {link #0 : 2}, {link #1 : 3}, {link #2 : 4}, {link #3 : 5}, {link #4 : 0},
2 :  {link #0 : 3}, {link #1 : 4}, {link #2 : 5}, {link #3 : 0}, {link #4 : 1},
3 :  {link #0 : 4}, {link #1 : 5}, {link #2 : 0}, {link #3 : 1}, {link #4 : 2},
4 :  {link #0 : 5}, {link #1 : 0}, {link #2 : 1}, {link #3 : 2}, {link #4 : 3},
5 :  {link #0 : 0}, {link #1 : 1}, {link #2 : 2}, {link #3 : 3}, {link #4 : 4},
0 : local 98, cpu 10 {link #0 : g1 11}, {link #1 : g2 11}, {link #2 : g3 11}, {link #3 : g4 11}, {link #4 : g5 11},
1 : local 98, cpu 10 {link #0 : g2 11}, {link #1 : g3 11}, {link #2 : g4 11}, {link #3 : g5 11}, {link #4 : g0 11},
2 : local 98, cpu 10 {link #0 : g3 11}, {link #1 : g4 11}, {link #2 : g5 11}, {link #3 : g0 11}, {link #4 : g1 11},
3 : local 98, cpu 10 {link #0 : g4 11}, {link #1 : g5 11}, {link #2 : g0 11}, {link #3 : g1 11}, {link #4 : g2 11},
4 : local 98, cpu 10 {link #0 : g5 11}, {link #1 : g0 11}, {link #2 : g1 11}, {link #3 : g2 11}, {link #4 : g3 11},
5 : local 98, cpu 10 {link #0 : g0 11}, {link #1 : g1 11}, {link #2 : g2 11}, {link #3 : g3 11}, {link #4 : g4 11},
0 :  {link #0 : 1}, {link #1 : 2}, {link #2 : 3}, {link #3 : 4}, {link #4 : 5},
1 :  {link #0 : 2}, {link #1 : 3}, {link #2 : 4}, {link #3 : 5}, {link #4 : 0},
2 :  {link #0 : 3}, {link #1 : 4}, {link #2 : 5}, {link #3 : 0}, {link #4 : 1},
3 :  {link #0 : 4}, {link #1 : 5}, {link #2 : 0}, {link #3 : 1}, {link #4 : 2},
4 :  {link #0 : 5}, {link #1 : 0}, {link #2 : 1}, {link #3 : 2}, {link #4 : 3},
5 :  {link #0 : 0}, {link #1 : 1}, {link #2 : 2}, {link #3 : 3}, {link #4 : 4},
0 : local 98, cpu 10 {link #0 : g1 11}, {link #1 : g2 11}, {link #2 : g3 11}, {link #3 : g4 11}, {link #4 : g5 11},
1 : local 98, cpu 10 {link #0 : g2 11}, {link #1 : g3 11}, {link #2 : g4 11}, {link #3 : g5 11}, {link #4 : g0 11},
2 : local 98, cpu 10 {link #0 : g3 11}, {link #1 : g4 11}, {link #2 : g5 11}, {link #3 : g0 11}, {link #4 : g1 11},
3 : local 98, cpu 10 {link #0 : g4 11}, {link #1 : g5 11}, {link #2 : g0 11}, {link #3 : g1 11}, {link #4 : g2 11},
4 : local 98, cpu 10 {link #0 : g5 11}, {link #1 : g0 11}, {link #2 : g1 11}, {link #3 : g2 11}, {link #4 : g3 11},
5 : local 98, cpu 10 {link #0 : g0 11}, {link #1 : g1 11}, {link #2 : g2 11}, {link #3 : g3 11}, {link #4 : g4 11},
0 :  {link #0 : 1}, {link #1 : 2}, {link #2 : 3}, {link #3 : 4}, {link #4 : 5},
1 :  {link #0 : 2}, {link #1 : 3}, {link #2 : 4}, {link #3 : 5}, {link #4 : 0},
2 :  {link #0 : 3}, {link #1 : 4}, {link #2 : 5}, {link #3 : 0}, {link #4 : 1},
3 :  {link #0 : 4}, {link #1 : 5}, {link #2 : 0}, {link #3 : 1}, {link #4 : 2},
4 :  {link #0 : 5}, {link #1 : 0}, {link #2 : 1}, {link #3 : 2}, {link #4 : 3},
5 :  {link #0 : 0}, {link #1 : 1}, {link #2 : 2}, {link #3 : 3}, {link #4 : 4},
0 : local 98, cpu 10 {link #0 : g1 11}, {link #1 : g2 11}, {link #2 : g3 11}, {link #3 : g4 11}, {link #4 : g5 11},
1 : local 98, cpu 10 {link #0 : g2 11}, {link #1 : g3 11}, {link #2 : g4 11}, {link #3 : g5 11}, {link #4 : g0 11},
2 : local 98, cpu 10 {link #0 : g3 11}, {link #1 : g4 11}, {link #2 : g5 11}, {link #3 : g0 11}, {link #4 : g1 11},
3 : local 98, cpu 10 {link #0 : g4 11}, {link #1 : g5 11}, {link #2 : g0 11}, {link #3 : g1 11}, {link #4 : g2 11},
4 : local 98, cpu 10 {link #0 : g5 11}, {link #1 : g0 11}, {link #2 : g1 11}, {link #3 : g2 11}, {link #4 : g3 11},
5 : local 98, cpu 10 {link #0 : g0 11}, {link #1 : g1 11}, {link #2 : g2 11}, {link #3 : g3 11}, {link #4 : g4 11},
Set parameter WLSAccessID
Set parameter WLSSecret
Set parameter LicenseID
Set parameter TimeLimit to value 200
Set parameter MIPGap to value 0.05
Set parameter LogFile to value "cppsolver.log"
Set parameter Threads to value 40
Academic license - for non-commercial use only - registered to xiaoniu.sxn@sjtu.edu.cn
Gurobi Optimizer version 9.5.1 build v9.5.1rc2 (linux64)
Thread count: 56 physical cores, 112 logical processors, using up to 40 threads
Academic license - for non-commercial use only - registered to xiaoniu.sxn@sjtu.edu.cn
Optimize a model with 146622 rows, 29163 columns and 387744 nonzeros
Model fingerprint: 0xa891b4c1
Variable types: 7 continuous, 29156 integer (29156 binary)
Coefficient statistics:
  Matrix range     [2e-09, 6e+03]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 1e+04]
Warning: Model contains large matrix coefficient range
         Consider reformulating model or setting NumericFocus parameter
         to avoid numerical issues.
Found heuristic solution: objective 57703.636036
Presolve removed 118210 rows and 5 columns
Presolve time: 0.31s
Presolved: 28412 rows, 29158 columns, 137885 nonzeros
Variable types: 1 continuous, 29157 integer (29156 binary)

Deterministic concurrent LP optimizer: primal and dual simplex
Showing first log only...


Use crossover to convert LP symmetric solution to basic solution...
Concurrent spin time: 0.01s

Solved with primal simplex

Root relaxation: objective 1.920905e+03, 6363 iterations, 0.15 seconds (0.24 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 1920.90535    0  119 57703.6360 1920.90535  96.7%     -    7s
H    0     0                    2157.4449384 1920.90535  11.0%     -    7s
H    0     0                    1990.7619909 1920.90535  3.51%     -    7s

Explored 1 nodes (30424 simplex iterations) in 7.30 seconds (12.24 work units)
Thread count was 40 (of 112 available processors)

Solution count 3: 1990.76 2157.44 57703.6 

Optimal solution found (tolerance 5.00e-02)
Best objective 1.990761990948e+03, best bound 1.920905352074e+03, gap 3.5090%
coll_cache:optimal_local_rate=0.488405,0.490928,0.488935,0.486534,0.493636,0.487574,
coll_cache:optimal_remote_rate=0.503691,0.501168,0.503162,0.505562,0.49846,0.504522,
coll_cache:optimal_cpu_rate=0.00790387,0.00790387,0.00790387,0.00790387,0.00790387,0.00790387,
z=1990.76
test_result:init:feat_nbytes=375030526464
test_result:init:cache_nbytes=37878082560
test_result:init:feat_nbytes=375030526464
test_result:init:cache_nbytes=37878082560
test_result:init:feat_nbytes=375030526464
test_result:init:cache_nbytes=37878082560
test_result:init:feat_nbytes=375030526464
test_result:init:cache_nbytes=37878082560
test_result:init:feat_nbytes=375030526464
test_result:init:cache_nbytes=37878082560
test_result:init:feat_nbytes=375030526464
test_result:init:cache_nbytes=37878082560
[Train  Worker 1/6] Started with PID 16573(NVIDIA A100-SXM4-80GB)
[Train  Worker 1] run train for 4 epochs with 1002 steps
[Train  Worker 5/6] Started with PID 16585(NVIDIA A100-SXM4-80GB)
[Train  Worker 5] run train for 4 epochs with 1002 steps
[Train  Worker 2/6] Started with PID 16576(NVIDIA A100-SXM4-80GB)
[Train  Worker 2] run train for 4 epochs with 1002 steps
[Train  Worker 3/6] Started with PID 16579(NVIDIA A100-SXM4-80GB)
[Train  Worker 3] run train for 4 epochs with 1002 steps
[Train  Worker 4/6] Started with PID 16582(NVIDIA A100-SXM4-80GB)
[Train  Worker 4] run train for 4 epochs with 1002 steps
[CUDA] cuda0: usage: 45.72 GB
[SAM] cuda0 data alloc        : 0.00 Bytes
[SAM] cuda0 workspace         : 3.07 GB
[SAM] cuda0 workspace reserve : 1.52 GB
[SAM] cuda0 total             : 3.07 GB
[Train  Worker 0/6] Started with PID 16569(NVIDIA A100-SXM4-80GB)
[Train  Worker 0] run train for 4 epochs with 1002 steps
Epoch 00000 | Epoch Time 4.6923 | Total Train Time(Profiler) 4.4117 | Copy Time 2.9330
[CUDA] cuda0: usage: 45.72 GB
[SAM] cuda0 data alloc        : 0.00 Bytes
[SAM] cuda0 workspace         : 3.07 GB
[SAM] cuda0 workspace reserve : 1.52 GB
[SAM] cuda0 total             : 3.07 GB
Epoch 00001 | Epoch Time 2.7769 | Total Train Time(Profiler) 2.7078 | Copy Time 2.6783
[CUDA] cuda0: usage: 45.72 GB
[SAM] cuda0 data alloc        : 0.00 Bytes
[SAM] cuda0 workspace         : 3.07 GB
[SAM] cuda0 workspace reserve : 1.53 GB
[SAM] cuda0 total             : 3.07 GB
Epoch 00002 | Epoch Time 2.7927 | Total Train Time(Profiler) 2.7035 | Copy Time 2.6946
[CUDA] cuda0: usage: 45.72 GB
[SAM] cuda0 data alloc        : 0.00 Bytes
[SAM] cuda0 workspace         : 3.07 GB
[SAM] cuda0 workspace reserve : 1.52 GB
[SAM] cuda0 total             : 3.07 GB
Epoch 00003 | Epoch Time 2.7781 | Total Train Time(Profiler) 2.7093 | Copy Time 2.6806
[Train  Worker 3] Avg Epoch Time 2.7825 | Train Total Time(Profiler) 2.7082 | Copy Time 2.6878
[Train  Worker 2] Avg Epoch Time 2.7825 | Train Total Time(Profiler) 2.7050 | Copy Time 2.6873
[Train  Worker 4] Avg Epoch Time 2.7825 | Train Total Time(Profiler) 2.7137 | Copy Time 2.6872
[Train  Worker 1] Avg Epoch Time 2.7825 | Train Total Time(Profiler) 2.7094 | Copy Time 2.6832
[Train  Worker 5] Avg Epoch Time 2.7825 | Train Total Time(Profiler) 2.7106 | Copy Time 2.6852
[Train  Worker 0] Avg Epoch Time 2.7825 | Train Total Time(Profiler) 2.7069 | Copy Time 2.6845
[Sample Worker 1/2] Started with PID 16566(NVIDIA A100-SXM4-80GB)
[Sample Worker 1] run sample for 4 epochs with 501 steps
[Sample Worker 1] Avg Sample Total Time 1.2211 | Sampler Total Time(Profiler) 1.2171
    [Step(average) Profiler Level 1 E3 S500]
        L1  sample           0.001606 | send           0.000836
        L1  recv             0.001207 | copy           0.016090 | convert time 0.000323 | train  0.015891
        L1  feature nbytes    1.36 GB | label nbytes   15.62 KB
        L1  id nbytes      0.00 Bytes | graph nbytes    8.41 MB
        L1  miss nbytes      33.12 MB | remote nbytes  691.08 MB
        L1  num nodes          953786 | num samples     1098763
    [Step(average) Profiler Level 2 E3 S500]
        L2  shuffle     0.000065 | core sample  0.000576 | id remap        0.000739
        L2  graph copy  0.000003 | id copy      0.000000 | cache feat copy 0.014880
        L2  last layer sample time 0.000289 | size 49774.859026
    [Step(average) Profiler Level 3 E3 S500]
        L3  khop sample coo  0.000316 | khop sort coo      0.000000 | khop count edge     0.000036 | khop compact edge 0.000170
        L3  walk sample coo  0.000000 | walk topk total    0.000000 | walk topk step1     0.000000 | walk topk step2   0.000000
        L3  walk topk step3  0.000000 | walk topk step4    0.000000 | walk topk step5     0.000000
        L3  walk topk step6  0.000000 | walk topk step7    0.000000
        L3  remap unique     0.000219 | remap populate     0.000603 | remap mapnode       0.000000 | remap mapedge     0.000153
        L3  cache get_index  0.002193 | cache copy_index   0.000000 | cache extract_miss  0.000000
        L3  cache copy_miss  0.000000 | cache combine_miss 0.003613 | cache combine cache 0.001115 | cache combine remote 0.005715
        L3  label extract  0.004664
    [Init Profiler Level 1]
        L1  init     9.9923 | sampler init    52.8536 | trainer init 0.0000
    [Init Profiler Level 2]
        L2  load ds        11.9400 | init queue          42.1075
        L2  presample       7.1612 | build interal ds     1.6360
        L2  build cache     0.0000
    [Init Profiler Level 3]
        L3  load dataset: mmap     9.9910 | copy         1.9490
        L3  dist queue: alloc      0.0004 | pin         42.1071 | push     0.0000
        L3  presample: init        0.2755
        L3  presample: sample      3.1436 | copy         0.3173
        L3  presample: count       2.7051 | sort         0.3643
        L3  presample: reset       0.0012 | get rank     0.0236
        L3  internal: cuda ctx     1.4604 | cuda stream     0.1722
[Sample Worker 0/2] Started with PID 16564(NVIDIA A100-SXM4-80GB)
[Sample Worker 0] run sample for 4 epochs with 501 steps
[Sample Worker 0] Avg Sample Total Time 1.2318 | Sampler Total Time(Profiler) 1.2253
test_result:sample_time=0.8055
test_result:get_cache_miss_index_time=0.0000
test_result:enqueue_samples_time=0.4197
test_result:epoch_time:sample_total=1.2318
test_result:pipeline_sample_epoch_time=2.7828
[CUDA] cuda0: usage: 45.72 GB
[SAM] cuda0 data alloc        : 0.00 Bytes
[SAM] cuda0 workspace         : 3.07 GB
[SAM] cuda0 workspace reserve : 1.52 GB
[SAM] cuda0 total             : 3.07 GB
    [Step(average) Profiler Level 1 E3 S1001]
        L1  sample           0.001602 | send           0.000835
        L1  recv             0.001206 | copy           0.016083 | convert time 0.000323 | train  0.015901
        L1  feature nbytes    1.36 GB | label nbytes   15.62 KB
        L1  id nbytes      0.00 Bytes | graph nbytes    8.41 MB
        L1  miss nbytes      33.14 MB | remote nbytes  691.03 MB
        L1  num nodes          953746 | num samples     1098710
        L1  seq duration     0.000000 | refresh duration   0.000000
    [Step(average) Profiler Level 2 E3 S1001]
        L2  shuffle     0.000065 | core sample  0.000575 | id remap        0.000737
        L2  graph copy  0.000003 | id copy      0.000000 | cache feat copy 0.014873
        L2  last layer sample time 0.000288 | size 49773.181364
    [Step(average) Profiler Level 3 E3 S1001]
        L3  khop sample coo  0.000316 | khop sort coo      0.000000 | khop count edge     0.000036 | khop compact edge 0.000170
        L3  walk sample coo  0.000000 | walk topk total    0.000000 | walk topk step1     0.000000 | walk topk step2   0.000000
        L3  walk topk step3  0.000000 | walk topk step4    0.000000 | walk topk step5     0.000000
        L3  walk topk step6  0.000000 | walk topk step7    0.000000
        L3  remap unique     0.000218 | remap populate     0.000602 | remap mapnode       0.000000 | remap mapedge     0.000152
        L3  cache get_index  0.002188 | cache copy_index   0.000000 | cache extract_miss  0.000000
        L3  cache copy_miss  0.000000 | cache combine_miss 0.003612 | cache combine cache 0.001123 | cache combine remote 0.005711
        L3  label extract  0.004635
    [Step(max) Profiler Level 1 E3 S1001]
        L1  sample           0.029134 | send           0.006359
        L1  recv             0.035033 | copy           0.043880 | convert time 0.001624 | train  0.021868
        L1  feature nbytes    1.40 GB | label nbytes   15.62 KB
        L1  id nbytes      0.00 Bytes | graph nbytes    8.64 MB
        L1  miss nbytes      34.81 MB | remote nbytes  711.44 MB
        L1  num nodes          979219 | num samples     1127811
    [Step(max) Profiler Level 2 E3 S1001]
        L2  shuffle     0.027445 | core sample  0.003736 | id remap        0.002937
        L2  graph copy  0.000017 | id copy      0.000000 | cache feat copy 0.023169
        L2  last layer sample time 0.001019 | size 50728.000000
    [Step(max) Profiler Level 3 E3 S1001]
        L3  khop sample coo  0.000728 | khop sort coo      0.000000 | khop count edge     0.000053 | khop compact edge 0.002413
        L3  walk sample coo  0.000000 | walk topk total    0.000000 | walk topk step1     0.000000 | walk topk step2   0.000000
        L3  walk topk step3  0.000000 | walk topk step4    0.000000 | walk topk step5     0.000000
        L3  walk topk step6  0.000000 | walk topk step7    0.000000
        L3  remap unique     0.003822 | remap populate     0.002793 | remap mapnode       0.000000 | remap mapedge     0.003322
        L3  cache get_index  0.014372 | cache copy_index   0.000000 | cache extract_miss  0.000000
        L3  cache copy_miss  0.000000 | cache combine_miss 0.010447 | cache combine cache 0.007707 | cache combine remote 0.008615
        L3  label extract  0.008142
    [Step(min) Profiler Level 1 E3 S1001]
        L1  sample           0.001465 | send           0.000502
        L1  recv             0.000558 | copy           0.014749 | convert time 0.000289 | train  0.010000
        L1  feature nbytes    1.33 GB | label nbytes   15.62 KB
        L1  id nbytes      0.00 Bytes | graph nbytes    8.22 MB
        L1  miss nbytes      31.58 MB | remote nbytes  668.12 MB
        L1  num nodes          930949 | num samples     1072912
    [Step(min) Profiler Level 2 E3 S1001]
        L2  shuffle     0.000012 | core sample  0.000546 | id remap        0.000691
        L2  graph copy  0.000002 | id copy      0.000000 | cache feat copy 0.008776
        L2  last layer sample time 0.000267 | size 48910.000000
    [Step(min) Profiler Level 3 E3 S1001]
        L3  khop sample coo  0.000303 | khop sort coo      0.000000 | khop count edge     0.000033 | khop compact edge 0.000157
        L3  walk sample coo  0.000000 | walk topk total    0.000000 | walk topk step1     0.000000 | walk topk step2   0.000000
        L3  walk topk step3  0.000000 | walk topk step4    0.000000 | walk topk step5     0.000000
        L3  walk topk step6  0.000000 | walk topk step7    0.000000
        L3  remap unique     0.000199 | remap populate     0.000564 | remap mapnode       0.000000 | remap mapedge     0.000140
        L3  cache get_index  0.000344 | cache copy_index   0.000000 | cache extract_miss  0.000000
        L3  cache copy_miss  0.000000 | cache combine_miss 0.002851 | cache combine cache 0.000116 | cache combine remote 0.004560
        L3  label extract  0.000014
    [Init Profiler Level 1]
        L1  init     9.9923 | sampler init     0.0000 | trainer init 80.9976
    [Init Profiler Level 2]
        L2  load ds         9.9910 | init queue          42.0507
        L2  presample       0.0000 | build interal ds     1.5126
        L2  build cache    37.4311
    [Init Profiler Level 3]
        L3  load dataset: mmap     9.9910 | copy         0.0000
        L3  dist queue: alloc      0.0004 | pin         42.0503 | push     0.0000
        L3  presample: init        0.0000
        L3  presample: sample      0.0000 | copy         0.0000
        L3  presample: count       0.0000 | sort         0.0000
        L3  presample: reset       0.0000 | get rank     0.0000
        L3  internal: cuda ctx     1.5126 | cuda stream     0.0001
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   35642 KB |  648200 KB |    1187 GB |    1187 GB |
|       from large pool |   26369 KB |  645267 KB |    1178 GB |    1178 GB |
|       from small pool |    9273 KB |   11608 KB |       8 GB |       8 GB |
|---------------------------------------------------------------------------|
| Active memory         |   35642 KB |  648200 KB |    1187 GB |    1187 GB |
|       from large pool |   26369 KB |  645267 KB |    1178 GB |    1178 GB |
|       from small pool |    9273 KB |   11608 KB |       8 GB |       8 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |     770 MB |     770 MB |     770 MB |       0 B  |
|       from large pool |     754 MB |     754 MB |     754 MB |       0 B  |
|       from small pool |      16 MB |      16 MB |      16 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   46277 KB |  636130 KB |     949 GB |     949 GB |
|       from large pool |   43263 KB |  634384 KB |     938 GB |     938 GB |
|       from small pool |    3014 KB |    5574 KB |      10 GB |      10 GB |
|---------------------------------------------------------------------------|
| Allocations           |      43    |      62    |   97568    |   97525    |
|       from large pool |       7    |      18    |   38079    |   38072    |
|       from small pool |      36    |      47    |   59489    |   59453    |
|---------------------------------------------------------------------------|
| Active allocs         |      44    |      62    |   97568    |   97524    |
|       from large pool |       7    |      18    |   38079    |   38072    |
|       from small pool |      37    |      47    |   59489    |   59452    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      17    |      17    |      17    |       0    |
|       from large pool |       9    |       9    |       9    |       0    |
|       from small pool |       8    |       8    |       8    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      20    |      29    |   43473    |   43453    |
|       from large pool |       4    |      12    |   26097    |   26093    |
|       from small pool |      16    |      23    |   17376    |   17360    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

test_result:epoch_time:copy_time=2.6845
test_result:convert_time=0.0526
test_result:train_time=2.6542
test_result:epoch_time:train_total=2.7069
test_result:cache_percentage=0.1000
test_result:cache_hit_rate=1.0000
test_result:run_time=13.0428
test_result:pipeline_train_epoch_time=2.7825

