succeed=True
config:eval_tsp="2023-04-15 12:46:19"
config:arch=arch5
config:num_train_worker=6
config:num_sample_worker=2
config:sample_type=khop2
config:root_path=/nvme/graph-learning-copy/samgraph/
config:dataset=mag240m-homo
config:pipeline=True
config:cache_policy=coll_cache_asymm_link
config:cache_percentage=0.18
config:num_epoch=4
config:batch_size=2000
config:num_hidden=256
config:max_sampling_jobs=1
config:max_copying_jobs=1
config:barriered_epoch=1
config:presample_epoch=2
config:omp_thread_num=40
config:unsupervised=True
config:amp=True
config:rolling=0
config:fanout=[25, 10]
config:lr=0.003
config:dropout=0.5
config:single_gpu=False
config:max_num_step=1000
config:validate_configs=False
config:report_acc=0
config:dataset_path=/nvme/graph-learning-copy/samgraph/mag240m-homo
config:torch_thread_num=9
config:train_workers=['cuda:0', 'cuda:1', 'cuda:2', 'cuda:3', 'cuda:4', 'cuda:5']
config:sample_workers=['cuda:6', 'cuda:7']
config:num_fanout=2
config:num_layer=2
config:_run_mode=RunMode.FGNN
config:_log_level=warn
config:_profile_level=3
config:_empty_feat=25
config:_arch=5
config:_sample_type=5
config:_cache_policy=13
test_result:init:input_scale_factor=1.1
0 :  {link #0 : 1}, {link #1 : 2}, {link #2 : 3}, {link #3 : 4}, {link #4 : 5},
1 :  {link #0 : 2}, {link #1 : 3}, {link #2 : 4}, {link #3 : 5}, {link #4 : 0},
2 :  {link #0 : 3}, {link #1 : 4}, {link #2 : 5}, {link #3 : 0}, {link #4 : 1},
3 :  {link #0 : 4}, {link #1 : 5}, {link #2 : 0}, {link #3 : 1}, {link #4 : 2},
4 :  {link #0 : 5}, {link #1 : 0}, {link #2 : 1}, {link #3 : 2}, {link #4 : 3},
5 :  {link #0 : 0}, {link #1 : 1}, {link #2 : 2}, {link #3 : 3}, {link #4 : 4},
0 : local 98, cpu 10 {link #0 : g1 11}, {link #1 : g2 11}, {link #2 : g3 11}, {link #3 : g4 11}, {link #4 : g5 11},
1 : local 98, cpu 10 {link #0 : g2 11}, {link #1 : g3 11}, {link #2 : g4 11}, {link #3 : g5 11}, {link #4 : g0 11},
2 : local 98, cpu 10 {link #0 : g3 11}, {link #1 : g4 11}, {link #2 : g5 11}, {link #3 : g0 11}, {link #4 : g1 11},
3 : local 98, cpu 10 {link #0 : g4 11}, {link #1 : g5 11}, {link #2 : g0 11}, {link #3 : g1 11}, {link #4 : g2 11},
4 : local 98, cpu 10 {link #0 : g5 11}, {link #1 : g0 11}, {link #2 : g1 11}, {link #3 : g2 11}, {link #4 : g3 11},
5 : local 98, cpu 10 {link #0 : g0 11}, {link #1 : g1 11}, {link #2 : g2 11}, {link #3 : g3 11}, {link #4 : g4 11},
0 :  {link #0 : 1}, {link #1 : 2}, {link #2 : 3}, {link #3 : 4}, {link #4 : 5},
1 :  {link #0 : 2}, {link #1 : 3}, {link #2 : 4}, {link #3 : 5}, {link #4 : 0},
2 :  {link #0 : 3}, {link #1 : 4}, {link #2 : 5}, {link #3 : 0}, {link #4 : 1},
3 :  {link #0 : 4}, {link #1 : 5}, {link #2 : 0}, {link #3 : 1}, {link #4 : 2},
4 :  {link #0 : 5}, {link #1 : 0}, {link #2 : 1}, {link #3 : 2}, {link #4 : 3},
5 :  {link #0 : 0}, {link #1 : 1}, {link #2 : 2}, {link #3 : 3}, {link #4 : 4},
0 : local 98, cpu 10 {link #0 : g1 11}, {link #1 : g2 11}, {link #2 : g3 11}, {link #3 : g4 11}, {link #4 : g5 11},
1 : local 98, cpu 10 {link #0 : g2 11}, {link #1 : g3 11}, {link #2 : g4 11}, {link #3 : g5 11}, {link #4 : g0 11},
2 : local 98, cpu 10 {link #0 : g3 11}, {link #1 : g4 11}, {link #2 : g5 11}, {link #3 : g0 11}, {link #4 : g1 11},
3 : local 98, cpu 10 {link #0 : g4 11}, {link #1 : g5 11}, {link #2 : g0 11}, {link #3 : g1 11}, {link #4 : g2 11},
4 : local 98, cpu 10 {link #0 : g5 11}, {link #1 : g0 11}, {link #2 : g1 11}, {link #3 : g2 11}, {link #4 : g3 11},
5 : local 98, cpu 10 {link #0 : g0 11}, {link #1 : g1 11}, {link #2 : g2 11}, {link #3 : g3 11}, {link #4 : g4 11},
0 :  {link #0 : 1}, {link #1 : 2}, {link #2 : 3}, {link #3 : 4}, {link #4 : 5},
1 :  {link #0 : 2}, {link #1 : 3}, {link #2 : 4}, {link #3 : 5}, {link #4 : 0},
2 :  {link #0 : 3}, {link #1 : 4}, {link #2 : 5}, {link #3 : 0}, {link #4 : 1},
3 :  {link #0 : 4}, {link #1 : 5}, {link #2 : 0}, {link #3 : 1}, {link #4 : 2},
4 :  {link #0 : 5}, {link #1 : 0}, {link #2 : 1}, {link #3 : 2}, {link #4 : 3},
5 :  {link #0 : 0}, {link #1 : 1}, {link #2 : 2}, {link #3 : 3}, {link #4 : 4},
0 : local 98, cpu 10 {link #0 : g1 11}, {link #1 : g2 11}, {link #2 : g3 11}, {link #3 : g4 11}, {link #4 : g5 11},
1 : local 98, cpu 10 {link #0 : g2 11}, {link #1 : g3 11}, {link #2 : g4 11}, {link #3 : g5 11}, {link #4 : g0 11},
2 : local 98, cpu 10 {link #0 : g3 11}, {link #1 : g4 11}, {link #2 : g5 11}, {link #3 : g0 11}, {link #4 : g1 11},
3 : local 98, cpu 10 {link #0 : g4 11}, {link #1 : g5 11}, {link #2 : g0 11}, {link #3 : g1 11}, {link #4 : g2 11},
4 : local 98, cpu 10 {link #0 : g5 11}, {link #1 : g0 11}, {link #2 : g1 11}, {link #3 : g2 11}, {link #4 : g3 11},
5 : local 98, cpu 10 {link #0 : g0 11}, {link #1 : g1 11}, {link #2 : g2 11}, {link #3 : g3 11}, {link #4 : g4 11},
0 :  {link #0 : 1}, {link #1 : 2}, {link #2 : 3}, {link #3 : 4}, {link #4 : 5},
1 :  {link #0 : 2}, {link #1 : 3}, {link #2 : 4}, {link #3 : 5}, {link #4 : 0},
2 :  {link #0 : 3}, {link #1 : 4}, {link #2 : 5}, {link #3 : 0}, {link #4 : 1},
3 :  {link #0 : 4}, {link #1 : 5}, {link #2 : 0}, {link #3 : 1}, {link #4 : 2},
4 :  {link #0 : 5}, {link #1 : 0}, {link #2 : 1}, {link #3 : 2}, {link #4 : 3},
5 :  {link #0 : 0}, {link #1 : 1}, {link #2 : 2}, {link #3 : 3}, {link #4 : 4},
0 : local 98, cpu 10 {link #0 : g1 11}, {link #1 : g2 11}, {link #2 : g3 11}, {link #3 : g4 11}, {link #4 : g5 11},
1 : local 98, cpu 10 {link #0 : g2 11}, {link #1 : g3 11}, {link #2 : g4 11}, {link #3 : g5 11}, {link #4 : g0 11},
2 : local 98, cpu 10 {link #0 : g3 11}, {link #1 : g4 11}, {link #2 : g5 11}, {link #3 : g0 11}, {link #4 : g1 11},
3 : local 98, cpu 10 {link #0 : g4 11}, {link #1 : g5 11}, {link #2 : g0 11}, {link #3 : g1 11}, {link #4 : g2 11},
4 : local 98, cpu 10 {link #0 : g5 11}, {link #1 : g0 11}, {link #2 : g1 11}, {link #3 : g2 11}, {link #4 : g3 11},
5 : local 98, cpu 10 {link #0 : g0 11}, {link #1 : g1 11}, {link #2 : g2 11}, {link #3 : g3 11}, {link #4 : g4 11},
0 :  {link #0 : 1}, {link #1 : 2}, {link #2 : 3}, {link #3 : 4}, {link #4 : 5},
1 :  {link #0 : 2}, {link #1 : 3}, {link #2 : 4}, {link #3 : 5}, {link #4 : 0},
2 :  {link #0 : 3}, {link #1 : 4}, {link #2 : 5}, {link #3 : 0}, {link #4 : 1},
3 :  {link #0 : 4}, {link #1 : 5}, {link #2 : 0}, {link #3 : 1}, {link #4 : 2},
4 :  {link #0 : 5}, {link #1 : 0}, {link #2 : 1}, {link #3 : 2}, {link #4 : 3},
5 :  {link #0 : 0}, {link #1 : 1}, {link #2 : 2}, {link #3 : 3}, {link #4 : 4},
0 : local 98, cpu 10 {link #0 : g1 11}, {link #1 : g2 11}, {link #2 : g3 11}, {link #3 : g4 11}, {link #4 : g5 11},
1 : local 98, cpu 10 {link #0 : g2 11}, {link #1 : g3 11}, {link #2 : g4 11}, {link #3 : g5 11}, {link #4 : g0 11},
2 : local 98, cpu 10 {link #0 : g3 11}, {link #1 : g4 11}, {link #2 : g5 11}, {link #3 : g0 11}, {link #4 : g1 11},
3 : local 98, cpu 10 {link #0 : g4 11}, {link #1 : g5 11}, {link #2 : g0 11}, {link #3 : g1 11}, {link #4 : g2 11},
4 : local 98, cpu 10 {link #0 : g5 11}, {link #1 : g0 11}, {link #2 : g1 11}, {link #3 : g2 11}, {link #4 : g3 11},
5 : local 98, cpu 10 {link #0 : g0 11}, {link #1 : g1 11}, {link #2 : g2 11}, {link #3 : g3 11}, {link #4 : g4 11},
0 :  {link #0 : 1}, {link #1 : 2}, {link #2 : 3}, {link #3 : 4}, {link #4 : 5},
1 :  {link #0 : 2}, {link #1 : 3}, {link #2 : 4}, {link #3 : 5}, {link #4 : 0},
2 :  {link #0 : 3}, {link #1 : 4}, {link #2 : 5}, {link #3 : 0}, {link #4 : 1},
3 :  {link #0 : 4}, {link #1 : 5}, {link #2 : 0}, {link #3 : 1}, {link #4 : 2},
4 :  {link #0 : 5}, {link #1 : 0}, {link #2 : 1}, {link #3 : 2}, {link #4 : 3},
5 :  {link #0 : 0}, {link #1 : 1}, {link #2 : 2}, {link #3 : 3}, {link #4 : 4},
0 : local 98, cpu 10 {link #0 : g1 11}, {link #1 : g2 11}, {link #2 : g3 11}, {link #3 : g4 11}, {link #4 : g5 11},
1 : local 98, cpu 10 {link #0 : g2 11}, {link #1 : g3 11}, {link #2 : g4 11}, {link #3 : g5 11}, {link #4 : g0 11},
2 : local 98, cpu 10 {link #0 : g3 11}, {link #1 : g4 11}, {link #2 : g5 11}, {link #3 : g0 11}, {link #4 : g1 11},
3 : local 98, cpu 10 {link #0 : g4 11}, {link #1 : g5 11}, {link #2 : g0 11}, {link #3 : g1 11}, {link #4 : g2 11},
4 : local 98, cpu 10 {link #0 : g5 11}, {link #1 : g0 11}, {link #2 : g1 11}, {link #3 : g2 11}, {link #4 : g3 11},
5 : local 98, cpu 10 {link #0 : g0 11}, {link #1 : g1 11}, {link #2 : g2 11}, {link #3 : g3 11}, {link #4 : g4 11},
Set parameter WLSAccessID
Set parameter WLSSecret
Set parameter LicenseID
Set parameter TimeLimit to value 200
Set parameter MIPGap to value 0.05
Set parameter LogFile to value "cppsolver.log"
Set parameter Threads to value 40
Academic license - for non-commercial use only - registered to xiaoniu.sxn@sjtu.edu.cn
Gurobi Optimizer version 9.5.1 build v9.5.1rc2 (linux64)
Thread count: 56 physical cores, 112 logical processors, using up to 40 threads
Academic license - for non-commercial use only - registered to xiaoniu.sxn@sjtu.edu.cn
Optimize a model with 225486 rows, 44851 columns and 596352 nonzeros
Model fingerprint: 0xe981a9c8
Variable types: 7 continuous, 44844 integer (44844 binary)
Coefficient statistics:
  Matrix range     [2e-09, 6e+03]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 1e+04]
Warning: Model contains large matrix coefficient range
         Consider reformulating model or setting NumericFocus parameter
         to avoid numerical issues.
Found heuristic solution: objective 57693.230174
Presolve removed 181810 rows and 5 columns
Presolve time: 0.46s
Presolved: 43676 rows, 44846 columns, 212085 nonzeros
Variable types: 1 continuous, 44845 integer (44844 binary)

Deterministic concurrent LP optimizer: primal and dual simplex
Showing first log only...


Use crossover to convert LP symmetric solution to basic solution...
Concurrent spin time: 0.10s

Solved with dual simplex

Root relaxation: objective 1.425860e+03, 14853 iterations, 0.44 seconds (0.61 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

H    0     0                    1425.8601372 1425.86004  0.00%     -    0s
     0     0 1425.86014    0   69 1425.86014 1425.86014  0.00%     -    0s

Explored 1 nodes (14853 simplex iterations) in 0.98 seconds (1.64 work units)
Thread count was 40 (of 112 available processors)

Solution count 2: 1425.86 57693.2 

Optimal solution found (tolerance 5.00e-02)
Best objective 1.425860137245e+03, best bound 1.425860137245e+03, gap 0.0000%
coll_cache:optimal_local_rate=0.73522,0.737412,0.733092,0.736129,0.736694,0.728134,
coll_cache:optimal_remote_rate=0.26478,0.262588,0.266908,0.263871,0.263306,0.271866,
coll_cache:optimal_cpu_rate=1.41801e-09,1.41801e-09,1.41801e-09,1.41801e-09,1.41801e-09,1.41801e-09,
z=1425.86
test_result:init:feat_nbytes=375030526464
test_result:init:cache_nbytes=67880524800
test_result:init:feat_nbytes=375030526464
test_result:init:cache_nbytes=67880524800
test_result:init:feat_nbytes=375030526464
test_result:init:cache_nbytes=67880524800
test_result:init:feat_nbytes=375030526464
test_result:init:cache_nbytes=67880524800
test_result:init:feat_nbytes=375030526464
test_result:init:cache_nbytes=67880524800
test_result:init:feat_nbytes=375030526464
test_result:init:cache_nbytes=67880524800
[Train  Worker 2/6] Started with PID 17417(NVIDIA A100-SXM4-80GB)
[Train  Worker 2] run train for 4 epochs with 1002 steps
[Train  Worker 4/6] Started with PID 17423(NVIDIA A100-SXM4-80GB)
[Train  Worker 4] run train for 4 epochs with 1002 steps
[Train  Worker 3/6] Started with PID 17419(NVIDIA A100-SXM4-80GB)
[Train  Worker 3] run train for 4 epochs with 1002 steps
[Train  Worker 1/6] Started with PID 17414(NVIDIA A100-SXM4-80GB)
[Train  Worker 1] run train for 4 epochs with 1002 steps
[Train  Worker 5/6] Started with PID 17426(NVIDIA A100-SXM4-80GB)
[Train  Worker 5] run train for 4 epochs with 1002 steps
[CUDA] cuda0: usage: 73.67 GB
[SAM] cuda0 data alloc        : 0.00 Bytes
[SAM] cuda0 workspace         : 3.07 GB
[SAM] cuda0 workspace reserve : 1.53 GB
[SAM] cuda0 total             : 3.07 GB
[Train  Worker 0/6] Started with PID 17411(NVIDIA A100-SXM4-80GB)
[Train  Worker 0] run train for 4 epochs with 1002 steps
Epoch 00000 | Epoch Time 5.1600 | Total Train Time(Profiler) 5.0507 | Copy Time 3.1226
[CUDA] cuda0: usage: 73.67 GB
[SAM] cuda0 data alloc        : 0.00 Bytes
[SAM] cuda0 workspace         : 3.07 GB
[SAM] cuda0 workspace reserve : 1.53 GB
[SAM] cuda0 total             : 3.07 GB
Epoch 00001 | Epoch Time 3.1685 | Total Train Time(Profiler) 3.0868 | Copy Time 3.0629
[CUDA] cuda0: usage: 73.67 GB
[SAM] cuda0 data alloc        : 0.00 Bytes
[SAM] cuda0 workspace         : 3.07 GB
[SAM] cuda0 workspace reserve : 1.53 GB
[SAM] cuda0 total             : 3.07 GB
Epoch 00002 | Epoch Time 3.1172 | Total Train Time(Profiler) 3.0340 | Copy Time 3.0146
[CUDA] cuda0: usage: 73.67 GB
[SAM] cuda0 data alloc        : 0.00 Bytes
[SAM] cuda0 workspace         : 3.07 GB
[SAM] cuda0 workspace reserve : 1.53 GB
[SAM] cuda0 total             : 3.07 GB
Epoch 00003 | Epoch Time 3.1461 | Total Train Time(Profiler) 3.0361 | Copy Time 3.0497
[Train  Worker 3] Avg Epoch Time 3.1439 | Train Total Time(Profiler) 3.0666 | Copy Time 3.0443
[Train  Worker 2] Avg Epoch Time 3.1439 | Train Total Time(Profiler) 3.0511 | Copy Time 3.0427
[Train  Worker 4] Avg Epoch Time 3.1439 | Train Total Time(Profiler) 3.0606 | Copy Time 3.0414
[Train  Worker 1] Avg Epoch Time 3.1440 | Train Total Time(Profiler) 3.0552 | Copy Time 3.0439
[Train  Worker 5] Avg Epoch Time 3.1439 | Train Total Time(Profiler) 3.0561 | Copy Time 3.0426
[Train  Worker 0] Avg Epoch Time 3.1439 | Train Total Time(Profiler) 3.0523 | Copy Time 3.0424
[Sample Worker 1/2] Started with PID 17407(NVIDIA A100-SXM4-80GB)
[Sample Worker 1] run sample for 4 epochs with 501 steps
[Sample Worker 1] Avg Sample Total Time 1.1509 | Sampler Total Time(Profiler) 1.1454
    [Step(average) Profiler Level 1 E3 S500]
        L1  sample           0.001629 | send           0.000669
        L1  recv             0.001226 | copy           0.018212 | convert time 0.000325 | train  0.017995
        L1  feature nbytes    1.36 GB | label nbytes   15.62 KB
        L1  id nbytes      0.00 Bytes | graph nbytes    8.41 MB
        L1  miss nbytes      22.63 MB | remote nbytes  362.64 MB
        L1  num nodes          953705 | num samples     1098663
    [Step(average) Profiler Level 2 E3 S500]
        L2  shuffle     0.000073 | core sample  0.000583 | id remap        0.000749
        L2  graph copy  0.000003 | id copy      0.000000 | cache feat copy 0.016983
        L2  last layer sample time 0.000290 | size 49771.675319
    [Step(average) Profiler Level 3 E3 S500]
        L3  khop sample coo  0.000323 | khop sort coo      0.000000 | khop count edge     0.000037 | khop compact edge 0.000172
        L3  walk sample coo  0.000000 | walk topk total    0.000000 | walk topk step1     0.000000 | walk topk step2   0.000000
        L3  walk topk step3  0.000000 | walk topk step4    0.000000 | walk topk step5     0.000000
        L3  walk topk step6  0.000000 | walk topk step7    0.000000
        L3  remap unique     0.000217 | remap populate     0.000612 | remap mapnode       0.000000 | remap mapedge     0.000153
        L3  cache get_index  0.002207 | cache copy_index   0.000000 | cache extract_miss  0.000000
        L3  cache copy_miss  0.000000 | cache combine_miss 0.003892 | cache combine cache 0.002283 | cache combine remote 0.005860
        L3  label extract  0.005284
    [Init Profiler Level 1]
        L1  init     9.4170 | sampler init    56.2008 | trainer init 0.0000
    [Init Profiler Level 2]
        L2  load ds        11.9204 | init queue          44.4871
        L2  presample       7.5213 | build interal ds     1.6877
        L2  build cache     0.0000
    [Init Profiler Level 3]
        L3  load dataset: mmap     9.4157 | copy         2.5047
        L3  dist queue: alloc      0.0004 | pin         44.4868 | push     0.0000
        L3  presample: init        0.3009
        L3  presample: sample      3.2480 | copy         0.3201
        L3  presample: count       2.6998 | sort         0.5648
        L3  presample: reset       0.0015 | get rank     0.0361
        L3  internal: cuda ctx     1.4888 | cuda stream     0.1946
[Sample Worker 0/2] Started with PID 17405(NVIDIA A100-SXM4-80GB)
[Sample Worker 0] run sample for 4 epochs with 501 steps
[Sample Worker 0] Avg Sample Total Time 1.1743 | Sampler Total Time(Profiler) 1.1705
test_result:sample_time=0.8262
test_result:get_cache_miss_index_time=0.0000
test_result:enqueue_samples_time=0.3443
test_result:epoch_time:sample_total=1.1743
test_result:pipeline_sample_epoch_time=3.1443
[CUDA] cuda0: usage: 73.67 GB
[SAM] cuda0 data alloc        : 0.00 Bytes
[SAM] cuda0 workspace         : 3.07 GB
[SAM] cuda0 workspace reserve : 1.53 GB
[SAM] cuda0 total             : 3.07 GB
    [Step(average) Profiler Level 1 E3 S1001]
        L1  sample           0.001625 | send           0.000686
        L1  recv             0.001226 | copy           0.018221 | convert time 0.000324 | train  0.017981
        L1  feature nbytes    1.36 GB | label nbytes   15.62 KB
        L1  id nbytes      0.00 Bytes | graph nbytes    8.41 MB
        L1  miss nbytes      22.65 MB | remote nbytes  362.67 MB
        L1  num nodes          953717 | num samples     1098672
        L1  seq duration     0.000000 | refresh duration   0.000000
    [Step(average) Profiler Level 2 E3 S1001]
        L2  shuffle     0.000073 | core sample  0.000582 | id remap        0.000746
        L2  graph copy  0.000003 | id copy      0.000000 | cache feat copy 0.016992
        L2  last layer sample time 0.000290 | size 49772.891181
    [Step(average) Profiler Level 3 E3 S1001]
        L3  khop sample coo  0.000323 | khop sort coo      0.000000 | khop count edge     0.000036 | khop compact edge 0.000172
        L3  walk sample coo  0.000000 | walk topk total    0.000000 | walk topk step1     0.000000 | walk topk step2   0.000000
        L3  walk topk step3  0.000000 | walk topk step4    0.000000 | walk topk step5     0.000000
        L3  walk topk step6  0.000000 | walk topk step7    0.000000
        L3  remap unique     0.000217 | remap populate     0.000609 | remap mapnode       0.000000 | remap mapedge     0.000153
        L3  cache get_index  0.002216 | cache copy_index   0.000000 | cache extract_miss  0.000000
        L3  cache copy_miss  0.000000 | cache combine_miss 0.003890 | cache combine cache 0.002285 | cache combine remote 0.005864
        L3  label extract  0.005248
    [Step(max) Profiler Level 1 E3 S1001]
        L1  sample           0.033319 | send           0.004166
        L1  recv             0.039182 | copy           0.051259 | convert time 0.000856 | train  0.029737
        L1  feature nbytes    1.41 GB | label nbytes   15.62 KB
        L1  id nbytes      0.00 Bytes | graph nbytes    8.67 MB
        L1  miss nbytes      23.81 MB | remote nbytes  380.97 MB
        L1  num nodes          984714 | num samples     1131745
    [Step(max) Profiler Level 2 E3 S1001]
        L2  shuffle     0.031532 | core sample  0.002586 | id remap        0.004323
        L2  graph copy  0.000028 | id copy      0.000000 | cache feat copy 0.028969
        L2  last layer sample time 0.002509 | size 50805.000000
    [Step(max) Profiler Level 3 E3 S1001]
        L3  khop sample coo  0.002274 | khop sort coo      0.000000 | khop count edge     0.000281 | khop compact edge 0.002154
        L3  walk sample coo  0.000000 | walk topk total    0.000000 | walk topk step1     0.000000 | walk topk step2   0.000000
        L3  walk topk step3  0.000000 | walk topk step4    0.000000 | walk topk step5     0.000000
        L3  walk topk step6  0.000000 | walk topk step7    0.000000
        L3  remap unique     0.000840 | remap populate     0.004172 | remap mapnode       0.000000 | remap mapedge     0.001551
        L3  cache get_index  0.017086 | cache copy_index   0.000000 | cache extract_miss  0.000000
        L3  cache copy_miss  0.000000 | cache combine_miss 0.008235 | cache combine cache 0.013809 | cache combine remote 0.010896
        L3  label extract  0.009532
    [Step(min) Profiler Level 1 E3 S1001]
        L1  sample           0.001465 | send           0.000499
        L1  recv             0.000557 | copy           0.015814 | convert time 0.000286 | train  0.010065
        L1  feature nbytes    1.33 GB | label nbytes   15.62 KB
        L1  id nbytes      0.00 Bytes | graph nbytes    8.19 MB
        L1  miss nbytes      21.39 MB | remote nbytes  350.85 MB
        L1  num nodes          927817 | num samples     1069246
    [Step(min) Profiler Level 2 E3 S1001]
        L2  shuffle     0.000012 | core sample  0.000544 | id remap        0.000691
        L2  graph copy  0.000002 | id copy      0.000000 | cache feat copy 0.011729
        L2  last layer sample time 0.000266 | size 48942.000000
    [Step(min) Profiler Level 3 E3 S1001]
        L3  khop sample coo  0.000302 | khop sort coo      0.000000 | khop count edge     0.000033 | khop compact edge 0.000155
        L3  walk sample coo  0.000000 | walk topk total    0.000000 | walk topk step1     0.000000 | walk topk step2   0.000000
        L3  walk topk step3  0.000000 | walk topk step4    0.000000 | walk topk step5     0.000000
        L3  walk topk step6  0.000000 | walk topk step7    0.000000
        L3  remap unique     0.000197 | remap populate     0.000564 | remap mapnode       0.000000 | remap mapedge     0.000137
        L3  cache get_index  0.000357 | cache copy_index   0.000000 | cache extract_miss  0.000000
        L3  cache copy_miss  0.000000 | cache combine_miss 0.001574 | cache combine cache 0.000363 | cache combine remote 0.003719
        L3  label extract  0.000015
    [Init Profiler Level 1]
        L1  init     9.4170 | sampler init     0.0000 | trainer init 82.1877
    [Init Profiler Level 2]
        L2  load ds         9.4157 | init queue          44.3363
        L2  presample       0.0000 | build interal ds     1.3919
        L2  build cache    36.4547
    [Init Profiler Level 3]
        L3  load dataset: mmap     9.4157 | copy         0.0000
        L3  dist queue: alloc      0.0004 | pin         44.3359 | push     0.0000
        L3  presample: init        0.0000
        L3  presample: sample      0.0000 | copy         0.0000
        L3  presample: count       0.0000 | sort         0.0000
        L3  presample: reset       0.0000 | get rank     0.0000
        L3  internal: cuda ctx     1.3918 | cuda stream     0.0001
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   35410 KB |  648725 KB |    1187 GB |    1187 GB |
|       from large pool |   26128 KB |  645791 KB |    1178 GB |    1178 GB |
|       from small pool |    9282 KB |   11610 KB |       8 GB |       8 GB |
|---------------------------------------------------------------------------|
| Active memory         |   35410 KB |  648725 KB |    1187 GB |    1187 GB |
|       from large pool |   26128 KB |  645791 KB |    1178 GB |    1178 GB |
|       from small pool |    9282 KB |   11610 KB |       8 GB |       8 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |     772 MB |     772 MB |     772 MB |       0 B  |
|       from large pool |     756 MB |     756 MB |     756 MB |       0 B  |
|       from small pool |      16 MB |      16 MB |      16 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   46509 KB |  593645 KB |     970 GB |     970 GB |
|       from large pool |   43504 KB |  591245 KB |     960 GB |     959 GB |
|       from small pool |    3005 KB |    5574 KB |      10 GB |      10 GB |
|---------------------------------------------------------------------------|
| Allocations           |      43    |      62    |   97568    |   97525    |
|       from large pool |       7    |      18    |   38079    |   38072    |
|       from small pool |      36    |      47    |   59489    |   59453    |
|---------------------------------------------------------------------------|
| Active allocs         |      44    |      62    |   97568    |   97524    |
|       from large pool |       7    |      18    |   38079    |   38072    |
|       from small pool |      37    |      47    |   59489    |   59452    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      17    |      17    |      17    |       0    |
|       from large pool |       9    |       9    |       9    |       0    |
|       from small pool |       8    |       8    |       8    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      19    |      28    |   44152    |   44133    |
|       from large pool |       2    |      13    |   26058    |   26056    |
|       from small pool |      17    |      22    |   18094    |   18077    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

test_result:epoch_time:copy_time=3.0424
test_result:convert_time=0.0535
test_result:train_time=2.9988
test_result:epoch_time:train_total=3.0523
test_result:cache_percentage=0.1800
test_result:cache_hit_rate=1.0000
test_result:run_time=14.5953
test_result:pipeline_train_epoch_time=3.1439

