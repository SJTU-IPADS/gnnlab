succeed=True
config:eval_tsp="2023-04-15 12:39:35"
config:arch=arch5
config:num_train_worker=6
config:num_sample_worker=2
config:sample_type=khop2
config:root_path=/nvme/graph-learning-copy/samgraph/
config:dataset=papers100M-undir
config:pipeline=True
config:cache_policy=coll_cache_asymm_link
config:cache_percentage=0.52
config:num_epoch=4
config:batch_size=4000
config:num_hidden=256
config:max_sampling_jobs=1
config:max_copying_jobs=1
config:barriered_epoch=1
config:presample_epoch=2
config:omp_thread_num=40
config:unsupervised=True
config:amp=True
config:rolling=0
config:fanout=[25, 10]
config:lr=0.003
config:dropout=0.5
config:single_gpu=False
config:max_num_step=1000
config:validate_configs=False
config:report_acc=0
config:dataset_path=/nvme/graph-learning-copy/samgraph/papers100M-undir
config:torch_thread_num=9
config:train_workers=['cuda:0', 'cuda:1', 'cuda:2', 'cuda:3', 'cuda:4', 'cuda:5']
config:sample_workers=['cuda:6', 'cuda:7']
config:num_fanout=2
config:num_layer=2
config:_run_mode=RunMode.FGNN
config:_log_level=warn
config:_profile_level=3
config:_empty_feat=25
config:_arch=5
config:_sample_type=5
config:_cache_policy=13
test_result:init:input_scale_factor=1.1
0 :  {link #0 : 1}, {link #1 : 2}, {link #2 : 3}, {link #3 : 4}, {link #4 : 5},
1 :  {link #0 : 2}, {link #1 : 3}, {link #2 : 4}, {link #3 : 5}, {link #4 : 0},
2 :  {link #0 : 3}, {link #1 : 4}, {link #2 : 5}, {link #3 : 0}, {link #4 : 1},
3 :  {link #0 : 4}, {link #1 : 5}, {link #2 : 0}, {link #3 : 1}, {link #4 : 2},
4 :  {link #0 : 5}, {link #1 : 0}, {link #2 : 1}, {link #3 : 2}, {link #4 : 3},
5 :  {link #0 : 0}, {link #1 : 1}, {link #2 : 2}, {link #3 : 3}, {link #4 : 4},
0 : local 98, cpu 10 {link #0 : g1 11}, {link #1 : g2 11}, {link #2 : g3 11}, {link #3 : g4 11}, {link #4 : g5 11},
1 : local 98, cpu 10 {link #0 : g2 11}, {link #1 : g3 11}, {link #2 : g4 11}, {link #3 : g5 11}, {link #4 : g0 11},
2 : local 98, cpu 10 {link #0 : g3 11}, {link #1 : g4 11}, {link #2 : g5 11}, {link #3 : g0 11}, {link #4 : g1 11},
3 : local 98, cpu 10 {link #0 : g4 11}, {link #1 : g5 11}, {link #2 : g0 11}, {link #3 : g1 11}, {link #4 : g2 11},
4 : local 98, cpu 10 {link #0 : g5 11}, {link #1 : g0 11}, {link #2 : g1 11}, {link #3 : g2 11}, {link #4 : g3 11},
5 : local 98, cpu 10 {link #0 : g0 11}, {link #1 : g1 11}, {link #2 : g2 11}, {link #3 : g3 11}, {link #4 : g4 11},
0 :  {link #0 : 1}, {link #1 : 2}, {link #2 : 3}, {link #3 : 4}, {link #4 : 5},
1 :  {link #0 : 2}, {link #1 : 3}, {link #2 : 4}, {link #3 : 5}, {link #4 : 0},
2 :  {link #0 : 3}, {link #1 : 4}, {link #2 : 5}, {link #3 : 0}, {link #4 : 1},
3 :  {link #0 : 4}, {link #1 : 5}, {link #2 : 0}, {link #3 : 1}, {link #4 : 2},
4 :  {link #0 : 5}, {link #1 : 0}, {link #2 : 1}, {link #3 : 2}, {link #4 : 3},
5 :  {link #0 : 0}, {link #1 : 1}, {link #2 : 2}, {link #3 : 3}, {link #4 : 4},
0 : local 98, cpu 10 {link #0 : g1 11}, {link #1 : g2 11}, {link #2 : g3 11}, {link #3 : g4 11}, {link #4 : g5 11},
1 : local 98, cpu 10 {link #0 : g2 11}, {link #1 : g3 11}, {link #2 : g4 11}, {link #3 : g5 11}, {link #4 : g0 11},
2 : local 98, cpu 10 {link #0 : g3 11}, {link #1 : g4 11}, {link #2 : g5 11}, {link #3 : g0 11}, {link #4 : g1 11},
3 : local 98, cpu 10 {link #0 : g4 11}, {link #1 : g5 11}, {link #2 : g0 11}, {link #3 : g1 11}, {link #4 : g2 11},
4 : local 98, cpu 10 {link #0 : g5 11}, {link #1 : g0 11}, {link #2 : g1 11}, {link #3 : g2 11}, {link #4 : g3 11},
5 : local 98, cpu 10 {link #0 : g0 11}, {link #1 : g1 11}, {link #2 : g2 11}, {link #3 : g3 11}, {link #4 : g4 11},
0 :  {link #0 : 1}, {link #1 : 2}, {link #2 : 3}, {link #3 : 4}, {link #4 : 5},
1 :  {link #0 : 2}, {link #1 : 3}, {link #2 : 4}, {link #3 : 5}, {link #4 : 0},
2 :  {link #0 : 3}, {link #1 : 4}, {link #2 : 5}, {link #3 : 0}, {link #4 : 1},
3 :  {link #0 : 4}, {link #1 : 5}, {link #2 : 0}, {link #3 : 1}, {link #4 : 2},
4 :  {link #0 : 5}, {link #1 : 0}, {link #2 : 1}, {link #3 : 2}, {link #4 : 3},
5 :  {link #0 : 0}, {link #1 : 1}, {link #2 : 2}, {link #3 : 3}, {link #4 : 4},
0 : local 98, cpu 10 {link #0 : g1 11}, {link #1 : g2 11}, {link #2 : g3 11}, {link #3 : g4 11}, {link #4 : g5 11},
1 : local 98, cpu 10 {link #0 : g2 11}, {link #1 : g3 11}, {link #2 : g4 11}, {link #3 : g5 11}, {link #4 : g0 11},
2 : local 98, cpu 10 {link #0 : g3 11}, {link #1 : g4 11}, {link #2 : g5 11}, {link #3 : g0 11}, {link #4 : g1 11},
3 : local 98, cpu 10 {link #0 : g4 11}, {link #1 : g5 11}, {link #2 : g0 11}, {link #3 : g1 11}, {link #4 : g2 11},
4 : local 98, cpu 10 {link #0 : g5 11}, {link #1 : g0 11}, {link #2 : g1 11}, {link #3 : g2 11}, {link #4 : g3 11},
5 : local 98, cpu 10 {link #0 : g0 11}, {link #1 : g1 11}, {link #2 : g2 11}, {link #3 : g3 11}, {link #4 : g4 11},
0 :  {link #0 : 1}, {link #1 : 2}, {link #2 : 3}, {link #3 : 4}, {link #4 : 5},
1 :  {link #0 : 2}, {link #1 : 3}, {link #2 : 4}, {link #3 : 5}, {link #4 : 0},
2 :  {link #0 : 3}, {link #1 : 4}, {link #2 : 5}, {link #3 : 0}, {link #4 : 1},
3 :  {link #0 : 4}, {link #1 : 5}, {link #2 : 0}, {link #3 : 1}, {link #4 : 2},
4 :  {link #0 : 5}, {link #1 : 0}, {link #2 : 1}, {link #3 : 2}, {link #4 : 3},
5 :  {link #0 : 0}, {link #1 : 1}, {link #2 : 2}, {link #3 : 3}, {link #4 : 4},
0 : local 98, cpu 10 {link #0 : g1 11}, {link #1 : g2 11}, {link #2 : g3 11}, {link #3 : g4 11}, {link #4 : g5 11},
1 : local 98, cpu 10 {link #0 : g2 11}, {link #1 : g3 11}, {link #2 : g4 11}, {link #3 : g5 11}, {link #4 : g0 11},
2 : local 98, cpu 10 {link #0 : g3 11}, {link #1 : g4 11}, {link #2 : g5 11}, {link #3 : g0 11}, {link #4 : g1 11},
3 : local 98, cpu 10 {link #0 : g4 11}, {link #1 : g5 11}, {link #2 : g0 11}, {link #3 : g1 11}, {link #4 : g2 11},
4 : local 98, cpu 10 {link #0 : g5 11}, {link #1 : g0 11}, {link #2 : g1 11}, {link #3 : g2 11}, {link #4 : g3 11},
5 : local 98, cpu 10 {link #0 : g0 11}, {link #1 : g1 11}, {link #2 : g2 11}, {link #3 : g3 11}, {link #4 : g4 11},
0 :  {link #0 : 1}, {link #1 : 2}, {link #2 : 3}, {link #3 : 4}, {link #4 : 5},
1 :  {link #0 : 2}, {link #1 : 3}, {link #2 : 4}, {link #3 : 5}, {link #4 : 0},
2 :  {link #0 : 3}, {link #1 : 4}, {link #2 : 5}, {link #3 : 0}, {link #4 : 1},
3 :  {link #0 : 4}, {link #1 : 5}, {link #2 : 0}, {link #3 : 1}, {link #4 : 2},
4 :  {link #0 : 5}, {link #1 : 0}, {link #2 : 1}, {link #3 : 2}, {link #4 : 3},
5 :  {link #0 : 0}, {link #1 : 1}, {link #2 : 2}, {link #3 : 3}, {link #4 : 4},
0 : local 98, cpu 10 {link #0 : g1 11}, {link #1 : g2 11}, {link #2 : g3 11}, {link #3 : g4 11}, {link #4 : g5 11},
1 : local 98, cpu 10 {link #0 : g2 11}, {link #1 : g3 11}, {link #2 : g4 11}, {link #3 : g5 11}, {link #4 : g0 11},
2 : local 98, cpu 10 {link #0 : g3 11}, {link #1 : g4 11}, {link #2 : g5 11}, {link #3 : g0 11}, {link #4 : g1 11},
3 : local 98, cpu 10 {link #0 : g4 11}, {link #1 : g5 11}, {link #2 : g0 11}, {link #3 : g1 11}, {link #4 : g2 11},
4 : local 98, cpu 10 {link #0 : g5 11}, {link #1 : g0 11}, {link #2 : g1 11}, {link #3 : g2 11}, {link #4 : g3 11},
5 : local 98, cpu 10 {link #0 : g0 11}, {link #1 : g1 11}, {link #2 : g2 11}, {link #3 : g3 11}, {link #4 : g4 11},
0 :  {link #0 : 1}, {link #1 : 2}, {link #2 : 3}, {link #3 : 4}, {link #4 : 5},
1 :  {link #0 : 2}, {link #1 : 3}, {link #2 : 4}, {link #3 : 5}, {link #4 : 0},
2 :  {link #0 : 3}, {link #1 : 4}, {link #2 : 5}, {link #3 : 0}, {link #4 : 1},
3 :  {link #0 : 4}, {link #1 : 5}, {link #2 : 0}, {link #3 : 1}, {link #4 : 2},
4 :  {link #0 : 5}, {link #1 : 0}, {link #2 : 1}, {link #3 : 2}, {link #4 : 3},
5 :  {link #0 : 0}, {link #1 : 1}, {link #2 : 2}, {link #3 : 3}, {link #4 : 4},
0 : local 98, cpu 10 {link #0 : g1 11}, {link #1 : g2 11}, {link #2 : g3 11}, {link #3 : g4 11}, {link #4 : g5 11},
1 : local 98, cpu 10 {link #0 : g2 11}, {link #1 : g3 11}, {link #2 : g4 11}, {link #3 : g5 11}, {link #4 : g0 11},
2 : local 98, cpu 10 {link #0 : g3 11}, {link #1 : g4 11}, {link #2 : g5 11}, {link #3 : g0 11}, {link #4 : g1 11},
3 : local 98, cpu 10 {link #0 : g4 11}, {link #1 : g5 11}, {link #2 : g0 11}, {link #3 : g1 11}, {link #4 : g2 11},
4 : local 98, cpu 10 {link #0 : g5 11}, {link #1 : g0 11}, {link #2 : g1 11}, {link #3 : g2 11}, {link #4 : g3 11},
5 : local 98, cpu 10 {link #0 : g0 11}, {link #1 : g1 11}, {link #2 : g2 11}, {link #3 : g3 11}, {link #4 : g4 11},
Set parameter WLSAccessID
Set parameter WLSSecret
Set parameter LicenseID
Set parameter TimeLimit to value 200
Set parameter MIPGap to value 0.05
Set parameter LogFile to value "cppsolver.log"
Set parameter Threads to value 40
Academic license - for non-commercial use only - registered to xiaoniu.sxn@sjtu.edu.cn
Gurobi Optimizer version 9.5.1 build v9.5.1rc2 (linux64)
Thread count: 56 physical cores, 112 logical processors, using up to 40 threads
Academic license - for non-commercial use only - registered to xiaoniu.sxn@sjtu.edu.cn
Optimize a model with 231066 rows, 45961 columns and 611112 nonzeros
Model fingerprint: 0x74f96792
Variable types: 7 continuous, 45954 integer (45954 binary)
Coefficient statistics:
  Matrix range     [5e-09, 2e+04]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 7e+04]
Warning: Model contains large matrix coefficient range
         Consider reformulating model or setting NumericFocus parameter
         to avoid numerical issues.
Found heuristic solution: objective 300985.58192
Presolve removed 186310 rows and 5 columns
Presolve time: 0.52s
Presolved: 44756 rows, 45956 columns, 217935 nonzeros
Variable types: 1 continuous, 45955 integer (45954 binary)

Deterministic concurrent LP optimizer: primal and dual simplex
Showing first log only...


Use crossover to convert LP symmetric solution to basic solution...
Concurrent spin time: 0.00s

Solved with dual simplex

Root relaxation: objective 7.383214e+03, 22350 iterations, 0.29 seconds (0.39 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

H    0     0                    7383.2138064 7383.21381  0.00%     -    0s
     0     0 7383.21381    0  249 7383.21381 7383.21381  0.00%     -    0s

Explored 1 nodes (22350 simplex iterations) in 0.90 seconds (1.57 work units)
Thread count was 40 (of 112 available processors)

Solution count 2: 7383.21 300986 

Optimal solution found (tolerance 5.00e-02)
Best objective 7.383213806408e+03, best bound 7.383213806408e+03, gap 0.0000%
coll_cache:optimal_local_rate=0.80939,0.820671,0.820222,0.82227,0.81768,0.811946,
coll_cache:optimal_remote_rate=0.19061,0.179329,0.179778,0.17773,0.18232,0.188054,
coll_cache:optimal_cpu_rate=2.22567e-12,2.22567e-12,2.22567e-12,2.22567e-12,2.22567e-12,2.22567e-12,
z=7383.21
test_result:init:feat_nbytes=56862697472
test_result:init:cache_nbytes=29625465344
test_result:init:feat_nbytes=56862697472
test_result:init:cache_nbytes=29625465344
test_result:init:feat_nbytes=56862697472
test_result:init:cache_nbytes=29625465344
test_result:init:feat_nbytes=56862697472
test_result:init:cache_nbytes=29625465344
test_result:init:feat_nbytes=56862697472
test_result:init:cache_nbytes=29625465344
test_result:init:feat_nbytes=56862697472
test_result:init:cache_nbytes=29625465344
[Train  Worker 5/6] Started with PID 14866(NVIDIA A100-SXM4-80GB)
[Train  Worker 5] run train for 4 epochs with 1002 steps
[Train  Worker 3/6] Started with PID 14862(NVIDIA A100-SXM4-80GB)
[Train  Worker 3] run train for 4 epochs with 1002 steps
[Train  Worker 4/6] Started with PID 14864(NVIDIA A100-SXM4-80GB)
[Train  Worker 4] run train for 4 epochs with 1002 steps
[Train  Worker 1/6] Started with PID 14858(NVIDIA A100-SXM4-80GB)
[Train  Worker 1] run train for 4 epochs with 1002 steps
[CUDA] cuda0: usage: 37.50 GB
[SAM] cuda0 data alloc        : 0.00 Bytes
[SAM] cuda0 workspace         : 2.49 GB
[SAM] cuda0 workspace reserve : 1.21 GB
[SAM] cuda0 total             : 2.49 GB
[Train  Worker 2/6] Started with PID 14860(NVIDIA A100-SXM4-80GB)
[Train  Worker 2] run train for 4 epochs with 1002 steps
[Train  Worker 0/6] Started with PID 14856(NVIDIA A100-SXM4-80GB)
[Train  Worker 0] run train for 4 epochs with 1002 steps
Epoch 00000 | Epoch Time 3.8249 | Total Train Time(Profiler) 3.5950 | Copy Time 2.2592
[CUDA] cuda0: usage: 37.50 GB
[SAM] cuda0 data alloc        : 0.00 Bytes
[SAM] cuda0 workspace         : 2.49 GB
[SAM] cuda0 workspace reserve : 1.21 GB
[SAM] cuda0 total             : 2.49 GB
Epoch 00001 | Epoch Time 2.3668 | Total Train Time(Profiler) 2.0145 | Copy Time 2.3428
[CUDA] cuda0: usage: 37.51 GB
[SAM] cuda0 data alloc        : 0.00 Bytes
[SAM] cuda0 workspace         : 2.50 GB
[SAM] cuda0 workspace reserve : 1.22 GB
[SAM] cuda0 total             : 2.50 GB
Epoch 00002 | Epoch Time 2.4133 | Total Train Time(Profiler) 2.0306 | Copy Time 2.3866
[CUDA] cuda0: usage: 37.53 GB
[SAM] cuda0 data alloc        : 0.00 Bytes
[SAM] cuda0 workspace         : 2.51 GB
[SAM] cuda0 workspace reserve : 1.24 GB
[SAM] cuda0 total             : 2.51 GB
Epoch 00003 | Epoch Time 2.3900 | Total Train Time(Profiler) 2.0010 | Copy Time 2.3646
[Train  Worker 4] Avg Epoch Time 2.3900 | Train Total Time(Profiler) 2.0532 | Copy Time 2.3667
[Train  Worker 1] Avg Epoch Time 2.3901 | Train Total Time(Profiler) 1.9953 | Copy Time 2.3692
[Train  Worker 3] Avg Epoch Time 2.3901 | Train Total Time(Profiler) 2.0180 | Copy Time 2.3686
[Train  Worker 2] Avg Epoch Time 2.3901 | Train Total Time(Profiler) 2.0693 | Copy Time 2.3670
[Train  Worker 0] Avg Epoch Time 2.3901 | Train Total Time(Profiler) 2.0154 | Copy Time 2.3647
[Train  Worker 5] Avg Epoch Time 2.3901 | Train Total Time(Profiler) 2.0446 | Copy Time 2.3693
[Sample Worker 1/2] Started with PID 14854(NVIDIA A100-SXM4-80GB)
[Sample Worker 1] run sample for 4 epochs with 501 steps
[Sample Worker 1] Avg Sample Total Time 2.3572 | Sampler Total Time(Profiler) 2.3481
    [Step(average) Profiler Level 1 E3 S500]
        L1  sample           0.002874 | send           0.001832
        L1  recv             0.003459 | copy           0.014180 | convert time 0.000321 | train  0.011835
        L1  feature nbytes    1.07 GB | label nbytes   31.25 KB
        L1  id nbytes      0.00 Bytes | graph nbytes   20.42 MB
        L1  miss nbytes      30.26 KB | remote nbytes  203.94 MB
        L1  num nodes         2246727 | num samples     2668569
    [Step(average) Profiler Level 2 E3 S500]
        L2  shuffle     0.000124 | core sample  0.001035 | id remap        0.001495
        L2  graph copy  0.000003 | id copy      0.000000 | cache feat copy 0.010717
        L2  last layer sample time 0.000306 | size 114835.431310
    [Step(average) Profiler Level 3 E3 S500]
        L3  khop sample coo  0.000601 | khop sort coo      0.000000 | khop count edge     0.000040 | khop compact edge 0.000341
        L3  walk sample coo  0.000000 | walk topk total    0.000000 | walk topk step1     0.000000 | walk topk step2   0.000000
        L3  walk topk step3  0.000000 | walk topk step4    0.000000 | walk topk step5     0.000000
        L3  walk topk step6  0.000000 | walk topk step7    0.000000
        L3  remap unique     0.000213 | remap populate     0.001209 | remap mapnode       0.000000 | remap mapedge     0.000303
        L3  cache get_index  0.005118 | cache copy_index   0.000000 | cache extract_miss  0.000000
        L3  cache copy_miss  0.000000 | cache combine_miss 0.000071 | cache combine cache 0.001430 | cache combine remote 0.002538
        L3  label extract  0.000024
    [Init Profiler Level 1]
        L1  init     5.6338 | sampler init    58.4564 | trainer init 0.0000
    [Init Profiler Level 2]
        L2  load ds         7.4142 | init queue          41.8724
        L2  presample      13.1552 | build interal ds     1.6469
        L2  build cache     0.0000
    [Init Profiler Level 3]
        L3  load dataset: mmap     5.6325 | copy         1.7817
        L3  dist queue: alloc      0.0004 | pin         41.8720 | push     0.0000
        L3  presample: init        0.3714
        L3  presample: sample      5.5896 | copy         0.7102
        L3  presample: count       5.7766 | sort         0.1794
        L3  presample: reset       0.0012 | get rank     0.0148
        L3  internal: cuda ctx     1.4152 | cuda stream     0.2213
[Sample Worker 0/2] Started with PID 14852(NVIDIA A100-SXM4-80GB)
[Sample Worker 0] run sample for 4 epochs with 501 steps
[Sample Worker 0] Avg Sample Total Time 2.3656 | Sampler Total Time(Profiler) 2.3615
test_result:sample_time=1.4450
test_result:get_cache_miss_index_time=0.0000
test_result:enqueue_samples_time=0.9165
test_result:epoch_time:sample_total=2.3656
test_result:pipeline_sample_epoch_time=2.3903
[CUDA] cuda0: usage: 37.53 GB
[SAM] cuda0 data alloc        : 0.00 Bytes
[SAM] cuda0 workspace         : 2.51 GB
[SAM] cuda0 workspace reserve : 1.24 GB
[SAM] cuda0 total             : 2.51 GB
    [Step(average) Profiler Level 1 E3 S1001]
        L1  sample           0.002873 | send           0.001827
        L1  recv             0.003447 | copy           0.014177 | convert time 0.000322 | train  0.011851
        L1  feature nbytes    1.07 GB | label nbytes   31.25 KB
        L1  id nbytes      0.00 Bytes | graph nbytes   20.42 MB
        L1  miss nbytes      30.32 KB | remote nbytes  203.93 MB
        L1  num nodes         2246671 | num samples     2668506
        L1  seq duration     0.000000 | refresh duration   0.000000
    [Step(average) Profiler Level 2 E3 S1001]
        L2  shuffle     0.000123 | core sample  0.001035 | id remap        0.001494
        L2  graph copy  0.000004 | id copy      0.000000 | cache feat copy 0.010727
        L2  last layer sample time 0.000307 | size 114832.324459
    [Step(average) Profiler Level 3 E3 S1001]
        L3  khop sample coo  0.000601 | khop sort coo      0.000000 | khop count edge     0.000040 | khop compact edge 0.000341
        L3  walk sample coo  0.000000 | walk topk total    0.000000 | walk topk step1     0.000000 | walk topk step2   0.000000
        L3  walk topk step3  0.000000 | walk topk step4    0.000000 | walk topk step5     0.000000
        L3  walk topk step6  0.000000 | walk topk step7    0.000000
        L3  remap unique     0.000213 | remap populate     0.001208 | remap mapnode       0.000000 | remap mapedge     0.000303
        L3  cache get_index  0.005130 | cache copy_index   0.000000 | cache extract_miss  0.000000
        L3  cache copy_miss  0.000000 | cache combine_miss 0.000071 | cache combine cache 0.001426 | cache combine remote 0.002540
        L3  label extract  0.000024
    [Step(max) Profiler Level 1 E3 S1001]
        L1  sample           0.062709 | send           0.004594
        L1  recv             0.073958 | copy           0.077945 | convert time 0.002181 | train  0.017200
        L1  feature nbytes    1.08 GB | label nbytes   31.25 KB
        L1  id nbytes      0.00 Bytes | graph nbytes   20.65 MB
        L1  miss nbytes      46.00 KB | remote nbytes  214.63 MB
        L1  num nodes         2272547 | num samples     2698583
    [Step(max) Profiler Level 2 E3 S1001]
        L2  shuffle     0.059891 | core sample  0.007995 | id remap        0.006836
        L2  graph copy  0.000879 | id copy      0.000000 | cache feat copy 0.020527
        L2  last layer sample time 0.002354 | size 115785.000000
    [Step(max) Profiler Level 3 E3 S1001]
        L3  khop sample coo  0.007499 | khop sort coo      0.000000 | khop count edge     0.000552 | khop compact edge 0.005511
        L3  walk sample coo  0.000000 | walk topk total    0.000000 | walk topk step1     0.000000 | walk topk step2   0.000000
        L3  walk topk step3  0.000000 | walk topk step4    0.000000 | walk topk step5     0.000000
        L3  walk topk step6  0.000000 | walk topk step7    0.000000
        L3  remap unique     0.000668 | remap populate     0.006548 | remap mapnode       0.000000 | remap mapedge     0.002909
        L3  cache get_index  0.011188 | cache copy_index   0.000000 | cache extract_miss  0.000000
        L3  cache copy_miss  0.000000 | cache combine_miss 0.000198 | cache combine cache 0.010157 | cache combine remote 0.003827
        L3  label extract  0.000180
    [Step(min) Profiler Level 1 E3 S1001]
        L1  sample           0.002666 | send           0.001176
        L1  recv             0.001255 | copy           0.011311 | convert time 0.000279 | train  0.007477
        L1  feature nbytes    1.06 GB | label nbytes   31.25 KB
        L1  id nbytes      0.00 Bytes | graph nbytes   20.20 MB
        L1  miss nbytes      18.50 KB | remote nbytes  195.85 MB
        L1  num nodes         2220941 | num samples     2639308
    [Step(min) Profiler Level 2 E3 S1001]
        L2  shuffle     0.000012 | core sample  0.000992 | id remap        0.001448
        L2  graph copy  0.000002 | id copy      0.000000 | cache feat copy 0.003733
        L2  last layer sample time 0.000286 | size 113947.000000
    [Step(min) Profiler Level 3 E3 S1001]
        L3  khop sample coo  0.000577 | khop sort coo      0.000000 | khop count edge     0.000037 | khop compact edge 0.000321
        L3  walk sample coo  0.000000 | walk topk total    0.000000 | walk topk step1     0.000000 | walk topk step2   0.000000
        L3  walk topk step3  0.000000 | walk topk step4    0.000000 | walk topk step5     0.000000
        L3  walk topk step6  0.000000 | walk topk step7    0.000000
        L3  remap unique     0.000195 | remap populate     0.001170 | remap mapnode       0.000000 | remap mapedge     0.000292
        L3  cache get_index  0.000590 | cache copy_index   0.000000 | cache extract_miss  0.000000
        L3  cache copy_miss  0.000000 | cache combine_miss 0.000024 | cache combine cache 0.000432 | cache combine remote 0.001065
        L3  label extract  0.000014
    [Init Profiler Level 1]
        L1  init     5.6338 | sampler init     0.0000 | trainer init 76.2029
    [Init Profiler Level 2]
        L2  load ds         5.6325 | init queue          41.7930
        L2  presample       0.0000 | build interal ds     1.2855
        L2  build cache    33.1201
    [Init Profiler Level 3]
        L3  load dataset: mmap     5.6325 | copy         0.0000
        L3  dist queue: alloc      0.0004 | pin         41.7926 | push     0.0000
        L3  presample: init        0.0000
        L3  presample: sample      0.0000 | copy         0.0000
        L3  presample: count       0.0000 | sort         0.0000
        L3  presample: reset       0.0000 | get rank     0.0000
        L3  internal: cuda ctx     1.2855 | cuda stream     0.0000
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   33848 KB |  760181 KB |    1523 GB |    1523 GB |
|       from large pool |   28210 KB |  758977 KB |    1514 GB |    1514 GB |
|       from small pool |    5638 KB |    8373 KB |       8 GB |       8 GB |
|---------------------------------------------------------------------------|
| Active memory         |   33849 KB |  760181 KB |    1523 GB |    1523 GB |
|       from large pool |   28210 KB |  758977 KB |    1514 GB |    1514 GB |
|       from small pool |    5638 KB |    8373 KB |       8 GB |       8 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |     884 MB |     884 MB |     884 MB |       0 B  |
|       from large pool |     872 MB |     872 MB |     872 MB |       0 B  |
|       from small pool |      12 MB |      12 MB |      12 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   11207 KB |  663574 KB |    1664 GB |    1664 GB |
|       from large pool |    8653 KB |  658906 KB |    1654 GB |    1654 GB |
|       from small pool |    2553 KB |    6283 KB |       9 GB |       9 GB |
|---------------------------------------------------------------------------|
| Allocations           |      39    |      56    |   91555    |   91516    |
|       from large pool |       3    |      14    |   34068    |   34065    |
|       from small pool |      36    |      45    |   57487    |   57451    |
|---------------------------------------------------------------------------|
| Active allocs         |      40    |      56    |   91555    |   91515    |
|       from large pool |       3    |      14    |   34068    |   34065    |
|       from small pool |      37    |      45    |   57487    |   57450    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      15    |      15    |      15    |       0    |
|       from large pool |       9    |       9    |       9    |       0    |
|       from small pool |       6    |       6    |       6    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      11    |      25    |   40056    |   40045    |
|       from large pool |       3    |      12    |   22148    |   22145    |
|       from small pool |       8    |      17    |   17908    |   17900    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

test_result:epoch_time:copy_time=2.3647
test_result:convert_time=0.0555
test_result:train_time=1.9599
test_result:epoch_time:train_total=2.0154
test_result:cache_percentage=0.5200
test_result:cache_hit_rate=1.0000
test_result:run_time=10.9991
test_result:pipeline_train_epoch_time=2.3901

