succeed=True
config:eval_tsp="2023-04-15 12:41:42"
config:arch=arch5
config:num_train_worker=6
config:num_sample_worker=2
config:sample_type=khop2
config:root_path=/nvme/graph-learning-copy/samgraph/
config:dataset=com-friendster
config:pipeline=True
config:cache_policy=coll_cache_asymm_link
config:cache_percentage=0.5
config:num_epoch=4
config:batch_size=4000
config:num_hidden=256
config:max_sampling_jobs=1
config:max_copying_jobs=1
config:barriered_epoch=1
config:presample_epoch=2
config:omp_thread_num=40
config:unsupervised=True
config:amp=True
config:rolling=0
config:fanout=[25, 10]
config:lr=0.003
config:dropout=0.5
config:single_gpu=False
config:max_num_step=1000
config:validate_configs=False
config:report_acc=0
config:dataset_path=/nvme/graph-learning-copy/samgraph/com-friendster
config:torch_thread_num=9
config:train_workers=['cuda:0', 'cuda:1', 'cuda:2', 'cuda:3', 'cuda:4', 'cuda:5']
config:sample_workers=['cuda:6', 'cuda:7']
config:num_fanout=2
config:num_layer=2
config:_run_mode=RunMode.FGNN
config:_log_level=warn
config:_profile_level=3
config:_empty_feat=25
config:_arch=5
config:_sample_type=5
config:_cache_policy=13
test_result:init:input_scale_factor=1.1
0 :  {link #0 : 1}, {link #1 : 2}, {link #2 : 3}, {link #3 : 4}, {link #4 : 5},
1 :  {link #0 : 2}, {link #1 : 3}, {link #2 : 4}, {link #3 : 5}, {link #4 : 0},
2 :  {link #0 : 3}, {link #1 : 4}, {link #2 : 5}, {link #3 : 0}, {link #4 : 1},
3 :  {link #0 : 4}, {link #1 : 5}, {link #2 : 0}, {link #3 : 1}, {link #4 : 2},
4 :  {link #0 : 5}, {link #1 : 0}, {link #2 : 1}, {link #3 : 2}, {link #4 : 3},
5 :  {link #0 : 0}, {link #1 : 1}, {link #2 : 2}, {link #3 : 3}, {link #4 : 4},
0 : local 98, cpu 10 {link #0 : g1 11}, {link #1 : g2 11}, {link #2 : g3 11}, {link #3 : g4 11}, {link #4 : g5 11},
1 : local 98, cpu 10 {link #0 : g2 11}, {link #1 : g3 11}, {link #2 : g4 11}, {link #3 : g5 11}, {link #4 : g0 11},
2 : local 98, cpu 10 {link #0 : g3 11}, {link #1 : g4 11}, {link #2 : g5 11}, {link #3 : g0 11}, {link #4 : g1 11},
3 : local 98, cpu 10 {link #0 : g4 11}, {link #1 : g5 11}, {link #2 : g0 11}, {link #3 : g1 11}, {link #4 : g2 11},
4 : local 98, cpu 10 {link #0 : g5 11}, {link #1 : g0 11}, {link #2 : g1 11}, {link #3 : g2 11}, {link #4 : g3 11},
5 : local 98, cpu 10 {link #0 : g0 11}, {link #1 : g1 11}, {link #2 : g2 11}, {link #3 : g3 11}, {link #4 : g4 11},
0 :  {link #0 : 1}, {link #1 : 2}, {link #2 : 3}, {link #3 : 4}, {link #4 : 5},
1 :  {link #0 : 2}, {link #1 : 3}, {link #2 : 4}, {link #3 : 5}, {link #4 : 0},
2 :  {link #0 : 3}, {link #1 : 4}, {link #2 : 5}, {link #3 : 0}, {link #4 : 1},
3 :  {link #0 : 4}, {link #1 : 5}, {link #2 : 0}, {link #3 : 1}, {link #4 : 2},
4 :  {link #0 : 5}, {link #1 : 0}, {link #2 : 1}, {link #3 : 2}, {link #4 : 3},
5 :  {link #0 : 0}, {link #1 : 1}, {link #2 : 2}, {link #3 : 3}, {link #4 : 4},
0 : local 98, cpu 10 {link #0 : g1 11}, {link #1 : g2 11}, {link #2 : g3 11}, {link #3 : g4 11}, {link #4 : g5 11},
1 : local 98, cpu 10 {link #0 : g2 11}, {link #1 : g3 11}, {link #2 : g4 11}, {link #3 : g5 11}, {link #4 : g0 11},
2 : local 98, cpu 10 {link #0 : g3 11}, {link #1 : g4 11}, {link #2 : g5 11}, {link #3 : g0 11}, {link #4 : g1 11},
3 : local 98, cpu 10 {link #0 : g4 11}, {link #1 : g5 11}, {link #2 : g0 11}, {link #3 : g1 11}, {link #4 : g2 11},
4 : local 98, cpu 10 {link #0 : g5 11}, {link #1 : g0 11}, {link #2 : g1 11}, {link #3 : g2 11}, {link #4 : g3 11},
5 : local 98, cpu 10 {link #0 : g0 11}, {link #1 : g1 11}, {link #2 : g2 11}, {link #3 : g3 11}, {link #4 : g4 11},
0 :  {link #0 : 1}, {link #1 : 2}, {link #2 : 3}, {link #3 : 4}, {link #4 : 5},
1 :  {link #0 : 2}, {link #1 : 3}, {link #2 : 4}, {link #3 : 5}, {link #4 : 0},
2 :  {link #0 : 3}, {link #1 : 4}, {link #2 : 5}, {link #3 : 0}, {link #4 : 1},
3 :  {link #0 : 4}, {link #1 : 5}, {link #2 : 0}, {link #3 : 1}, {link #4 : 2},
4 :  {link #0 : 5}, {link #1 : 0}, {link #2 : 1}, {link #3 : 2}, {link #4 : 3},
5 :  {link #0 : 0}, {link #1 : 1}, {link #2 : 2}, {link #3 : 3}, {link #4 : 4},
0 : local 98, cpu 10 {link #0 : g1 11}, {link #1 : g2 11}, {link #2 : g3 11}, {link #3 : g4 11}, {link #4 : g5 11},
1 : local 98, cpu 10 {link #0 : g2 11}, {link #1 : g3 11}, {link #2 : g4 11}, {link #3 : g5 11}, {link #4 : g0 11},
2 : local 98, cpu 10 {link #0 : g3 11}, {link #1 : g4 11}, {link #2 : g5 11}, {link #3 : g0 11}, {link #4 : g1 11},
3 : local 98, cpu 10 {link #0 : g4 11}, {link #1 : g5 11}, {link #2 : g0 11}, {link #3 : g1 11}, {link #4 : g2 11},
4 : local 98, cpu 10 {link #0 : g5 11}, {link #1 : g0 11}, {link #2 : g1 11}, {link #3 : g2 11}, {link #4 : g3 11},
5 : local 98, cpu 10 {link #0 : g0 11}, {link #1 : g1 11}, {link #2 : g2 11}, {link #3 : g3 11}, {link #4 : g4 11},
0 :  {link #0 : 1}, {link #1 : 2}, {link #2 : 3}, {link #3 : 4}, {link #4 : 5},
1 :  {link #0 : 2}, {link #1 : 3}, {link #2 : 4}, {link #3 : 5}, {link #4 : 0},
2 :  {link #0 : 3}, {link #1 : 4}, {link #2 : 5}, {link #3 : 0}, {link #4 : 1},
3 :  {link #0 : 4}, {link #1 : 5}, {link #2 : 0}, {link #3 : 1}, {link #4 : 2},
4 :  {link #0 : 5}, {link #1 : 0}, {link #2 : 1}, {link #3 : 2}, {link #4 : 3},
5 :  {link #0 : 0}, {link #1 : 1}, {link #2 : 2}, {link #3 : 3}, {link #4 : 4},
0 : local 98, cpu 10 {link #0 : g1 11}, {link #1 : g2 11}, {link #2 : g3 11}, {link #3 : g4 11}, {link #4 : g5 11},
1 : local 98, cpu 10 {link #0 : g2 11}, {link #1 : g3 11}, {link #2 : g4 11}, {link #3 : g5 11}, {link #4 : g0 11},
2 : local 98, cpu 10 {link #0 : g3 11}, {link #1 : g4 11}, {link #2 : g5 11}, {link #3 : g0 11}, {link #4 : g1 11},
3 : local 98, cpu 10 {link #0 : g4 11}, {link #1 : g5 11}, {link #2 : g0 11}, {link #3 : g1 11}, {link #4 : g2 11},
4 : local 98, cpu 10 {link #0 : g5 11}, {link #1 : g0 11}, {link #2 : g1 11}, {link #3 : g2 11}, {link #4 : g3 11},
5 : local 98, cpu 10 {link #0 : g0 11}, {link #1 : g1 11}, {link #2 : g2 11}, {link #3 : g3 11}, {link #4 : g4 11},
0 :  {link #0 : 1}, {link #1 : 2}, {link #2 : 3}, {link #3 : 4}, {link #4 : 5},
1 :  {link #0 : 2}, {link #1 : 3}, {link #2 : 4}, {link #3 : 5}, {link #4 : 0},
2 :  {link #0 : 3}, {link #1 : 4}, {link #2 : 5}, {link #3 : 0}, {link #4 : 1},
3 :  {link #0 : 4}, {link #1 : 5}, {link #2 : 0}, {link #3 : 1}, {link #4 : 2},
4 :  {link #0 : 5}, {link #1 : 0}, {link #2 : 1}, {link #3 : 2}, {link #4 : 3},
5 :  {link #0 : 0}, {link #1 : 1}, {link #2 : 2}, {link #3 : 3}, {link #4 : 4},
0 : local 98, cpu 10 {link #0 : g1 11}, {link #1 : g2 11}, {link #2 : g3 11}, {link #3 : g4 11}, {link #4 : g5 11},
1 : local 98, cpu 10 {link #0 : g2 11}, {link #1 : g3 11}, {link #2 : g4 11}, {link #3 : g5 11}, {link #4 : g0 11},
2 : local 98, cpu 10 {link #0 : g3 11}, {link #1 : g4 11}, {link #2 : g5 11}, {link #3 : g0 11}, {link #4 : g1 11},
3 : local 98, cpu 10 {link #0 : g4 11}, {link #1 : g5 11}, {link #2 : g0 11}, {link #3 : g1 11}, {link #4 : g2 11},
4 : local 98, cpu 10 {link #0 : g5 11}, {link #1 : g0 11}, {link #2 : g1 11}, {link #3 : g2 11}, {link #4 : g3 11},
5 : local 98, cpu 10 {link #0 : g0 11}, {link #1 : g1 11}, {link #2 : g2 11}, {link #3 : g3 11}, {link #4 : g4 11},
0 :  {link #0 : 1}, {link #1 : 2}, {link #2 : 3}, {link #3 : 4}, {link #4 : 5},
1 :  {link #0 : 2}, {link #1 : 3}, {link #2 : 4}, {link #3 : 5}, {link #4 : 0},
2 :  {link #0 : 3}, {link #1 : 4}, {link #2 : 5}, {link #3 : 0}, {link #4 : 1},
3 :  {link #0 : 4}, {link #1 : 5}, {link #2 : 0}, {link #3 : 1}, {link #4 : 2},
4 :  {link #0 : 5}, {link #1 : 0}, {link #2 : 1}, {link #3 : 2}, {link #4 : 3},
5 :  {link #0 : 0}, {link #1 : 1}, {link #2 : 2}, {link #3 : 3}, {link #4 : 4},
0 : local 98, cpu 10 {link #0 : g1 11}, {link #1 : g2 11}, {link #2 : g3 11}, {link #3 : g4 11}, {link #4 : g5 11},
1 : local 98, cpu 10 {link #0 : g2 11}, {link #1 : g3 11}, {link #2 : g4 11}, {link #3 : g5 11}, {link #4 : g0 11},
2 : local 98, cpu 10 {link #0 : g3 11}, {link #1 : g4 11}, {link #2 : g5 11}, {link #3 : g0 11}, {link #4 : g1 11},
3 : local 98, cpu 10 {link #0 : g4 11}, {link #1 : g5 11}, {link #2 : g0 11}, {link #3 : g1 11}, {link #4 : g2 11},
4 : local 98, cpu 10 {link #0 : g5 11}, {link #1 : g0 11}, {link #2 : g1 11}, {link #3 : g2 11}, {link #4 : g3 11},
5 : local 98, cpu 10 {link #0 : g0 11}, {link #1 : g1 11}, {link #2 : g2 11}, {link #3 : g3 11}, {link #4 : g4 11},
Set parameter WLSAccessID
Set parameter WLSSecret
Set parameter LicenseID
Set parameter TimeLimit to value 200
Set parameter MIPGap to value 0.05
Set parameter LogFile to value "cppsolver.log"
Set parameter Threads to value 40
Academic license - for non-commercial use only - registered to xiaoniu.sxn@sjtu.edu.cn
Gurobi Optimizer version 9.5.1 build v9.5.1rc2 (linux64)
Thread count: 56 physical cores, 112 logical processors, using up to 40 threads
Academic license - for non-commercial use only - registered to xiaoniu.sxn@sjtu.edu.cn
Optimize a model with 216558 rows, 43075 columns and 572736 nonzeros
Model fingerprint: 0xe0886359
Variable types: 7 continuous, 43068 integer (43068 binary)
Coefficient statistics:
  Matrix range     [8e-09, 5e+04]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 1e+05]
Warning: Model contains large matrix coefficient range
         Consider reformulating model or setting NumericFocus parameter
         to avoid numerical issues.
Found heuristic solution: objective 539572.01357
Presolve removed 174610 rows and 5 columns
Presolve time: 0.47s
Presolved: 41948 rows, 43070 columns, 205185 nonzeros
Variable types: 1 continuous, 43069 integer (43068 binary)

Deterministic concurrent LP optimizer: primal and dual simplex
Showing first log only...


Use crossover to convert LP symmetric solution to basic solution...
Concurrent spin time: 0.01s

Solved with dual simplex

Root relaxation: objective 1.323121e+04, 21652 iterations, 0.27 seconds (0.36 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

H    0     0                    13231.207584 13231.2076  0.00%     -    0s
     0     0 13231.2076    0  309 13231.2076 13231.2076  0.00%     -    0s

Explored 1 nodes (21652 simplex iterations) in 0.82 seconds (1.38 work units)
Thread count was 40 (of 112 available processors)

Solution count 2: 13231.2 539572 

Optimal solution found (tolerance 5.00e-02)
Best objective 1.323120758409e+04, best bound 1.323120758409e+04, gap 0.0000%
coll_cache:optimal_local_rate=0.85632,0.868751,0.854263,0.845423,0.858361,0.853546,
coll_cache:optimal_remote_rate=0.14368,0.131249,0.145737,0.154577,0.141639,0.146454,
coll_cache:optimal_cpu_rate=0,0,0,0,0,0,
z=13231.2
test_result:init:feat_nbytes=67182966784
test_result:init:cache_nbytes=33658665984
test_result:init:feat_nbytes=67182966784
test_result:init:cache_nbytes=33658665984
test_result:init:feat_nbytes=67182966784
test_result:init:cache_nbytes=33658665984
test_result:init:feat_nbytes=67182966784
test_result:init:cache_nbytes=33658665984
test_result:init:feat_nbytes=67182966784
test_result:init:cache_nbytes=33658665984
test_result:init:feat_nbytes=67182966784
test_result:init:cache_nbytes=33658665984
[Train  Worker 3/6] Started with PID 15728(NVIDIA A100-SXM4-80GB)
[Train  Worker 3] run train for 4 epochs with 1002 steps
[Train  Worker 4/6] Started with PID 15731(NVIDIA A100-SXM4-80GB)
[Train  Worker 4] run train for 4 epochs with 1002 steps
[Train  Worker 2/6] Started with PID 15725(NVIDIA A100-SXM4-80GB)
[Train  Worker 2] run train for 4 epochs with 1002 steps
[Train  Worker 5/6] Started with PID 15734(NVIDIA A100-SXM4-80GB)
[Train  Worker 5] run train for 4 epochs with 1002 steps
[Train  Worker 1/6] Started with PID 15722(NVIDIA A100-SXM4-80GB)
[Train  Worker 1] run train for 4 epochs with 1002 steps
[CUDA] cuda0: usage: 43.47 GB
[SAM] cuda0 data alloc        : 0.00 Bytes
[SAM] cuda0 workspace         : 5.10 GB
[SAM] cuda0 workspace reserve : 2.51 GB
[SAM] cuda0 total             : 5.10 GB
[Train  Worker 0/6] Started with PID 15719(NVIDIA A100-SXM4-80GB)
[Train  Worker 0] run train for 4 epochs with 1002 steps
Epoch 00000 | Epoch Time 4.6269 | Total Train Time(Profiler) 4.3622 | Copy Time 3.1109
[CUDA] cuda0: usage: 43.47 GB
[SAM] cuda0 data alloc        : 0.00 Bytes
[SAM] cuda0 workspace         : 5.10 GB
[SAM] cuda0 workspace reserve : 2.52 GB
[SAM] cuda0 total             : 5.10 GB
Epoch 00001 | Epoch Time 2.9641 | Total Train Time(Profiler) 2.8183 | Copy Time 2.9438
[CUDA] cuda0: usage: 43.47 GB
[SAM] cuda0 data alloc        : 0.00 Bytes
[SAM] cuda0 workspace         : 5.10 GB
[SAM] cuda0 workspace reserve : 2.51 GB
[SAM] cuda0 total             : 5.10 GB
Epoch 00002 | Epoch Time 2.9635 | Total Train Time(Profiler) 2.8005 | Copy Time 2.9434
[CUDA] cuda0: usage: 43.47 GB
[SAM] cuda0 data alloc        : 0.00 Bytes
[SAM] cuda0 workspace         : 5.10 GB
[SAM] cuda0 workspace reserve : 2.52 GB
[SAM] cuda0 total             : 5.10 GB
Epoch 00003 | Epoch Time 2.9654 | Total Train Time(Profiler) 2.8147 | Copy Time 2.9453
[Train  Worker 5] Avg Epoch Time 2.9643 | Train Total Time(Profiler) 2.8296 | Copy Time 2.9397
[Train  Worker 3] Avg Epoch Time 2.9643 | Train Total Time(Profiler) 2.8391 | Copy Time 2.9355
[Train  Worker 2] Avg Epoch Time 2.9643 | Train Total Time(Profiler) 2.8303 | Copy Time 2.9361
[Train  Worker 0] Avg Epoch Time 2.9643 | Train Total Time(Profiler) 2.8111 | Copy Time 2.9442
[Train  Worker 1] Avg Epoch Time 2.9643 | Train Total Time(Profiler) 2.8266 | Copy Time 2.9393
[Train  Worker 4] Avg Epoch Time 2.9643 | Train Total Time(Profiler) 2.8263 | Copy Time 2.9421
[Sample Worker 1/2] Started with PID 15715(NVIDIA A100-SXM4-80GB)
[Sample Worker 1] run sample for 4 epochs with 501 steps
[Sample Worker 1] Avg Sample Total Time 2.5517 | Sampler Total Time(Profiler) 2.5352
    [Step(average) Profiler Level 1 E3 S500]
        L1  sample           0.003083 | send           0.002029
        L1  recv             0.003027 | copy           0.017602 | convert time 0.000333 | train  0.016592
        L1  feature nbytes    2.27 GB | label nbytes   31.25 KB
        L1  id nbytes      0.00 Bytes | graph nbytes   21.46 MB
        L1  miss nbytes    0.00 Bytes | remote nbytes  337.35 MB
        L1  num nodes         2377868 | num samples     2804902
    [Step(average) Profiler Level 2 E3 S500]
        L2  shuffle     0.000131 | core sample  0.001168 | id remap        0.001577
        L2  graph copy  0.000004 | id copy      0.000000 | cache feat copy 0.014571
        L2  last layer sample time 0.000296 | size 114625.640974
    [Step(average) Profiler Level 3 E3 S500]
        L3  khop sample coo  0.000719 | khop sort coo      0.000000 | khop count edge     0.000039 | khop compact edge 0.000360
        L3  walk sample coo  0.000000 | walk topk total    0.000000 | walk topk step1     0.000000 | walk topk step2   0.000000
        L3  walk topk step3  0.000000 | walk topk step4    0.000000 | walk topk step5     0.000000
        L3  walk topk step6  0.000000 | walk topk step7    0.000000
        L3  remap unique     0.000201 | remap populate     0.001274 | remap mapnode       0.000000 | remap mapedge     0.000319
        L3  cache get_index  0.007769 | cache copy_index   0.000000 | cache extract_miss  0.000000
        L3  cache copy_miss  0.000000 | cache combine_miss 0.000000 | cache combine cache 0.002069 | cache combine remote 0.004332
        L3  label extract  0.000025
    [Init Profiler Level 1]
        L1  init    10.1070 | sampler init    59.4528 | trainer init 0.0000
    [Init Profiler Level 2]
        L2  load ds        12.1160 | init queue          42.3892
        L2  presample      13.4643 | build interal ds     1.5888
        L2  build cache     0.0000
    [Init Profiler Level 3]
        L3  load dataset: mmap    10.1058 | copy         2.0102
        L3  dist queue: alloc      0.0004 | pin         42.3888 | push     0.0000
        L3  presample: init        0.0838
        L3  presample: sample      6.0620 | copy         0.7504
        L3  presample: count       6.1014 | sort         0.2077
        L3  presample: reset       0.0013 | get rank     0.0064
        L3  internal: cuda ctx     1.3597 | cuda stream     0.2225
[Sample Worker 0/2] Started with PID 15713(NVIDIA A100-SXM4-80GB)
[Sample Worker 0] run sample for 4 epochs with 501 steps
[Sample Worker 0] Avg Sample Total Time 2.5631 | Sampler Total Time(Profiler) 2.5593
test_result:sample_time=1.5513
test_result:get_cache_miss_index_time=0.0000
test_result:enqueue_samples_time=1.0080
test_result:epoch_time:sample_total=2.5631
test_result:pipeline_sample_epoch_time=2.9646
[CUDA] cuda0: usage: 43.47 GB
[SAM] cuda0 data alloc        : 0.00 Bytes
[SAM] cuda0 workspace         : 5.10 GB
[SAM] cuda0 workspace reserve : 2.52 GB
[SAM] cuda0 total             : 5.10 GB
    [Step(average) Profiler Level 1 E3 S1001]
        L1  sample           0.003076 | send           0.002008
        L1  recv             0.003018 | copy           0.017602 | convert time 0.000334 | train  0.016598
        L1  feature nbytes    2.27 GB | label nbytes   31.25 KB
        L1  id nbytes      0.00 Bytes | graph nbytes   21.46 MB
        L1  miss nbytes    0.00 Bytes | remote nbytes  337.46 MB
        L1  num nodes         2377907 | num samples     2804926
        L1  seq duration     0.000000 | refresh duration 258635603891673578032499465471040368692917689553174382624255442899804235057945098996725259703462428934340533923706672323218496852159962373383961948407597700743168.000000
    [Step(average) Profiler Level 2 E3 S1001]
        L2  shuffle     0.000128 | core sample  0.001167 | id remap        0.001574
        L2  graph copy  0.000004 | id copy      0.000000 | cache feat copy 0.014580
        L2  last layer sample time 0.000295 | size 114627.170050
    [Step(average) Profiler Level 3 E3 S1001]
        L3  khop sample coo  0.000719 | khop sort coo      0.000000 | khop count edge     0.000039 | khop compact edge 0.000359
        L3  walk sample coo  0.000000 | walk topk total    0.000000 | walk topk step1     0.000000 | walk topk step2   0.000000
        L3  walk topk step3  0.000000 | walk topk step4    0.000000 | walk topk step5     0.000000
        L3  walk topk step6  0.000000 | walk topk step7    0.000000
        L3  remap unique     0.000200 | remap populate     0.001272 | remap mapnode       0.000000 | remap mapedge     0.000318
        L3  cache get_index  0.007778 | cache copy_index   0.000000 | cache extract_miss  0.000000
        L3  cache copy_miss  0.000000 | cache combine_miss 0.000000 | cache combine cache 0.002071 | cache combine remote 0.004320
        L3  label extract  0.000025
    [Step(max) Profiler Level 1 E3 S1001]
        L1  sample           0.069015 | send           0.005282
        L1  recv             0.080028 | copy           0.087152 | convert time 0.001740 | train  0.022252
        L1  feature nbytes    2.29 GB | label nbytes   31.25 KB
        L1  id nbytes      0.00 Bytes | graph nbytes   21.67 MB
        L1  miss nbytes    0.00 Bytes | remote nbytes  365.72 MB
        L1  num nodes         2396924 | num samples     2832386
    [Step(max) Profiler Level 2 E3 S1001]
        L2  shuffle     0.066008 | core sample  0.003340 | id remap        0.005024
        L2  graph copy  0.000143 | id copy      0.000000 | cache feat copy 0.029497
        L2  last layer sample time 0.001578 | size 115572.000000
    [Step(max) Profiler Level 3 E3 S1001]
        L3  khop sample coo  0.002652 | khop sort coo      0.000000 | khop count edge     0.000066 | khop compact edge 0.002481
        L3  walk sample coo  0.000000 | walk topk total    0.000000 | walk topk step1     0.000000 | walk topk step2   0.000000
        L3  walk topk step3  0.000000 | walk topk step4    0.000000 | walk topk step5     0.000000
        L3  walk topk step6  0.000000 | walk topk step7    0.000000
        L3  remap unique     0.000269 | remap populate     0.004724 | remap mapnode       0.000000 | remap mapedge     0.003491
        L3  cache get_index  0.013557 | cache copy_index   0.000000 | cache extract_miss  0.000000
        L3  cache copy_miss  0.000000 | cache combine_miss 0.000001 | cache combine cache 0.008266 | cache combine remote 0.005351
        L3  label extract  0.000090
    [Step(min) Profiler Level 1 E3 S1001]
        L1  sample           0.002898 | send           0.001241
        L1  recv             0.001341 | copy           0.016699 | convert time 0.000295 | train  0.009826
        L1  feature nbytes    2.25 GB | label nbytes   31.25 KB
        L1  id nbytes      0.00 Bytes | graph nbytes   21.25 MB
        L1  miss nbytes    0.00 Bytes | remote nbytes  304.65 MB
        L1  num nodes         2356729 | num samples     2776796
    [Step(min) Profiler Level 2 E3 S1001]
        L2  shuffle     0.000012 | core sample  0.001134 | id remap        0.001535
        L2  graph copy  0.000002 | id copy      0.000000 | cache feat copy 0.007072
        L2  last layer sample time 0.000287 | size 113645.000000
    [Step(min) Profiler Level 3 E3 S1001]
        L3  khop sample coo  0.000697 | khop sort coo      0.000000 | khop count edge     0.000037 | khop compact edge 0.000343
        L3  walk sample coo  0.000000 | walk topk total    0.000000 | walk topk step1     0.000000 | walk topk step2   0.000000
        L3  walk topk step3  0.000000 | walk topk step4    0.000000 | walk topk step5     0.000000
        L3  walk topk step6  0.000000 | walk topk step7    0.000000
        L3  remap unique     0.000191 | remap populate     0.001237 | remap mapnode       0.000000 | remap mapedge     0.000311
        L3  cache get_index  0.000656 | cache copy_index   0.000000 | cache extract_miss  0.000000
        L3  cache copy_miss  0.000000 | cache combine_miss 0.000000 | cache combine cache 0.001501 | cache combine remote 0.001725
        L3  label extract  0.000015
    [Init Profiler Level 1]
        L1  init    10.1070 | sampler init     0.0000 | trainer init 77.1686
    [Init Profiler Level 2]
        L2  load ds        10.1058 | init queue          42.4448
        L2  presample       0.0000 | build interal ds     1.4487
        L2  build cache    33.2723
    [Init Profiler Level 3]
        L3  load dataset: mmap    10.1058 | copy         0.0000
        L3  dist queue: alloc      0.0004 | pin         42.4445 | push     0.0000
        L3  presample: init        0.0000
        L3  presample: sample      0.0000 | copy         0.0000
        L3  presample: count       0.0000 | sort         0.0000
        L3  presample: reset       0.0000 | get rank     0.0000
        L3  internal: cuda ctx     1.4487 | cuda stream     0.0000
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   31910 KB |    1446 MB |    1928 GB |    1928 GB |
|       from large pool |   25740 KB |    1444 MB |    1919 GB |    1919 GB |
|       from small pool |    6169 KB |       8 MB |       9 GB |       9 GB |
|---------------------------------------------------------------------------|
| Active memory         |   31910 KB |    1446 MB |    1928 GB |    1928 GB |
|       from large pool |   25740 KB |    1444 MB |    1919 GB |    1919 GB |
|       from small pool |    6170 KB |       8 MB |       9 GB |       9 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1462 MB |    1462 MB |    1462 MB |       0 B  |
|       from large pool |    1450 MB |    1450 MB |    1450 MB |       0 B  |
|       from small pool |      12 MB |      12 MB |      12 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   37721 KB |    1277 MB |    1815 GB |    1815 GB |
|       from large pool |   35699 KB |    1273 MB |    1806 GB |    1806 GB |
|       from small pool |    2022 KB |       5 MB |       9 GB |       9 GB |
|---------------------------------------------------------------------------|
| Allocations           |      39    |      56    |   91555    |   91516    |
|       from large pool |       3    |      14    |   34068    |   34065    |
|       from small pool |      36    |      45    |   57487    |   57451    |
|---------------------------------------------------------------------------|
| Active allocs         |      40    |      56    |   91555    |   91515    |
|       from large pool |       3    |      14    |   34068    |   34065    |
|       from small pool |      37    |      45    |   57487    |   57450    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      14    |      14    |      14    |       0    |
|       from large pool |       8    |       8    |       8    |       0    |
|       from small pool |       6    |       6    |       6    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      14    |      26    |   37327    |   37313    |
|       from large pool |       4    |      10    |   20795    |   20791    |
|       from small pool |      10    |      19    |   16532    |   16522    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

test_result:epoch_time:copy_time=2.9442
test_result:convert_time=0.0590
test_result:train_time=2.7522
test_result:epoch_time:train_total=2.8111
test_result:cache_percentage=0.5000
test_result:cache_hit_rate=1.0000
test_result:run_time=13.5224
test_result:pipeline_train_epoch_time=2.9643

