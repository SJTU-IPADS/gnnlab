succeed=True
config:eval_tsp="2023-04-15 08:57:41"
config:arch=arch5
config:num_train_worker=6
config:num_sample_worker=2
config:sample_type=khop2
config:root_path=/nvme/graph-learning-copy/samgraph/
config:dataset=mag240m-homo
config:pipeline=False
config:cache_policy=coll_cache_asymm_link
config:cache_percentage=0.1
config:num_epoch=4
config:batch_size=2000
config:num_hidden=256
config:max_sampling_jobs=1
config:max_copying_jobs=1
config:barriered_epoch=1
config:presample_epoch=2
config:omp_thread_num=40
config:unsupervised=True
config:amp=True
config:rolling=0
config:fanout=[25, 10]
config:lr=0.003
config:dropout=0.5
config:single_gpu=False
config:max_num_step=1000
config:validate_configs=False
config:report_acc=0
config:dataset_path=/nvme/graph-learning-copy/samgraph/mag240m-homo
config:torch_thread_num=9
config:train_workers=['cuda:0', 'cuda:1', 'cuda:2', 'cuda:3', 'cuda:4', 'cuda:5']
config:sample_workers=['cuda:6', 'cuda:7']
config:num_fanout=2
config:num_layer=2
config:_run_mode=RunMode.FGNN
config:_log_level=warn
config:_profile_level=3
config:_empty_feat=25
config:_arch=5
config:_sample_type=5
config:_cache_policy=13
test_result:init:input_scale_factor=1.10086
0 :  {link #0 : 1}, {link #1 : 2}, {link #2 : 3}, {link #3 : 4}, {link #4 : 5},
1 :  {link #0 : 2}, {link #1 : 3}, {link #2 : 4}, {link #3 : 5}, {link #4 : 0},
2 :  {link #0 : 3}, {link #1 : 4}, {link #2 : 5}, {link #3 : 0}, {link #4 : 1},
3 :  {link #0 : 4}, {link #1 : 5}, {link #2 : 0}, {link #3 : 1}, {link #4 : 2},
4 :  {link #0 : 5}, {link #1 : 0}, {link #2 : 1}, {link #3 : 2}, {link #4 : 3},
5 :  {link #0 : 0}, {link #1 : 1}, {link #2 : 2}, {link #3 : 3}, {link #4 : 4},
0 :  {link #0 : 1}, {link #1 : 2}, {link #2 : 3}, {link #3 : 4}, {link #4 : 5},
1 :  {link #0 : 2}, {link #1 : 3}, {link #2 : 4}, {link #3 : 5}, {link #4 : 0},
2 :  {link #0 : 3}, {link #1 : 4}, {link #2 : 5}, {link #3 : 0}, {link #4 : 1},
3 :  {link #0 : 4}, {link #1 : 5}, {link #2 : 0}, {link #3 : 1}, {link #4 : 2},
4 :  {link #0 : 5}, {link #1 : 0}, {link #2 : 1}, {link #3 : 2}, {link #4 : 3},
5 :  {link #0 : 0}, {link #1 : 1}, {link #2 : 2}, {link #3 : 3}, {link #4 : 4},
0 : local 98, cpu 10 {link #0 : g1 11}, {link #1 : g2 11}, {link #2 : g3 11}, {link #3 : g4 11}, {link #4 : g5 11},
1 : local 98, cpu 10 {link #0 : g2 11}, {link #1 : g3 11}, {link #2 : g4 11}, {link #3 : g5 11}, {link #4 : g0 11},
2 : local 98, cpu 10 {link #0 : g3 11}, {link #1 : g4 11}, {link #2 : g5 11}, {link #3 : g0 11}, {link #4 : g1 11},
3 : local 98, cpu 10 {link #0 : g4 11}, {link #1 : g5 11}, {link #2 : g0 11}, {link #3 : g1 11}, {link #4 : g2 11},
4 : local 98, cpu 10 {link #0 : g5 11}, {link #1 : g0 11}, {link #2 : g1 11}, {link #3 : g2 11}, {link #4 : g3 11},
5 : local 98, cpu 10 {link #0 : g0 11}, {link #1 : g1 11}, {link #2 : g2 11}, {link #3 : g3 11}, {link #4 : g4 11},
0 : local 98, cpu 10 {link #0 : g1 11}, {link #1 : g2 11}, {link #2 : g3 11}, {link #3 : g4 11}, {link #4 : g5 11},
1 : local 98, cpu 10 {link #0 : g2 11}, {link #1 : g3 11}, {link #2 : g4 11}, {link #3 : g5 11}, {link #4 : g0 11},
2 : local 98, cpu 10 {link #0 : g3 11}, {link #1 : g4 11}, {link #2 : g5 11}, {link #3 : g0 11}, {link #4 : g1 11},
3 : local 98, cpu 10 {link #0 : g4 11}, {link #1 : g5 11}, {link #2 : g0 11}, {link #3 : g1 11}, {link #4 : g2 11},
4 : local 98, cpu 10 {link #0 : g5 11}, {link #1 : g0 11}, {link #2 : g1 11}, {link #3 : g2 11}, {link #4 : g3 11},
5 : local 98, cpu 10 {link #0 : g0 11}, {link #1 : g1 11}, {link #2 : g2 11}, {link #3 : g3 11}, {link #4 : g4 11},
0 :  {link #0 : 1}, {link #1 : 2}, {link #2 : 3}, {link #3 : 4}, {link #4 : 5},
1 :  {link #0 : 2}, {link #1 : 3}, {link #2 : 4}, {link #3 : 5}, {link #4 : 0},
2 :  {link #0 : 3}, {link #1 : 4}, {link #2 : 5}, {link #3 : 0}, {link #4 : 1},
3 :  {link #0 : 4}, {link #1 : 5}, {link #2 : 0}, {link #3 : 1}, {link #4 : 2},
4 :  {link #0 : 5}, {link #1 : 0}, {link #2 : 1}, {link #3 : 2}, {link #4 : 3},
5 :  {link #0 : 0}, {link #1 : 1}, {link #2 : 2}, {link #3 : 3}, {link #4 : 4},
0 :  {link #0 : 1}, {link #1 : 2}, {link #2 : 3}, {link #3 : 4}, {link #4 : 5},
1 :  {link #0 : 2}, {link #1 : 3}, {link #2 : 4}, {link #3 : 5}, {link #4 : 0},
2 :  {link #0 : 3}, {link #1 : 4}, {link #2 : 5}, {link #3 : 0}, {link #4 : 1},
3 :  {link #0 : 4}, {link #1 : 5}, {link #2 : 0}, {link #3 : 1}, {link #4 : 2},
4 :  {link #0 : 5}, {link #1 : 0}, {link #2 : 1}, {link #3 : 2}, {link #4 : 3},
5 :  {link #0 : 0}, {link #1 : 1}, {link #2 : 2}, {link #3 : 3}, {link #4 : 4},
0 : local 98, cpu 10 {link #0 : g1 11}, {link #1 : g2 11}, {link #2 : g3 11}, {link #3 : g4 11}, {link #4 : g5 11},
1 : local 98, cpu 10 {link #0 : g2 11}, {link #1 : g3 11}, {link #2 : g4 11}, {link #3 : g5 11}, {link #4 : g0 11},
2 : local 98, cpu 10 {link #0 : g3 11}, {link #1 : g4 11}, {link #2 : g5 11}, {link #3 : g0 11}, {link #4 : g1 11},
3 : local 98, cpu 10 {link #0 : g4 11}, {link #1 : g5 11}, {link #2 : g0 11}, {link #3 : g1 11}, {link #4 : g2 11},
4 : local 98, cpu 10 {link #0 : g5 11}, {link #1 : g0 11}, {link #2 : g1 11}, {link #3 : g2 11}, {link #4 : g3 11},
5 : local 98, cpu 10 {link #0 : g0 11}, {link #1 : g1 11}, {link #2 : g2 11}, {link #3 : g3 11}, {link #4 : g4 11},
0 : local 98, cpu 10 {link #0 : g1 11}, {link #1 : g2 11}, {link #2 : g3 11}, {link #3 : g4 11}, {link #4 : g5 11},
1 : local 98, cpu 10 {link #0 : g2 11}, {link #1 : g3 11}, {link #2 : g4 11}, {link #3 : g5 11}, {link #4 : g0 11},
2 : local 98, cpu 10 {link #0 : g3 11}, {link #1 : g4 11}, {link #2 : g5 11}, {link #3 : g0 11}, {link #4 : g1 11},
3 : local 98, cpu 10 {link #0 : g4 11}, {link #1 : g5 11}, {link #2 : g0 11}, {link #3 : g1 11}, {link #4 : g2 11},
4 : local 98, cpu 10 {link #0 : g5 11}, {link #1 : g0 11}, {link #2 : g1 11}, {link #3 : g2 11}, {link #4 : g3 11},
5 : local 98, cpu 10 {link #0 : g0 11}, {link #1 : g1 11}, {link #2 : g2 11}, {link #3 : g3 11}, {link #4 : g4 11},
0 :  {link #0 : 1}, {link #1 : 2}, {link #2 : 3}, {link #3 : 4}, {link #4 : 5},
1 :  {link #0 : 2}, {link #1 : 3}, {link #2 : 4}, {link #3 : 5}, {link #4 : 0},
2 :  {link #0 : 3}, {link #1 : 4}, {link #2 : 5}, {link #3 : 0}, {link #4 : 1},
3 :  {link #0 : 4}, {link #1 : 5}, {link #2 : 0}, {link #3 : 1}, {link #4 : 2},
4 :  {link #0 : 5}, {link #1 : 0}, {link #2 : 1}, {link #3 : 2}, {link #4 : 3},
5 :  {link #0 : 0}, {link #1 : 1}, {link #2 : 2}, {link #3 : 3}, {link #4 : 4},
0 : local 98, cpu 10 {link #0 : g1 11}, {link #1 : g2 11}, {link #2 : g3 11}, {link #3 : g4 11}, {link #4 : g5 11},
1 : local 98, cpu 10 {link #0 : g2 11}, {link #1 : g3 11}, {link #2 : g4 11}, {link #3 : g5 11}, {link #4 : g0 11},
2 : local 98, cpu 10 {link #0 : g3 11}, {link #1 : g4 11}, {link #2 : g5 11}, {link #3 : g0 11}, {link #4 : g1 11},
3 : local 98, cpu 10 {link #0 : g4 11}, {link #1 : g5 11}, {link #2 : g0 11}, {link #3 : g1 11}, {link #4 : g2 11},
4 : local 98, cpu 10 {link #0 : g5 11}, {link #1 : g0 11}, {link #2 : g1 11}, {link #3 : g2 11}, {link #4 : g3 11},
5 : local 98, cpu 10 {link #0 : g0 11}, {link #1 : g1 11}, {link #2 : g2 11}, {link #3 : g3 11}, {link #4 : g4 11},
0 :  {link #0 : 1}, {link #1 : 2}, {link #2 : 3}, {link #3 : 4}, {link #4 : 5},
1 :  {link #0 : 2}, {link #1 : 3}, {link #2 : 4}, {link #3 : 5}, {link #4 : 0},
2 :  {link #0 : 3}, {link #1 : 4}, {link #2 : 5}, {link #3 : 0}, {link #4 : 1},
3 :  {link #0 : 4}, {link #1 : 5}, {link #2 : 0}, {link #3 : 1}, {link #4 : 2},
4 :  {link #0 : 5}, {link #1 : 0}, {link #2 : 1}, {link #3 : 2}, {link #4 : 3},
5 :  {link #0 : 0}, {link #1 : 1}, {link #2 : 2}, {link #3 : 3}, {link #4 : 4},
0 : local 98, cpu 10 {link #0 : g1 11}, {link #1 : g2 11}, {link #2 : g3 11}, {link #3 : g4 11}, {link #4 : g5 11},
1 : local 98, cpu 10 {link #0 : g2 11}, {link #1 : g3 11}, {link #2 : g4 11}, {link #3 : g5 11}, {link #4 : g0 11},
2 : local 98, cpu 10 {link #0 : g3 11}, {link #1 : g4 11}, {link #2 : g5 11}, {link #3 : g0 11}, {link #4 : g1 11},
3 : local 98, cpu 10 {link #0 : g4 11}, {link #1 : g5 11}, {link #2 : g0 11}, {link #3 : g1 11}, {link #4 : g2 11},
4 : local 98, cpu 10 {link #0 : g5 11}, {link #1 : g0 11}, {link #2 : g1 11}, {link #3 : g2 11}, {link #4 : g3 11},
5 : local 98, cpu 10 {link #0 : g0 11}, {link #1 : g1 11}, {link #2 : g2 11}, {link #3 : g3 11}, {link #4 : g4 11},
Set parameter WLSAccessID
Set parameter WLSSecret
Set parameter LicenseID
Set parameter TimeLimit to value 200
Set parameter MIPGap to value 0.05
Set parameter LogFile to value "cppsolver.log"
Set parameter Threads to value 40
Academic license - for non-commercial use only - registered to xiaoniu.sxn@sjtu.edu.cn
Gurobi Optimizer version 9.5.1 build v9.5.1rc2 (linux64)
Thread count: 56 physical cores, 112 logical processors, using up to 40 threads
Academic license - for non-commercial use only - registered to xiaoniu.sxn@sjtu.edu.cn
Optimize a model with 146622 rows, 29163 columns and 387744 nonzeros
Model fingerprint: 0x5c14a16e
Variable types: 7 continuous, 29156 integer (29156 binary)
Coefficient statistics:
  Matrix range     [2e-09, 6e+03]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 1e+04]
Warning: Model contains large matrix coefficient range
         Consider reformulating model or setting NumericFocus parameter
         to avoid numerical issues.
Found heuristic solution: objective 57706.610834
Presolve removed 118210 rows and 5 columns
Presolve time: 0.33s
Presolved: 28412 rows, 29158 columns, 137885 nonzeros
Variable types: 1 continuous, 29157 integer (29156 binary)

Deterministic concurrent LP optimizer: primal and dual simplex
Showing first log only...


Use crossover to convert LP symmetric solution to basic solution...
Concurrent spin time: 0.01s

Solved with primal simplex

Root relaxation: objective 1.921007e+03, 6377 iterations, 0.16 seconds (0.24 work units)
Total elapsed time = 6.01s

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 1921.00705    0  100 57706.6108 1921.00705  96.7%     -    7s
H    0     0                    1971.3866785 1921.00705  2.56%     -    7s

Explored 1 nodes (42789 simplex iterations) in 7.20 seconds (11.66 work units)
Thread count was 40 (of 112 available processors)

Solution count 2: 1971.39 57706.6 

Optimal solution found (tolerance 5.00e-02)
Best objective 1.971386678492e+03, best bound 1.921007050764e+03, gap 2.5555%
coll_cache:optimal_local_rate=0.488093,0.488959,0.487376,0.492565,0.490564,0.48827,
coll_cache:optimal_remote_rate=0.504258,0.503393,0.504976,0.499786,0.501787,0.504081,
coll_cache:optimal_cpu_rate=0.00764887,0.00764887,0.00764887,0.00764887,0.00764887,0.00764887,
z=1971.39
test_result:init:feat_nbytes=375030526464
test_result:init:cache_nbytes=37878082560
test_result:init:feat_nbytes=375030526464
test_result:init:cache_nbytes=37878082560
test_result:init:feat_nbytes=375030526464
test_result:init:cache_nbytes=37878082560
test_result:init:feat_nbytes=375030526464
test_result:init:cache_nbytes=37878082560
test_result:init:feat_nbytes=375030526464
test_result:init:cache_nbytes=37878082560
test_result:init:feat_nbytes=375030526464
test_result:init:cache_nbytes=37878082560
[Train  Worker 3/6] Started with PID 10654(NVIDIA A100-SXM4-80GB)
[Train  Worker 3] run train for 4 epochs with 1002 steps
[Train  Worker 5/6] Started with PID 10658(NVIDIA A100-SXM4-80GB)
[Train  Worker 5] run train for 4 epochs with 1002 steps
[Train  Worker 1/6] Started with PID 10650(NVIDIA A100-SXM4-80GB)
[Train  Worker 1] run train for 4 epochs with 1002 steps
[Train  Worker 4/6] Started with PID 10656(NVIDIA A100-SXM4-80GB)
[Train  Worker 4] run train for 4 epochs with 1002 steps
[Train  Worker 2/6] Started with PID 10652(NVIDIA A100-SXM4-80GB)
[Train  Worker 2] run train for 4 epochs with 1002 steps
[CUDA] cuda0: usage: 45.71 GB
[SAM] cuda0 data alloc        : 0.00 Bytes
[SAM] cuda0 workspace         : 3.06 GB
[SAM] cuda0 workspace reserve : 1.52 GB
[SAM] cuda0 total             : 3.06 GB
[Train  Worker 0/6] Started with PID 10648(NVIDIA A100-SXM4-80GB)
[Train  Worker 0] run train for 4 epochs with 1002 steps
Epoch 00000 | Epoch Time 5.1381 | Total Train Time(Profiler) 3.3000 | Copy Time 1.8259
[CUDA] cuda0: usage: 45.71 GB
[SAM] cuda0 data alloc        : 0.00 Bytes
[SAM] cuda0 workspace         : 3.06 GB
[SAM] cuda0 workspace reserve : 1.52 GB
[SAM] cuda0 total             : 3.06 GB
Epoch 00001 | Epoch Time 3.4742 | Total Train Time(Profiler) 1.7604 | Copy Time 1.7015
[CUDA] cuda0: usage: 45.71 GB
[SAM] cuda0 data alloc        : 0.00 Bytes
[SAM] cuda0 workspace         : 3.06 GB
[SAM] cuda0 workspace reserve : 1.52 GB
[SAM] cuda0 total             : 3.06 GB
Epoch 00002 | Epoch Time 3.4774 | Total Train Time(Profiler) 1.7611 | Copy Time 1.7052
[CUDA] cuda0: usage: 45.71 GB
[SAM] cuda0 data alloc        : 0.00 Bytes
[SAM] cuda0 workspace         : 3.06 GB
[SAM] cuda0 workspace reserve : 1.52 GB
[SAM] cuda0 total             : 3.06 GB
Epoch 00003 | Epoch Time 3.4825 | Total Train Time(Profiler) 1.7626 | Copy Time 1.7093
[Train  Worker 1] Avg Epoch Time 3.4780 | Train Total Time(Profiler) 1.7643 | Copy Time 1.7020
[Train  Worker 5] Avg Epoch Time 3.4781 | Train Total Time(Profiler) 1.7591 | Copy Time 1.7083
[Train  Worker 4] Avg Epoch Time 3.4781 | Train Total Time(Profiler) 1.7672 | Copy Time 1.7002
[Train  Worker 3] Avg Epoch Time 3.4782 | Train Total Time(Profiler) 1.7716 | Copy Time 1.6953
[Train  Worker 0] Avg Epoch Time 3.4780 | Train Total Time(Profiler) 1.7614 | Copy Time 1.7053
[Train  Worker 2] Avg Epoch Time 3.4781 | Train Total Time(Profiler) 1.7649 | Copy Time 1.7025
[Sample Worker 1/2] Started with PID 10646(NVIDIA A100-SXM4-80GB)
[Sample Worker 1] run sample for 4 epochs with 501 steps
[Sample Worker 1] Avg Sample Total Time 1.1352 | Sampler Total Time(Profiler) 1.1311
    [Step(average) Profiler Level 1 E3 S500]
        L1  sample           0.001617 | send           0.000665
        L1  recv             0.001034 | copy           0.010187 | convert time 0.000329 | train  0.010236
        L1  feature nbytes    1.36 GB | label nbytes   15.62 KB
        L1  id nbytes      0.00 Bytes | graph nbytes    8.41 MB
        L1  miss nbytes      32.80 MB | remote nbytes  691.44 MB
        L1  num nodes          953856 | num samples     1098817
    [Step(average) Profiler Level 2 E3 S500]
        L2  shuffle     0.000063 | core sample  0.000581 | id remap        0.000749
        L2  graph copy  0.000003 | id copy      0.000000 | cache feat copy 0.009150
        L2  last layer sample time 0.000289 | size 49778.761581
    [Step(average) Profiler Level 3 E3 S500]
        L3  khop sample coo  0.000323 | khop sort coo      0.000000 | khop count edge     0.000037 | khop compact edge 0.000170
        L3  walk sample coo  0.000000 | walk topk total    0.000000 | walk topk step1     0.000000 | walk topk step2   0.000000
        L3  walk topk step3  0.000000 | walk topk step4    0.000000 | walk topk step5     0.000000
        L3  walk topk step6  0.000000 | walk topk step7    0.000000
        L3  remap unique     0.000217 | remap populate     0.000613 | remap mapnode       0.000000 | remap mapedge     0.000153
        L3  cache get_index  0.000360 | cache copy_index   0.000000 | cache extract_miss  0.000000
        L3  cache copy_miss  0.000000 | cache combine_miss 0.005369 | cache combine cache 0.000177 | cache combine remote 0.008324
        L3  label extract  0.000025
    [Init Profiler Level 1]
        L1  init    15.7861 | sampler init    53.3302 | trainer init 0.0000
    [Init Profiler Level 2]
        L2  load ds        17.7756 | init queue          42.4978
        L2  presample       7.2293 | build interal ds     1.6116
        L2  build cache     0.0000
    [Init Profiler Level 3]
        L3  load dataset: mmap    15.7849 | copy         1.9907
        L3  dist queue: alloc      0.0003 | pin         42.4975 | push     0.0000
        L3  presample: init        0.2807
        L3  presample: sample      3.1810 | copy         0.3196
        L3  presample: count       2.7110 | sort         0.3375
        L3  presample: reset       0.0011 | get rank     0.0406
        L3  internal: cuda ctx     1.3924 | cuda stream     0.2153
[Sample Worker 0/2] Started with PID 10644(NVIDIA A100-SXM4-80GB)
[Sample Worker 0] run sample for 4 epochs with 501 steps
[Sample Worker 0] Avg Sample Total Time 1.1574 | Sampler Total Time(Profiler) 1.1540
test_result:sample_time=0.8199
test_result:get_cache_miss_index_time=0.0000
test_result:enqueue_samples_time=0.3341
test_result:epoch_time:sample_total=1.1574
[CUDA] cuda0: usage: 45.71 GB
[SAM] cuda0 data alloc        : 0.00 Bytes
[SAM] cuda0 workspace         : 3.06 GB
[SAM] cuda0 workspace reserve : 1.52 GB
[SAM] cuda0 total             : 3.06 GB
    [Step(average) Profiler Level 1 E3 S1001]
        L1  sample           0.001615 | send           0.000666
        L1  recv             0.001034 | copy           0.010193 | convert time 0.000329 | train  0.010238
        L1  feature nbytes    1.36 GB | label nbytes   15.62 KB
        L1  id nbytes      0.00 Bytes | graph nbytes    8.41 MB
        L1  miss nbytes      32.82 MB | remote nbytes  691.40 MB
        L1  num nodes          953807 | num samples     1098762
        L1  seq duration     0.000000 | refresh duration 258635603891673578032499465471040368692917689553174382624255442899804235057945098996725259703462428934340533923706672323218496852159962373383961948407597700743168.000000
    [Step(average) Profiler Level 2 E3 S1001]
        L2  shuffle     0.000063 | core sample  0.000581 | id remap        0.000748
        L2  graph copy  0.000003 | id copy      0.000000 | cache feat copy 0.009156
        L2  last layer sample time 0.000288 | size 49776.248918
    [Step(average) Profiler Level 3 E3 S1001]
        L3  khop sample coo  0.000324 | khop sort coo      0.000000 | khop count edge     0.000037 | khop compact edge 0.000170
        L3  walk sample coo  0.000000 | walk topk total    0.000000 | walk topk step1     0.000000 | walk topk step2   0.000000
        L3  walk topk step3  0.000000 | walk topk step4    0.000000 | walk topk step5     0.000000
        L3  walk topk step6  0.000000 | walk topk step7    0.000000
        L3  remap unique     0.000216 | remap populate     0.000611 | remap mapnode       0.000000 | remap mapedge     0.000152
        L3  cache get_index  0.000360 | cache copy_index   0.000000 | cache extract_miss  0.000000
        L3  cache copy_miss  0.000000 | cache combine_miss 0.005371 | cache combine cache 0.000179 | cache combine remote 0.008323
        L3  label extract  0.000025
    [Step(max) Profiler Level 1 E3 S1001]
        L1  sample           0.027212 | send           0.006496
        L1  recv             0.003390 | copy           0.013880 | convert time 0.000839 | train  0.014481
        L1  feature nbytes    1.40 GB | label nbytes   15.62 KB
        L1  id nbytes      0.00 Bytes | graph nbytes    8.62 MB
        L1  miss nbytes      34.71 MB | remote nbytes  715.45 MB
        L1  num nodes          979455 | num samples     1125208
    [Step(max) Profiler Level 2 E3 S1001]
        L2  shuffle     0.024058 | core sample  0.002023 | id remap        0.006207
        L2  graph copy  0.000018 | id copy      0.000000 | cache feat copy 0.012916
        L2  last layer sample time 0.003152 | size 50664.000000
    [Step(max) Profiler Level 3 E3 S1001]
        L3  khop sample coo  0.001716 | khop sort coo      0.000000 | khop count edge     0.001201 | khop compact edge 0.000441
        L3  walk sample coo  0.000000 | walk topk total    0.000000 | walk topk step1     0.000000 | walk topk step2   0.000000
        L3  walk topk step3  0.000000 | walk topk step4    0.000000 | walk topk step5     0.000000
        L3  walk topk step6  0.000000 | walk topk step7    0.000000
        L3  remap unique     0.001641 | remap populate     0.006075 | remap mapnode       0.000000 | remap mapedge     0.000192
        L3  cache get_index  0.001592 | cache copy_index   0.000000 | cache extract_miss  0.000000
        L3  cache copy_miss  0.000000 | cache combine_miss 0.010725 | cache combine cache 0.003277 | cache combine remote 0.009108
        L3  label extract  0.000107
    [Step(min) Profiler Level 1 E3 S1001]
        L1  sample           0.001468 | send           0.000502
        L1  recv             0.000576 | copy           0.008970 | convert time 0.000301 | train  0.010004
        L1  feature nbytes    1.33 GB | label nbytes   15.62 KB
        L1  id nbytes      0.00 Bytes | graph nbytes    8.22 MB
        L1  miss nbytes      31.15 MB | remote nbytes  668.98 MB
        L1  num nodes          931107 | num samples     1073057
    [Step(min) Profiler Level 2 E3 S1001]
        L2  shuffle     0.000012 | core sample  0.000544 | id remap        0.000690
        L2  graph copy  0.000003 | id copy      0.000000 | cache feat copy 0.008191
        L2  last layer sample time 0.000266 | size 48815.000000
    [Step(min) Profiler Level 3 E3 S1001]
        L3  khop sample coo  0.000302 | khop sort coo      0.000000 | khop count edge     0.000033 | khop compact edge 0.000156
        L3  walk sample coo  0.000000 | walk topk total    0.000000 | walk topk step1     0.000000 | walk topk step2   0.000000
        L3  walk topk step3  0.000000 | walk topk step4    0.000000 | walk topk step5     0.000000
        L3  walk topk step6  0.000000 | walk topk step7    0.000000
        L3  remap unique     0.000198 | remap populate     0.000558 | remap mapnode       0.000000 | remap mapedge     0.000139
        L3  cache get_index  0.000346 | cache copy_index   0.000000 | cache extract_miss  0.000000
        L3  cache copy_miss  0.000000 | cache combine_miss 0.003855 | cache combine cache 0.000032 | cache combine remote 0.007188
        L3  label extract  0.000016
    [Init Profiler Level 1]
        L1  init    15.7861 | sampler init     0.0000 | trainer init 80.9542
    [Init Profiler Level 2]
        L2  load ds        15.7849 | init queue          42.5493
        L2  presample       0.0000 | build interal ds     1.3749
        L2  build cache    37.0277
    [Init Profiler Level 3]
        L3  load dataset: mmap    15.7849 | copy         0.0000
        L3  dist queue: alloc      0.0003 | pin         42.5489 | push     0.0000
        L3  presample: init        0.0000
        L3  presample: sample      0.0000 | copy         0.0000
        L3  presample: count       0.0000 | sort         0.0000
        L3  presample: reset       0.0000 | get rank     0.0000
        L3  internal: cuda ctx     1.3749 | cuda stream     0.0001
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   34802 KB |  649063 KB |    1186 GB |    1186 GB |
|       from large pool |   25532 KB |  646129 KB |    1177 GB |    1177 GB |
|       from small pool |    9270 KB |   11602 KB |       8 GB |       8 GB |
|---------------------------------------------------------------------------|
| Active memory         |   34802 KB |  649063 KB |    1186 GB |    1186 GB |
|       from large pool |   25532 KB |  646129 KB |    1177 GB |    1177 GB |
|       from small pool |    9270 KB |   11602 KB |       8 GB |       8 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |     772 MB |     772 MB |     772 MB |       0 B  |
|       from large pool |     756 MB |     756 MB |     756 MB |       0 B  |
|       from small pool |      16 MB |      16 MB |      16 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   40973 KB |  605487 KB |     985 GB |     985 GB |
|       from large pool |   37956 KB |  603811 KB |     974 GB |     974 GB |
|       from small pool |    3017 KB |    5574 KB |      10 GB |      10 GB |
|---------------------------------------------------------------------------|
| Allocations           |      43    |      62    |   97568    |   97525    |
|       from large pool |       7    |      18    |   38079    |   38072    |
|       from small pool |      36    |      47    |   59489    |   59453    |
|---------------------------------------------------------------------------|
| Active allocs         |      44    |      62    |   97568    |   97524    |
|       from large pool |       7    |      18    |   38079    |   38072    |
|       from small pool |      37    |      47    |   59489    |   59452    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      17    |      17    |      17    |       0    |
|       from large pool |       9    |       9    |       9    |       0    |
|       from small pool |       8    |       8    |       8    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      18    |      29    |   44258    |   44240    |
|       from large pool |       4    |      12    |   26114    |   26110    |
|       from small pool |      14    |      23    |   18144    |   18130    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

test_result:epoch_time:copy_time=1.7053
test_result:convert_time=0.0546
test_result:train_time=1.7067
test_result:epoch_time:train_total=1.7614
test_result:cache_percentage=0.1000
test_result:cache_hit_rate=1.0000
test_result:run_time=20.2883

