succeed=True
config:eval_tsp="2023-04-15 09:00:19"
config:arch=arch5
config:num_train_worker=6
config:num_sample_worker=2
config:sample_type=khop2
config:root_path=/nvme/graph-learning-copy/samgraph/
config:dataset=mag240m-homo
config:pipeline=False
config:cache_policy=coll_cache_asymm_link
config:cache_percentage=0.18
config:num_epoch=4
config:batch_size=2000
config:num_hidden=256
config:max_sampling_jobs=1
config:max_copying_jobs=1
config:barriered_epoch=1
config:presample_epoch=2
config:omp_thread_num=40
config:unsupervised=True
config:amp=True
config:rolling=0
config:fanout=[25, 10]
config:lr=0.003
config:dropout=0.5
config:single_gpu=False
config:max_num_step=1000
config:validate_configs=False
config:report_acc=0
config:dataset_path=/nvme/graph-learning-copy/samgraph/mag240m-homo
config:torch_thread_num=9
config:train_workers=['cuda:0', 'cuda:1', 'cuda:2', 'cuda:3', 'cuda:4', 'cuda:5']
config:sample_workers=['cuda:6', 'cuda:7']
config:num_fanout=2
config:num_layer=2
config:_run_mode=RunMode.FGNN
config:_log_level=warn
config:_profile_level=3
config:_empty_feat=25
config:_arch=5
config:_sample_type=5
config:_cache_policy=13
test_result:init:input_scale_factor=1.1033
0 :  {link #0 : 1}, {link #1 : 2}, {link #2 : 3}, {link #3 : 4}, {link #4 : 5},
1 :  {link #0 : 2}, {link #1 : 3}, {link #2 : 4}, {link #3 : 5}, {link #4 : 0},
2 :  {link #0 : 3}, {link #1 : 4}, {link #2 : 5}, {link #3 : 0}, {link #4 : 1},
3 :  {link #0 : 4}, {link #1 : 5}, {link #2 : 0}, {link #3 : 1}, {link #4 : 2},
4 :  {link #0 : 5}, {link #1 : 0}, {link #2 : 1}, {link #3 : 2}, {link #4 : 3},
5 :  {link #0 : 0}, {link #1 : 1}, {link #2 : 2}, {link #3 : 3}, {link #4 : 4},
0 : local 98, cpu 10 {link #0 : g1 11}, {link #1 : g2 11}, {link #2 : g3 11}, {link #3 : g4 11}, {link #4 : g5 11},
1 : local 98, cpu 10 {link #0 : g2 11}, {link #1 : g3 11}, {link #2 : g4 11}, {link #3 : g5 11}, {link #4 : g0 11},
2 : local 98, cpu 10 {link #0 : g3 11}, {link #1 : g4 11}, {link #2 : g5 11}, {link #3 : g0 11}, {link #4 : g1 11},
3 : local 98, cpu 10 {link #0 : g4 11}, {link #1 : g5 11}, {link #2 : g0 11}, {link #3 : g1 11}, {link #4 : g2 11},
4 : local 98, cpu 10 {link #0 : g5 11}, {link #1 : g0 11}, {link #2 : g1 11}, {link #3 : g2 11}, {link #4 : g3 11},
5 : local 98, cpu 10 {link #0 : g0 11}, {link #1 : g1 11}, {link #2 : g2 11}, {link #3 : g3 11}, {link #4 : g4 11},
0 :  {link #0 : 1}, {link #1 : 2}, {link #2 : 3}, {link #3 : 4}, {link #4 : 5},
1 :  {link #0 : 2}, {link #1 : 3}, {link #2 : 4}, {link #3 : 5}, {link #4 : 0},
2 :  {link #0 : 3}, {link #1 : 4}, {link #2 : 5}, {link #3 : 0}, {link #4 : 1},
3 :  {link #0 : 4}, {link #1 : 5}, {link #2 : 0}, {link #3 : 1}, {link #4 : 2},
4 :  {link #0 : 5}, {link #1 : 0}, {link #2 : 1}, {link #3 : 2}, {link #4 : 3},
5 :  {link #0 : 0}, {link #1 : 1}, {link #2 : 2}, {link #3 : 3}, {link #4 : 4},
0 :  {link #0 : 1}, {link #1 : 2}, {link #2 : 3}, {link #3 : 4}, {link #4 : 5},
1 :  {link #0 : 2}, {link #1 : 3}, {link #2 : 4}, {link #3 : 5}, {link #4 : 0},
2 :  {link #0 : 3}, {link #1 : 4}, {link #2 : 5}, {link #3 : 0}, {link #4 : 1},
3 :  {link #0 : 4}, {link #1 : 5}, {link #2 : 0}, {link #3 : 1}, {link #4 : 2},
4 :  {link #0 : 5}, {link #1 : 0}, {link #2 : 1}, {link #3 : 2}, {link #4 : 3},
5 :  {link #0 : 0}, {link #1 : 1}, {link #2 : 2}, {link #3 : 3}, {link #4 : 4},
0 : local 98, cpu 10 {link #0 : g1 11}, {link #1 : g2 11}, {link #2 : g3 11}, {link #3 : g4 11}, {link #4 : g5 11},
1 : local 98, cpu 10 {link #0 : g2 11}, {link #1 : g3 11}, {link #2 : g4 11}, {link #3 : g5 11}, {link #4 : g0 11},
2 : local 98, cpu 10 {link #0 : g3 11}, {link #1 : g4 11}, {link #2 : g5 11}, {link #3 : g0 11}, {link #4 : g1 11},
3 : local 98, cpu 10 {link #0 : g4 11}, {link #1 : g5 11}, {link #2 : g0 11}, {link #3 : g1 11}, {link #4 : g2 11},
4 : local 98, cpu 10 {link #0 : g5 11}, {link #1 : g0 11}, {link #2 : g1 11}, {link #3 : g2 11}, {link #4 : g3 11},
5 : local 98, cpu 10 {link #0 : g0 11}, {link #1 : g1 11}, {link #2 : g2 11}, {link #3 : g3 11}, {link #4 : g4 11},
0 :  {link #0 : 1}, {link #1 : 2}, {link #2 : 3}, {link #3 : 4}, {link #4 : 5},
1 :  {link #0 : 2}, {link #1 : 3}, {link #2 : 4}, {link #3 : 5}, {link #4 : 0},
2 :  {link #0 : 3}, {link #1 : 4}, {link #2 : 5}, {link #3 : 0}, {link #4 : 1},
3 :  {link #0 : 4}, {link #1 : 5}, {link #2 : 0}, {link #3 : 1}, {link #4 : 2},
4 :  {link #0 : 5}, {link #1 : 0}, {link #2 : 1}, {link #3 : 2}, {link #4 : 3},
5 :  {link #0 : 0}, {link #1 : 1}, {link #2 : 2}, {link #3 : 3}, {link #4 : 4},
0 : local 98, cpu 10 {link #0 : g1 11}, {link #1 : g2 11}, {link #2 : g3 11}, {link #3 : g4 11}, {link #4 : g5 11},
1 : local 98, cpu 10 {link #0 : g2 11}, {link #1 : g3 11}, {link #2 : g4 11}, {link #3 : g5 11}, {link #4 : g0 11},
2 : local 98, cpu 10 {link #0 : g3 11}, {link #1 : g4 11}, {link #2 : g5 11}, {link #3 : g0 11}, {link #4 : g1 11},
3 : local 98, cpu 10 {link #0 : g4 11}, {link #1 : g5 11}, {link #2 : g0 11}, {link #3 : g1 11}, {link #4 : g2 11},
4 : local 98, cpu 10 {link #0 : g5 11}, {link #1 : g0 11}, {link #2 : g1 11}, {link #3 : g2 11}, {link #4 : g3 11},
5 : local 98, cpu 10 {link #0 : g0 11}, {link #1 : g1 11}, {link #2 : g2 11}, {link #3 : g3 11}, {link #4 : g4 11},
0 :  {link #0 : 1}, {link #1 : 2}, {link #2 : 3}, {link #3 : 4}, {link #4 : 5},
1 :  {link #0 : 2}, {link #1 : 3}, {link #2 : 4}, {link #3 : 5}, {link #4 : 0},
2 :  {link #0 : 3}, {link #1 : 4}, {link #2 : 5}, {link #3 : 0}, {link #4 : 1},
3 :  {link #0 : 4}, {link #1 : 5}, {link #2 : 0}, {link #3 : 1}, {link #4 : 2},
4 :  {link #0 : 5}, {link #1 : 0}, {link #2 : 1}, {link #3 : 2}, {link #4 : 3},
5 :  {link #0 : 0}, {link #1 : 1}, {link #2 : 2}, {link #3 : 3}, {link #4 : 4},
0 : local 98, cpu 10 {link #0 : g1 11}, {link #1 : g2 11}, {link #2 : g3 11}, {link #3 : g4 11}, {link #4 : g5 11},
1 : local 98, cpu 10 {link #0 : g2 11}, {link #1 : g3 11}, {link #2 : g4 11}, {link #3 : g5 11}, {link #4 : g0 11},
2 : local 98, cpu 10 {link #0 : g3 11}, {link #1 : g4 11}, {link #2 : g5 11}, {link #3 : g0 11}, {link #4 : g1 11},
3 : local 98, cpu 10 {link #0 : g4 11}, {link #1 : g5 11}, {link #2 : g0 11}, {link #3 : g1 11}, {link #4 : g2 11},
4 : local 98, cpu 10 {link #0 : g5 11}, {link #1 : g0 11}, {link #2 : g1 11}, {link #3 : g2 11}, {link #4 : g3 11},
5 : local 98, cpu 10 {link #0 : g0 11}, {link #1 : g1 11}, {link #2 : g2 11}, {link #3 : g3 11}, {link #4 : g4 11},
0 : local 98, cpu 10 {link #0 : g1 11}, {link #1 : g2 11}, {link #2 : g3 11}, {link #3 : g4 11}, {link #4 : g5 11},
1 : local 98, cpu 10 {link #0 : g2 11}, {link #1 : g3 11}, {link #2 : g4 11}, {link #3 : g5 11}, {link #4 : g0 11},
2 : local 98, cpu 10 {link #0 : g3 11}, {link #1 : g4 11}, {link #2 : g5 11}, {link #3 : g0 11}, {link #4 : g1 11},
3 : local 98, cpu 10 {link #0 : g4 11}, {link #1 : g5 11}, {link #2 : g0 11}, {link #3 : g1 11}, {link #4 : g2 11},
4 : local 98, cpu 10 {link #0 : g5 11}, {link #1 : g0 11}, {link #2 : g1 11}, {link #3 : g2 11}, {link #4 : g3 11},
5 : local 98, cpu 10 {link #0 : g0 11}, {link #1 : g1 11}, {link #2 : g2 11}, {link #3 : g3 11}, {link #4 : g4 11},
0 :  {link #0 : 1}, {link #1 : 2}, {link #2 : 3}, {link #3 : 4}, {link #4 : 5},
1 :  {link #0 : 2}, {link #1 : 3}, {link #2 : 4}, {link #3 : 5}, {link #4 : 0},
2 :  {link #0 : 3}, {link #1 : 4}, {link #2 : 5}, {link #3 : 0}, {link #4 : 1},
3 :  {link #0 : 4}, {link #1 : 5}, {link #2 : 0}, {link #3 : 1}, {link #4 : 2},
4 :  {link #0 : 5}, {link #1 : 0}, {link #2 : 1}, {link #3 : 2}, {link #4 : 3},
5 :  {link #0 : 0}, {link #1 : 1}, {link #2 : 2}, {link #3 : 3}, {link #4 : 4},
0 : local 98, cpu 10 {link #0 : g1 11}, {link #1 : g2 11}, {link #2 : g3 11}, {link #3 : g4 11}, {link #4 : g5 11},
1 : local 98, cpu 10 {link #0 : g2 11}, {link #1 : g3 11}, {link #2 : g4 11}, {link #3 : g5 11}, {link #4 : g0 11},
2 : local 98, cpu 10 {link #0 : g3 11}, {link #1 : g4 11}, {link #2 : g5 11}, {link #3 : g0 11}, {link #4 : g1 11},
3 : local 98, cpu 10 {link #0 : g4 11}, {link #1 : g5 11}, {link #2 : g0 11}, {link #3 : g1 11}, {link #4 : g2 11},
4 : local 98, cpu 10 {link #0 : g5 11}, {link #1 : g0 11}, {link #2 : g1 11}, {link #3 : g2 11}, {link #4 : g3 11},
5 : local 98, cpu 10 {link #0 : g0 11}, {link #1 : g1 11}, {link #2 : g2 11}, {link #3 : g3 11}, {link #4 : g4 11},
Set parameter WLSAccessID
Set parameter WLSSecret
Set parameter LicenseID
Set parameter TimeLimit to value 200
Set parameter MIPGap to value 0.05
Set parameter LogFile to value "cppsolver.log"
Set parameter Threads to value 40
Academic license - for non-commercial use only - registered to xiaoniu.sxn@sjtu.edu.cn
Gurobi Optimizer version 9.5.1 build v9.5.1rc2 (linux64)
Thread count: 56 physical cores, 112 logical processors, using up to 40 threads
Academic license - for non-commercial use only - registered to xiaoniu.sxn@sjtu.edu.cn
Optimize a model with 225486 rows, 44851 columns and 596352 nonzeros
Model fingerprint: 0xab4be1ef
Variable types: 7 continuous, 44844 integer (44844 binary)
Coefficient statistics:
  Matrix range     [2e-09, 6e+03]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 1e+04]
Warning: Model contains large matrix coefficient range
         Consider reformulating model or setting NumericFocus parameter
         to avoid numerical issues.
Found heuristic solution: objective 57695.544169
Presolve removed 181810 rows and 5 columns
Presolve time: 0.47s
Presolved: 43676 rows, 44846 columns, 212085 nonzeros
Variable types: 1 continuous, 44845 integer (44844 binary)

Deterministic concurrent LP optimizer: primal and dual simplex
Showing first log only...


Use crossover to convert LP symmetric solution to basic solution...
Concurrent spin time: 0.00s

Solved with dual simplex

Root relaxation: objective 1.425838e+03, 14817 iterations, 0.21 seconds (0.26 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 1425.83754    0   50 57695.5442 1425.83754  97.5%     -    1s
H    0     0                    1425.8375371 1425.83754  0.00%     -    1s
     0     0 1425.83754    0   50 1425.83754 1425.83754  0.00%     -    1s

Explored 1 nodes (29143 simplex iterations) in 1.09 seconds (1.64 work units)
Thread count was 40 (of 112 available processors)

Solution count 2: 1425.84 57695.5 

Optimal solution found (tolerance 5.00e-02)
Best objective 1.425837537070e+03, best bound 1.425837537070e+03, gap 0.0000%
coll_cache:optimal_local_rate=0.7259,0.737197,0.74121,0.738573,0.74044,0.732801,
coll_cache:optimal_remote_rate=0.2741,0.262803,0.25879,0.261427,0.25956,0.267199,
coll_cache:optimal_cpu_rate=1.41803e-09,1.41803e-09,1.41803e-09,1.41803e-09,1.41803e-09,1.41803e-09,
z=1425.84
test_result:init:feat_nbytes=375030526464
test_result:init:cache_nbytes=67880524800
test_result:init:feat_nbytes=375030526464
test_result:init:cache_nbytes=67880524800
test_result:init:feat_nbytes=375030526464
test_result:init:cache_nbytes=67880524800
test_result:init:feat_nbytes=375030526464
test_result:init:cache_nbytes=67880524800
test_result:init:feat_nbytes=375030526464
test_result:init:cache_nbytes=67880524800
test_result:init:feat_nbytes=375030526464
test_result:init:cache_nbytes=67880524800
[Train  Worker 2/6] Started with PID 11481(NVIDIA A100-SXM4-80GB)
[Train  Worker 2] run train for 4 epochs with 1002 steps
[Train  Worker 3/6] Started with PID 11486(NVIDIA A100-SXM4-80GB)
[Train  Worker 3] run train for 4 epochs with 1002 steps
[Train  Worker 4/6] Started with PID 11489(NVIDIA A100-SXM4-80GB)
[Train  Worker 4] run train for 4 epochs with 1002 steps
[Train  Worker 5/6] Started with PID 11492(NVIDIA A100-SXM4-80GB)
[Train  Worker 5] run train for 4 epochs with 1002 steps
[Train  Worker 1/6] Started with PID 11479(NVIDIA A100-SXM4-80GB)
[Train  Worker 1] run train for 4 epochs with 1002 steps
[CUDA] cuda0: usage: 73.63 GB
[SAM] cuda0 data alloc        : 0.00 Bytes
[SAM] cuda0 workspace         : 3.04 GB
[SAM] cuda0 workspace reserve : 1.51 GB
[SAM] cuda0 total             : 3.04 GB
[Train  Worker 0/6] Started with PID 11477(NVIDIA A100-SXM4-80GB)
[Train  Worker 0] run train for 4 epochs with 1002 steps
Epoch 00000 | Epoch Time 5.9797 | Total Train Time(Profiler) 3.5595 | Copy Time 2.4073
[CUDA] cuda0: usage: 73.63 GB
[SAM] cuda0 data alloc        : 0.00 Bytes
[SAM] cuda0 workspace         : 3.04 GB
[SAM] cuda0 workspace reserve : 1.51 GB
[SAM] cuda0 total             : 3.04 GB
Epoch 00001 | Epoch Time 5.1265 | Total Train Time(Profiler) 1.7713 | Copy Time 3.3431
[CUDA] cuda0: usage: 73.63 GB
[SAM] cuda0 data alloc        : 0.00 Bytes
[SAM] cuda0 workspace         : 3.04 GB
[SAM] cuda0 workspace reserve : 1.51 GB
[SAM] cuda0 total             : 3.04 GB
Epoch 00002 | Epoch Time 4.1213 | Total Train Time(Profiler) 1.7631 | Copy Time 2.3461
[CUDA] cuda0: usage: 73.63 GB
[SAM] cuda0 data alloc        : 0.00 Bytes
[SAM] cuda0 workspace         : 3.04 GB
[SAM] cuda0 workspace reserve : 1.51 GB
[SAM] cuda0 total             : 3.04 GB
Epoch 00003 | Epoch Time 4.0622 | Total Train Time(Profiler) 1.7649 | Copy Time 2.2863
[Train  Worker 5] Avg Epoch Time 4.4368 | Train Total Time(Profiler) 1.7707 | Copy Time 2.6545
[Train  Worker 4] Avg Epoch Time 4.4367 | Train Total Time(Profiler) 1.7634 | Copy Time 2.6630
[Train  Worker 3] Avg Epoch Time 4.4369 | Train Total Time(Profiler) 1.7664 | Copy Time 2.6596
[Train  Worker 1] Avg Epoch Time 4.4368 | Train Total Time(Profiler) 1.7701 | Copy Time 2.6561
[Train  Worker 0] Avg Epoch Time 4.4367 | Train Total Time(Profiler) 1.7664 | Copy Time 2.6585
[Train  Worker 2] Avg Epoch Time 4.4367 | Train Total Time(Profiler) 1.7704 | Copy Time 2.6558
[Sample Worker 1/2] Started with PID 11474(NVIDIA A100-SXM4-80GB)
[Sample Worker 1] run sample for 4 epochs with 501 steps
[Sample Worker 1] Avg Sample Total Time 1.1930 | Sampler Total Time(Profiler) 1.1890
    [Step(average) Profiler Level 1 E3 S500]
        L1  sample           0.001588 | send           0.000797
        L1  recv             0.003634 | copy           0.016365 | convert time 0.000338 | train  0.010249
        L1  feature nbytes    1.36 GB | label nbytes   15.62 KB
        L1  id nbytes      0.00 Bytes | graph nbytes    8.41 MB
        L1  miss nbytes      22.63 MB | remote nbytes  360.36 MB
        L1  num nodes          953757 | num samples     1098711
    [Step(average) Profiler Level 2 E3 S500]
        L2  shuffle     0.000072 | core sample  0.000572 | id remap        0.000729
        L2  graph copy  0.000003 | id copy      0.000000 | cache feat copy 0.012727
        L2  last layer sample time 0.000279 | size 49771.668530
    [Step(average) Profiler Level 3 E3 S500]
        L3  khop sample coo  0.000320 | khop sort coo      0.000000 | khop count edge     0.000035 | khop compact edge 0.000168
        L3  walk sample coo  0.000000 | walk topk total    0.000000 | walk topk step1     0.000000 | walk topk step2   0.000000
        L3  walk topk step3  0.000000 | walk topk step4    0.000000 | walk topk step5     0.000000
        L3  walk topk step6  0.000000 | walk topk step7    0.000000
        L3  remap unique     0.000208 | remap populate     0.000595 | remap mapnode       0.000000 | remap mapedge     0.000150
        L3  cache get_index  0.000364 | cache copy_index   0.000000 | cache extract_miss  0.000000
        L3  cache copy_miss  0.000000 | cache combine_miss 0.005233 | cache combine cache 0.001254 | cache combine remote 0.010554
        L3  label extract  0.000027
    [Init Profiler Level 1]
        L1  init     8.6435 | sampler init    56.2610 | trainer init 0.0000
    [Init Profiler Level 2]
        L2  load ds        10.5610 | init queue          44.5908
        L2  presample       7.9659 | build interal ds     1.7856
        L2  build cache     0.0000
    [Init Profiler Level 3]
        L3  load dataset: mmap     8.6423 | copy         1.9187
        L3  dist queue: alloc      0.0003 | pin         44.5905 | push     0.0000
        L3  presample: init        0.2815
        L3  presample: sample      3.0946 | copy         0.3165
        L3  presample: count       2.6569 | sort         0.3093
        L3  presample: reset       0.0011 | get rank     0.0252
        L3  internal: cuda ctx     1.5672 | cuda stream     0.2079
[Sample Worker 0/2] Started with PID 11471(NVIDIA A100-SXM4-80GB)
[Sample Worker 0] run sample for 4 epochs with 501 steps
[Sample Worker 0] Avg Sample Total Time 1.1908 | Sampler Total Time(Profiler) 1.1807
test_result:sample_time=0.7893
test_result:get_cache_miss_index_time=0.0000
test_result:enqueue_samples_time=0.3914
test_result:epoch_time:sample_total=1.1908
[CUDA] cuda0: usage: 73.63 GB
[SAM] cuda0 data alloc        : 0.00 Bytes
[SAM] cuda0 workspace         : 3.04 GB
[SAM] cuda0 workspace reserve : 1.51 GB
[SAM] cuda0 total             : 3.04 GB
    [Step(average) Profiler Level 1 E3 S1001]
        L1  sample           0.001588 | send           0.000777
        L1  recv             0.003201 | copy           0.015916 | convert time 0.000338 | train  0.010248
        L1  feature nbytes    1.36 GB | label nbytes   15.62 KB
        L1  id nbytes      0.00 Bytes | graph nbytes    8.41 MB
        L1  miss nbytes      22.65 MB | remote nbytes  360.43 MB
        L1  num nodes          953725 | num samples     1098668
        L1  seq duration     0.000000 | refresh duration   0.000000
    [Step(average) Profiler Level 2 E3 S1001]
        L2  shuffle     0.000070 | core sample  0.000572 | id remap        0.000730
        L2  graph copy  0.000003 | id copy      0.000000 | cache feat copy 0.012712
        L2  last layer sample time 0.000279 | size 49770.641597
    [Step(average) Profiler Level 3 E3 S1001]
        L3  khop sample coo  0.000320 | khop sort coo      0.000000 | khop count edge     0.000035 | khop compact edge 0.000168
        L3  walk sample coo  0.000000 | walk topk total    0.000000 | walk topk step1     0.000000 | walk topk step2   0.000000
        L3  walk topk step3  0.000000 | walk topk step4    0.000000 | walk topk step5     0.000000
        L3  walk topk step6  0.000000 | walk topk step7    0.000000
        L3  remap unique     0.000209 | remap populate     0.000596 | remap mapnode       0.000000 | remap mapedge     0.000150
        L3  cache get_index  0.000365 | cache copy_index   0.000000 | cache extract_miss  0.000000
        L3  cache copy_miss  0.000000 | cache combine_miss 0.005237 | cache combine cache 0.001255 | cache combine remote 0.010557
        L3  label extract  0.000027
    [Step(max) Profiler Level 1 E3 S1001]
        L1  sample           0.043710 | send           0.005892
        L1  recv             0.188023 | copy           0.200749 | convert time 0.002672 | train  0.014925
        L1  feature nbytes    1.40 GB | label nbytes   15.62 KB
        L1  id nbytes      0.00 Bytes | graph nbytes    8.62 MB
        L1  miss nbytes      23.95 MB | remote nbytes  383.11 MB
        L1  num nodes          979797 | num samples     1126263
    [Step(max) Profiler Level 2 E3 S1001]
        L2  shuffle     0.041804 | core sample  0.002480 | id remap        0.002628
        L2  graph copy  0.000049 | id copy      0.000000 | cache feat copy 0.027555
        L2  last layer sample time 0.000712 | size 50790.000000
    [Step(max) Profiler Level 3 E3 S1001]
        L3  khop sample coo  0.002093 | khop sort coo      0.000000 | khop count edge     0.000064 | khop compact edge 0.002000
        L3  walk sample coo  0.000000 | walk topk total    0.000000 | walk topk step1     0.000000 | walk topk step2   0.000000
        L3  walk topk step3  0.000000 | walk topk step4    0.000000 | walk topk step5     0.000000
        L3  walk topk step6  0.000000 | walk topk step7    0.000000
        L3  remap unique     0.001334 | remap populate     0.002489 | remap mapnode       0.000000 | remap mapedge     0.000186
        L3  cache get_index  0.002814 | cache copy_index   0.000000 | cache extract_miss  0.000000
        L3  cache copy_miss  0.000000 | cache combine_miss 0.009742 | cache combine cache 0.002307 | cache combine remote 0.011676
        L3  label extract  0.000459
    [Step(min) Profiler Level 1 E3 S1001]
        L1  sample           0.001453 | send           0.000501
        L1  recv             0.000578 | copy           0.012956 | convert time 0.000308 | train  0.010062
        L1  feature nbytes    1.33 GB | label nbytes   15.62 KB
        L1  id nbytes      0.00 Bytes | graph nbytes    8.18 MB
        L1  miss nbytes      21.53 MB | remote nbytes  343.78 MB
        L1  num nodes          926987 | num samples     1068080
    [Step(min) Profiler Level 2 E3 S1001]
        L2  shuffle     0.000012 | core sample  0.000538 | id remap        0.000686
        L2  graph copy  0.000003 | id copy      0.000000 | cache feat copy 0.012003
        L2  last layer sample time 0.000259 | size 48922.000000
    [Step(min) Profiler Level 3 E3 S1001]
        L3  khop sample coo  0.000302 | khop sort coo      0.000000 | khop count edge     0.000032 | khop compact edge 0.000154
        L3  walk sample coo  0.000000 | walk topk total    0.000000 | walk topk step1     0.000000 | walk topk step2   0.000000
        L3  walk topk step3  0.000000 | walk topk step4    0.000000 | walk topk step5     0.000000
        L3  walk topk step6  0.000000 | walk topk step7    0.000000
        L3  remap unique     0.000194 | remap populate     0.000559 | remap mapnode       0.000000 | remap mapedge     0.000137
        L3  cache get_index  0.000349 | cache copy_index   0.000000 | cache extract_miss  0.000000
        L3  cache copy_miss  0.000000 | cache combine_miss 0.004829 | cache combine cache 0.000668 | cache combine remote 0.009866
        L3  label extract  0.000015
    [Init Profiler Level 1]
        L1  init     8.6435 | sampler init     0.0000 | trainer init 83.2416
    [Init Profiler Level 2]
        L2  load ds         8.6423 | init queue          44.4104
        L2  presample       0.0000 | build interal ds     1.3600
        L2  build cache    37.4672
    [Init Profiler Level 3]
        L3  load dataset: mmap     8.6423 | copy         0.0000
        L3  dist queue: alloc      0.0003 | pin         44.4100 | push     0.0000
        L3  presample: init        0.0000
        L3  presample: sample      0.0000 | copy         0.0000
        L3  presample: count       0.0000 | sort         0.0000
        L3  presample: reset       0.0000 | get rank     0.0000
        L3  internal: cuda ctx     1.3600 | cuda stream     0.0001
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   35529 KB |  646252 KB |    1186 GB |    1186 GB |
|       from large pool |   26250 KB |  643318 KB |    1177 GB |    1177 GB |
|       from small pool |    9279 KB |   11604 KB |       8 GB |       8 GB |
|---------------------------------------------------------------------------|
| Active memory         |   35530 KB |  646252 KB |    1186 GB |    1186 GB |
|       from large pool |   26250 KB |  643318 KB |    1177 GB |    1177 GB |
|       from small pool |    9279 KB |   11604 KB |       8 GB |       8 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |     768 MB |     768 MB |     768 MB |       0 B  |
|       from large pool |     752 MB |     752 MB |     752 MB |       0 B  |
|       from small pool |      16 MB |      16 MB |      16 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   46390 KB |  648167 KB |     937 GB |     937 GB |
|       from large pool |   43381 KB |  646423 KB |     926 GB |     926 GB |
|       from small pool |    3008 KB |    5577 KB |      10 GB |      10 GB |
|---------------------------------------------------------------------------|
| Allocations           |      43    |      62    |   97568    |   97525    |
|       from large pool |       7    |      18    |   38079    |   38072    |
|       from small pool |      36    |      47    |   59489    |   59453    |
|---------------------------------------------------------------------------|
| Active allocs         |      44    |      62    |   97568    |   97524    |
|       from large pool |       7    |      18    |   38079    |   38072    |
|       from small pool |      37    |      47    |   59489    |   59452    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      17    |      17    |      17    |       0    |
|       from large pool |       9    |       9    |       9    |       0    |
|       from small pool |       8    |       8    |       8    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      17    |      28    |   43899    |   43882    |
|       from large pool |       3    |      13    |   25943    |   25940    |
|       from small pool |      14    |      23    |   17956    |   17942    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

test_result:epoch_time:copy_time=2.6585
test_result:convert_time=0.0564
test_result:train_time=1.7101
test_result:epoch_time:train_total=1.7664
test_result:cache_percentage=0.1800
test_result:cache_hit_rate=1.0000
test_result:run_time=24.0781

