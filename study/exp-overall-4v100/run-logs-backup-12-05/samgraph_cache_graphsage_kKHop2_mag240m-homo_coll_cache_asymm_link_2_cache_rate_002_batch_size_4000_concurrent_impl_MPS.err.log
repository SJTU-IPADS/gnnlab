[2022-12-08 19:14:51.697187: W /samgraph/samgraph/common/cpu/mmap_cpu_device.cc:92] mmap allocating space 12.87 GB
[2022-12-08 19:14:51.697286: W /samgraph/samgraph/common/cpu/mmap_cpu_device.cc:97] mmap allocating space 12.87 GB done
[2022-12-08 19:14:56.926554: W /samgraph/samgraph/common/cpu/mmap_cpu_device.cc:92] mmap allocating space 48.00 GB
[2022-12-08 19:14:56.926665: W /samgraph/samgraph/common/cpu/mmap_cpu_device.cc:97] mmap allocating space 48.00 GB done
[2022-12-08 19:14:56.926708: W /samgraph/samgraph/common/cpu/mmap_cpu_device.cc:92] mmap allocating space 1.82 GB
[2022-12-08 19:14:56.926742: W /samgraph/samgraph/common/cpu/mmap_cpu_device.cc:97] mmap allocating space 1.82 GB done
[2022-12-08 19:14:56.930895: W /samgraph/samgraph/common/cpu/mmap_cpu_device.cc:92] mmap allocating space 19.07 GB
[2022-12-08 19:14:56.930945: W /samgraph/samgraph/common/cpu/mmap_cpu_device.cc:97] mmap allocating space 19.07 GB done
/usr/lib/python3/dist-packages/requests/__init__.py:89: RequestsDependencyWarning: urllib3 (1.26.12) or chardet (3.0.4) doesn't match a supported version!
  warnings.warn("urllib3 ({}) or chardet ({}) doesn't match a supported "
[2022-12-08 19:14:57. 85763: W /samgraph/samgraph/common/dist/dist_engine.cc:662] Trainer[1] initializing...
[2022-12-08 19:14:57.120140: W /samgraph/samgraph/common/dist/dist_engine.cc:662] Trainer[0] initializing...
[2022-12-08 19:14:57.127723: W /samgraph/samgraph/common/dist/dist_engine.cc:662] Trainer[2] initializing...
[2022-12-08 19:14:58.583079: W /samgraph/samgraph/common/dist/dist_engine.cc:666] Trainer[1] pin memory queue...
[[2022-12-08 19:14:58.6008472022-12-08 19:14:58: .W600856 : /samgraph/samgraph/common/dist/dist_engine.ccW: 666/samgraph/samgraph/common/dist/dist_engine.cc] :Trainer[0] pin memory queue...666
] Trainer[2] pin memory queue...
[2022-12-08 19:15:05. 92719: E /samgraph/samgraph/common/dist/dist_engine.cc:85] Running on V100
[2022-12-08 19:15:05. 93053: W /samgraph/samgraph/common/dist/dist_engine.cc:701] Trainer[0] register host memory...
[2022-12-08 19:15:05. 97746: E /samgraph/samgraph/common/dist/dist_engine.cc:85] Running on V100
[2022-12-08 19:15:05. 97886: W /samgraph/samgraph/common/dist/dist_engine.cc:701] Trainer[1] register host memory...
[2022-12-08 19:15:05. 98327: E /samgraph/samgraph/common/dist/dist_engine.cc:85] Running on V100
[2022-12-08 19:15:05. 98435: W /samgraph/samgraph/common/dist/dist_engine.cc:701] Trainer[2] register host memory...
[2022-12-08 19:15:05.338731: E /samgraph/samgraph/common/dist/dist_engine.cc:85] Running on V100
[2022-12-08 19:15:05.342982: W /samgraph/samgraph/common/cuda/cuda_device.cc:49] GPU[3] alloc cuda memory 931.40 MB
[2022-12-08 19:15:05.569788: W /samgraph/samgraph/common/cuda/cuda_device.cc:49] GPU[3] alloc cuda memory 12.87 GB
[2022-12-08 19:15:08.595815: W /samgraph/samgraph/common/cuda/cuda_device.cc:49] GPU[3] alloc cuda memory 64.00 MB
[2022-12-08 19:15:08.599380: E /samgraph/samgraph/common/dist/pre_sampler.cc:41] Dist Presampler making shuffler...
[2022-12-08 19:15:08.602614: E /samgraph/samgraph/common/dist/pre_sampler.cc:44] Dist Presampler making shuffler...Done
[2022-12-08 19:15:08.602660: W /samgraph/samgraph/common/cpu/cpu_device.cc:39] WORKER[0] alloc host memory 1.82 GB
[2022-12-08 19:15:09.247230: E /samgraph/samgraph/common/dist/pre_sampler.cc:85] Dist Presampler doing presample epoch 0
[2022-12-08 19:15:10.410043: E /samgraph/samgraph/common/dist/pre_sampler.cc:129] presample spend 0.660839 on sample, 0.0534165 on copy, 0.445909 on count
[2022-12-08 19:15:10.410127: E /samgraph/samgraph/common/dist/pre_sampler.cc:85] Dist Presampler doing presample epoch 1
[2022-12-08 19:15:11.686363: E /samgraph/samgraph/common/dist/pre_sampler.cc:129] presample spend 1.31095 on sample, 0.105351 on copy, 1.01761 on count
[2022-12-08 19:15:11.686489: E /samgraph/samgraph/common/dist/pre_sampler.cc:136] max_num_inputs = 586908, min_num_inputs = 564549
[2022-12-08 19:15:12.250590: E /samgraph/samgraph/common/dist/pre_sampler.cc:148] presample spend 0.563969 on sort freq.
[2022-12-08 19:15:12.979877: E /samgraph/samgraph/common/dist/dist_engine.cc:524] pre sample done, delete it
[[2022-12-08 19:15:13.2022-12-08 19:15:13 44700.:  44707[W:  2022-12-08 19:15:13W/samgraph/samgraph/common/dist/dist_engine.cc. :/samgraph/samgraph/common/dist/dist_engine.cc 44727711:: ] 711WTrainer[2] building cache...]  
Trainer[0] building cache.../samgraph/samgraph/common/dist/dist_engine.cc
:711] Trainer[1] building cache...
[2022-12-08 19:15:13. 45594: E /samgraph/3rdparty/collcachelib/coll_cache_lib/run_config.cc:134] using concurrent impl MPS
[[2022-12-08 19:15:132022-12-08 19:15:13.. 45881 45891: : [EE2022-12-08 19:15:13  ./samgraph/3rdparty/collcachelib/coll_cache_lib/run_config.cc/samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc 45931::134: 200] E] using concurrent impl MPS build symm link desc with 3X Tesla V100-SXM2-16GB out of 4
/samgraph/3rdparty/collcachelib/coll_cache_lib/run_config.cc
:134] [using concurrent impl MPS2022-12-08 19:15:13
. 46088: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:201] remote time is 8.68421
[2022-12-08 19:15:13. 46128: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:202] cpu time is 30
[2022-12-08 19:15:13. 46832: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:200] build symm link desc with 3X Tesla V100-SXM2-16GB out of 4
[2022-12-08 19:15:13. 46936: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:201] remote time is 8.68421
[2022-12-08 19:15:13. 47012: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:202] cpu time is 30
[2022-12-08 19:15:13. 49628: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:200] build symm link desc with 3X Tesla V100-SXM2-16GB out of 4
[2022-12-08 19:15:13. 49822: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:201] remote time is 8.68421
[2022-12-08 19:15:13. 49900: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:202] cpu time is 30
[2022-12-08 19:15:27.407934: E /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:118] solver created. now build & solve
[2022-12-08 19:15:27.511846: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cpu/cpu_device.cc:39] WORKER[0] alloc host memory 931.40 MB
[2022-12-08 19:15:27.511915: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cpu/cpu_device.cc:39] WORKER[0] alloc host memory 931.40 MB
[2022-12-08 19:15:27.512736: W /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:68] mapping nid to rank...
[2022-12-08 19:15:27.905349: W /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:85] counting slots...
[2022-12-08 19:15:29. 82095: W /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:99] Final num slot is 24
[2022-12-08 19:15:29. 82186: W /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:103] counting blocks...
[2022-12-08 19:15:47.389156: W /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:112] Final num block is 1012
[2022-12-08 19:15:47.389245: W /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:117] counting freq and density...
[2022-12-08 19:15:50.856218: W /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:148] averaging freq and density...
[2022-12-08 19:15:50.856320: W /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:149] 1012
[2022-12-08 19:15:50.860391: E /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:123] solver built. now solve
[2022-12-08 19:15:50.860438: W /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:348] constructing optimal solver, device=3, stream=1
1012 blocks, 3 devices
[2022-12-08 19:15:51.940020: W /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:503] Add Var...
[2022-12-08 19:15:51.953856: W /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:521] Capacity...
[2022-12-08 19:15:51.954504: W /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:524] Connect CPU...
[2022-12-08 19:15:51.961630: W /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:526] Connect Access To Storage...
[2022-12-08 19:15:51.998075: W /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:530] Time...
[2022-12-08 19:15:54.127040: W /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:545] Coll Cache init block placement array
[2022-12-08 19:15:54.130132: W /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:621] Coll Cache init block placement array done
[2022-12-08 19:15:54.130419: W /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:623] Coll Cache model reset done
[2022-12-08 19:15:54.136125: E /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:127] solver solved
[2022-12-08 19:15:54.136181: E /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:195] 0 solved master
[2022-12-08 19:15:54.136226: E /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:202] 0 solved
[2022-12-08 19:15:54.136254: E /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 0 initing device 0
[2022-12-08 19:15:54.137602: E /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:1766] Building Coll Cache with ... num gpu device is 3
[2022-12-08 19:15:54.180147: E /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:202] 1 solved
[2022-12-08 19:15:54.180235: E /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:205] worker 1 thread 1 initing device 1
[2022-12-08 19:15:54.181568: E /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:202] 2 solved
[2022-12-08 19:15:54.181664: E /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:205] worker 2 thread 2 initing device 2
[2022-12-08 19:15:54.183103: E /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:1766] Building Coll Cache with ... num gpu device is 3
[2022-12-08 19:15:54.183388: E /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:1766] Building Coll Cache with ... num gpu device is 3
[2022-12-08 19:15:54.327467: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:1806] using empty feat=25
[2022-12-08 19:15:54.367187: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:1806] using empty feat=25
[2022-12-08 19:15:54.374845: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cpu/cpu_device.cc:39] WORKER[0] alloc host memory 18.62 MB
[2022-12-08 19:15:54.417444: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:1806] using empty feat=25
[[[2022-12-08 19:15:552022-12-08 19:15:552022-12-08 19:15:55... 62474 62472 62472: : : EEE   /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu/samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu/samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:::187718771877] ] ] Device 1 init p2p of link 2Device 2 init p2p of link 0Device 0 init p2p of link 1


[2022-12-08 19:15:55. 72162: E /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:1877] Device 1 init p2p of link 0
[2022-12-08 19:15:55. 72266: E /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:1877] Device 0 init p2p of link 2
[2022-12-08 19:15:55. 72387: E /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:1877] Device 2 init p2p of link 1
[2022-12-08 19:15:55. 78911: E /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:1906] Asymm Coll cache (policy: coll_cache_asymm_link) | local 4870518 / 244160499 nodes ( 1.99 %~2.00 %) | remote 7252264 / 244160499 nodes ( 2.97 %) | cpu 232037717 / 244160499 nodes ( 95.03 %) | 7.00 GB | 0.895465 secs 
[2022-12-08 19:15:55. 79138: E /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:1906] Asymm Coll cache (policy: coll_cache_asymm_link) | local 4882059 / 244160499 nodes ( 2.00 %~2.00 %) | remote 7240723 / 244160499 nodes ( 2.97 %) | cpu 232037717 / 244160499 nodes ( 95.03 %) | 7.02 GB | 0.941494 secs 
[2022-12-08 19:15:55. 79263: E /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:1906] Asymm Coll cache (policy: coll_cache_asymm_link) | local 4878913 / 244160499 nodes ( 2.00 %~2.00 %) | remote 7243869 / 244160499 nodes ( 2.97 %) | cpu 232037717 / 244160499 nodes ( 95.03 %) | 7.01 GB | 0.896112 secs 
[2022-12-08 19:15:55. 79481: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:2010] before create ctx, mem is 9.67 GB
[2022-12-08 19:15:56.381463: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:2016] after create ctx, mem is 10.16 GB
[2022-12-08 19:15:56.381605: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:2023] after create stream, mem is 10.16 GB
[2022-12-08 19:15:56.381905: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:2010] before create ctx, mem is 10.16 GB
[2022-12-08 19:15:57.593280: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:2016] after create ctx, mem is 10.65 GB
[2022-12-08 19:15:57.593453: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:2023] after create stream, mem is 10.65 GB
[2022-12-08 19:15:57.593676: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:2010] before create ctx, mem is 10.65 GB
[2022-12-08 19:15:58.814642: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:2016] after create ctx, mem is 11.28 GB
[2022-12-08 19:15:58.814782: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:2023] after create stream, mem is 11.28 GB
[2022-12-08 19:15:58.815131: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:2010] before create ctx, mem is 11.28 GB
[2022-12-08 19:15:59.986189: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:2016] after create ctx, mem is 11.66 GB
[2022-12-08 19:15:59.986309: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:2023] after create stream, mem is 11.66 GB
[[2022-12-08 19:16:00.2022-12-08 19:16:00413404.: [413379E:  2022-12-08 19:16:00E/samgraph/3rdparty/collcachelib/coll_cache_lib/run_config.cc. :413399/samgraph/3rdparty/collcachelib/coll_cache_lib/run_config.cc134: :] E134using concurrent impl MPS ] 
/samgraph/3rdparty/collcachelib/coll_cache_lib/run_config.ccusing concurrent impl MPS:
134] using concurrent impl MPS
[2022-12-08 19:16:00.414400: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:200] build symm link desc with 3X Tesla V100-SXM2-16GB out of 4
[2022-12-08 19:16:00.414421: [E2022-12-08 19:16:00 .[/samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc4144462022-12-08 19:16:00.:414447: 200: E] E build symm link desc with 3X Tesla V100-SXM2-16GB out of 4 /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc
/samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc::201200[] ] 2022-12-08 19:16:00remote time is 8.68421build symm link desc with 3X Tesla V100-SXM2-16GB out of 4.

414560[: 2022-12-08 19:16:00E. 414602[/samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc: 2022-12-08 19:16:00:E.201 414614] /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc: remote time is 8.68421:E
202 ] [/samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cccpu time is 302022-12-08 19:16:00:
.201414691] : remote time is 8.68421E
 /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:202[] 2022-12-08 19:16:00cpu time is 30.
414751: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:202] cpu time is 30
[[[2022-12-08 19:16:002022-12-08 19:16:002022-12-08 19:16:00...934082934081934082: : : EEE   /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc/samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc/samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:::202202202] ] ] 0 solved2 solved1 solved


[[2022-12-08 19:16:002022-12-08 19:16:00[..2022-12-08 19:16:00934310934313.: : 934317EE:   E/samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc/samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc ::/samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc205205:] ] 205worker 0 thread 0 initing device 0worker 2 thread 2 initing device 2] 

worker 1 thread 1 initing device 1
[2022-12-08 19:16:02.393585: W /samgraph/samgraph/common/cuda/cuda_device.cc:49] GPU[0] alloc cuda memory 915.02 MB
[2022-12-08 19:16:03.555890: W /samgraph/samgraph/common/cuda/cuda_device.cc:49] GPU[0] alloc cuda memory 915.02 MB
/usr/local/lib/python3.8/dist-packages/torch/nn/parallel/scatter_gather.py:9: UserWarning: is_namedtuple is deprecated, please use the python checks instead
  warnings.warn("is_namedtuple is deprecated, please use the python checks instead")
/usr/local/lib/python3.8/dist-packages/torch/nn/parallel/scatter_gather.py:9: UserWarning: is_namedtuple is deprecated, please use the python checks instead
  warnings.warn("is_namedtuple is deprecated, please use the python checks instead")
/usr/local/lib/python3.8/dist-packages/torch/nn/parallel/scatter_gather.py:9: UserWarning: is_namedtuple is deprecated, please use the python checks instead
  warnings.warn("is_namedtuple is deprecated, please use the python checks instead")
