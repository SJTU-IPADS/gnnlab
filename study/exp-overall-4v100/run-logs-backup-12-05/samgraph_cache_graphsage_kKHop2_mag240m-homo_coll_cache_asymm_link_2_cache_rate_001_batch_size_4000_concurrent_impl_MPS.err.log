[2022-12-08 19:07:06.545376: W /samgraph/samgraph/common/cpu/mmap_cpu_device.cc:92] mmap allocating space 12.87 GB
[2022-12-08 19:07:06.545478: W /samgraph/samgraph/common/cpu/mmap_cpu_device.cc:97] mmap allocating space 12.87 GB done
[2022-12-08 19:07:11.770570: W /samgraph/samgraph/common/cpu/mmap_cpu_device.cc:92] mmap allocating space 48.00 GB
[2022-12-08 19:07:11.770685: W /samgraph/samgraph/common/cpu/mmap_cpu_device.cc:97] mmap allocating space 48.00 GB done
[2022-12-08 19:07:11.770727: W /samgraph/samgraph/common/cpu/mmap_cpu_device.cc:92] mmap allocating space 1.82 GB
[2022-12-08 19:07:11.770760: W /samgraph/samgraph/common/cpu/mmap_cpu_device.cc:97] mmap allocating space 1.82 GB done
[2022-12-08 19:07:11.774948: W /samgraph/samgraph/common/cpu/mmap_cpu_device.cc:92] mmap allocating space 19.07 GB
[2022-12-08 19:07:11.774998: W /samgraph/samgraph/common/cpu/mmap_cpu_device.cc:97] mmap allocating space 19.07 GB done
/usr/lib/python3/dist-packages/requests/__init__.py:89: RequestsDependencyWarning: urllib3 (1.26.12) or chardet (3.0.4) doesn't match a supported version!
  warnings.warn("urllib3 ({}) or chardet ({}) doesn't match a supported "
[2022-12-08 19:07:11.822623: W /samgraph/samgraph/common/dist/dist_engine.cc:662] Trainer[1] initializing...
[2022-12-08 19:07:11.989841: W /samgraph/samgraph/common/dist/dist_engine.cc:662] Trainer[2] initializing...
[2022-12-08 19:07:11.992714: W /samgraph/samgraph/common/dist/dist_engine.cc:662] Trainer[0] initializing...
[2022-12-08 19:07:13.299597: W /samgraph/samgraph/common/dist/dist_engine.cc:666] Trainer[1] pin memory queue...
[2022-12-08 19:07:13.397954: W /samgraph/samgraph/common/dist/dist_engine.cc:666] Trainer[0] pin memory queue...
[2022-12-08 19:07:13.405045: W /samgraph/samgraph/common/dist/dist_engine.cc:666] Trainer[2] pin memory queue...
[2022-12-08 19:07:19.616521: E /samgraph/samgraph/common/dist/dist_engine.cc:85] Running on V100
[2022-12-08 19:07:19.616860: [E2022-12-08 19:07:19 ./samgraph/samgraph/common/dist/dist_engine.cc616908:: 85W]  Running on V100/samgraph/samgraph/common/dist/dist_engine.cc
:701] Trainer[2] register host memory...
[2022-12-08 19:07:19.617263: W /samgraph/samgraph/common/dist/dist_engine.cc:701] Trainer[0] register host memory...
[2022-12-08 19:07:19.621840: E /samgraph/samgraph/common/dist/dist_engine.cc:85] Running on V100
[2022-12-08 19:07:19.621919: W /samgraph/samgraph/common/dist/dist_engine.cc:701] Trainer[1] register host memory...
[2022-12-08 19:07:19.854995: E /samgraph/samgraph/common/dist/dist_engine.cc:85] Running on V100
[2022-12-08 19:07:19.859220: W /samgraph/samgraph/common/cuda/cuda_device.cc:49] GPU[3] alloc cuda memory 931.40 MB
[2022-12-08 19:07:20. 83280: W /samgraph/samgraph/common/cuda/cuda_device.cc:49] GPU[3] alloc cuda memory 12.87 GB
[2022-12-08 19:07:23. 63219: W /samgraph/samgraph/common/cuda/cuda_device.cc:49] GPU[3] alloc cuda memory 64.00 MB
[2022-12-08 19:07:23. 66799: E /samgraph/samgraph/common/dist/pre_sampler.cc:41] Dist Presampler making shuffler...
[2022-12-08 19:07:23. 69973: E /samgraph/samgraph/common/dist/pre_sampler.cc:44] Dist Presampler making shuffler...Done
[2022-12-08 19:07:23. 70018: W /samgraph/samgraph/common/cpu/cpu_device.cc:39] WORKER[0] alloc host memory 1.82 GB
[2022-12-08 19:07:23.711397: E /samgraph/samgraph/common/dist/pre_sampler.cc:85] Dist Presampler doing presample epoch 0
[2022-12-08 19:07:24.944679: E /samgraph/samgraph/common/dist/pre_sampler.cc:129] presample spend 0.656666 on sample, 0.0532963 on copy, 0.520695 on count
[2022-12-08 19:07:24.944809: E /samgraph/samgraph/common/dist/pre_sampler.cc:85] Dist Presampler doing presample epoch 1
[2022-12-08 19:07:26.218302: E /samgraph/samgraph/common/dist/pre_sampler.cc:129] presample spend 1.30969 on sample, 0.10525 on copy, 1.08666 on count
[2022-12-08 19:07:26.218513: E /samgraph/samgraph/common/dist/pre_sampler.cc:136] max_num_inputs = 587394, min_num_inputs = 563745
[2022-12-08 19:07:26.792675: E /samgraph/samgraph/common/dist/pre_sampler.cc:148] presample spend 0.574055 on sort freq.
[2022-12-08 19:07:27.511448: E /samgraph/samgraph/common/dist/dist_engine.cc:524] pre sample done, delete it
[[[2022-12-08 19:07:272022-12-08 19:07:27.2022-12-08 19:07:27.567686567688.: 567692: W: W W /samgraph/samgraph/common/dist/dist_engine.cc/samgraph/samgraph/common/dist/dist_engine.cc ::/samgraph/samgraph/common/dist/dist_engine.cc711711:] ] 711Trainer[1] building cache...Trainer[2] building cache...] 
Trainer[0] building cache...

[2022-12-08 19:07:27.568551: E /samgraph/3rdparty/collcachelib/coll_cache_lib/run_config.cc:134] using concurrent impl MPS
[2022-12-08 19:07:27.568850: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:[2002022-12-08 19:07:27] .[build symm link desc with 3X Tesla V100-SXM2-16GB out of 42022-12-08 19:07:27568857
.: 568874E: [ E2022-12-08 19:07:27/samgraph/3rdparty/collcachelib/coll_cache_lib/run_config.cc ./samgraph/3rdparty/collcachelib/coll_cache_lib/run_config.cc:568932:134: 134] E] using concurrent impl MPS using concurrent impl MPS
/samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc
:201] remote time is 8.68421
[2022-12-08 19:07:27.569036: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:202] cpu time is 30
[2022-12-08 19:07:27.569951: E [/samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc2022-12-08 19:07:27:.200569986] : build symm link desc with 3X Tesla V100-SXM2-16GB out of 4E
 /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:200] build symm link desc with 3X Tesla V100-SXM2-16GB out of 4
[2022-12-08 19:07:27.570083: E[ 2022-12-08 19:07:27/samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc.:570111201: ] Eremote time is 8.68421 
/samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:201] [remote time is 8.684212022-12-08 19:07:27
.570187: [E2022-12-08 19:07:27 ./samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc570221:: 202E]  cpu time is 30/samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc
:202] cpu time is 30
[2022-12-08 19:07:58.501798: E /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:118] solver created. now build & solve
[2022-12-08 19:07:58.605129: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cpu/cpu_device.cc:39] WORKER[0] alloc host memory 931.40 MB
[2022-12-08 19:07:58.605197: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cpu/cpu_device.cc:39] WORKER[0] alloc host memory 931.40 MB
[2022-12-08 19:07:58.606062: W /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:68] mapping nid to rank...
[2022-12-08 19:07:59.190073: W /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:85] counting slots...
[2022-12-08 19:08:00.407012: W /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:99] Final num slot is 24
[2022-12-08 19:08:00.407099: W /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:103] counting blocks...
[2022-12-08 19:08:21.563918: W /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:112] Final num block is 1012
[2022-12-08 19:08:21.564019: W /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:117] counting freq and density...
[2022-12-08 19:08:25.334296: W /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:148] averaging freq and density...
[2022-12-08 19:08:25.334627: W /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:149] 1012
[2022-12-08 19:08:25.447201: E /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:123] solver built. now solve
[2022-12-08 19:08:25.447497: W /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:348] constructing optimal solver, device=3, stream=1
1012 blocks, 3 devices
[2022-12-08 19:08:26.657952: W /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:503] Add Var...
[2022-12-08 19:08:26.676291: W /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:521] Capacity...
[2022-12-08 19:08:26.677465: W /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:524] Connect CPU...
[2022-12-08 19:08:26.688511: W /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:526] Connect Access To Storage...
[2022-12-08 19:08:26.742260: W /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:530] Time...
[2022-12-08 19:08:27.470162: W /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:545] Coll Cache init block placement array
[2022-12-08 19:08:27.474197: W /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:621] Coll Cache init block placement array done
[2022-12-08 19:08:27.474322: W /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:623] Coll Cache model reset done
[2022-12-08 19:08:27.484580: E /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:127] solver solved
[2022-12-08 19:08:27.484676: E /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:195] 0 solved master
[2022-12-08 19:08:27.484738: E /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:202] 0 solved
[2022-12-08 19:08:27.484776: E /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 0 initing device 0
[2022-12-08 19:08:27.493487: E /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:1766] Building Coll Cache with ... num gpu device is 3
[2022-12-08 19:08:27.535687: E /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:202] 1 solved
[2022-12-08 19:08:27.535785: E /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:205] worker 1 thread 1 initing device 1
[2022-12-08 19:08:27.536037: E /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:202] 2 solved
[2022-12-08 19:08:27.536119: E /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:205] worker 2 thread 2 initing device 2
[2022-12-08 19:08:27.537395: E /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:1766] Building Coll Cache with ... num gpu device is 3
[2022-12-08 19:08:27.537690: E /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:1766] Building Coll Cache with ... num gpu device is 3
[2022-12-08 19:08:27.671777: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:1806] using empty feat=25
[[2022-12-08 19:08:272022-12-08 19:08:27..812196812213: W:  W/samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu :/samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu1806:] 1806using empty feat=25] 
using empty feat=25
[[2022-12-08 19:08:282022-12-08 19:08:28..149629149628: : EE  /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu/samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu::18771877] ] Device 2 init p2p of link 0Device 1 init p2p of link 2

[2022-12-08 19:08:28.149631: E /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:1877] Device 0 init p2p of link 1
[2022-12-08 19:08:28.157768: E /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:1877] Device 1 init p2p of link 0
[2022-12-08 19:08:28.157989: E /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:1877] Device 2 init p2p of link 1
[2022-12-08 19:08:28.158816: E /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:1877] Device 0 init p2p of link 2
[2022-12-08 19:08:28.170878: E /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:1906] Asymm Coll cache (policy: coll_cache_asymm_link) | local 2436890 / 244160499 nodes ( 1.00 %~1.00 %) | remote 4869826 / 244160499 nodes ( 1.99 %) | cpu 236853783 / 244160499 nodes ( 97.01 %) | 3.52 GB | 0.63343 secs 
[2022-12-08 19:08:28.171229: E /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:1906] Asymm Coll cache (policy: coll_cache_asymm_link) | local 2432718 / 244160499 nodes ( 1.00 %~1.00 %) | remote 4873998 / 244160499 nodes ( 2.00 %) | cpu 236853783 / 244160499 nodes ( 97.01 %) | 3.51 GB | 0.633492 secs 
[2022-12-08 19:08:28.172017: E /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:1906] Asymm Coll cache (policy: coll_cache_asymm_link) | local 2437108 / 244160499 nodes ( 1.00 %~1.00 %) | remote 4869608 / 244160499 nodes ( 1.99 %) | cpu 236853783 / 244160499 nodes ( 97.01 %) | 3.52 GB | 0.678463 secs 
[2022-12-08 19:08:28.172574: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:2010] before create ctx, mem is 6.17 GB
[2022-12-08 19:08:30.431081: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:2016] after create ctx, mem is 6.66 GB
[2022-12-08 19:08:30.431249: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:2023] after create stream, mem is 6.66 GB
[2022-12-08 19:08:30.431735: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:2010] before create ctx, mem is 6.66 GB
[2022-12-08 19:08:32. 29515: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:2016] after create ctx, mem is 7.15 GB
[2022-12-08 19:08:32. 29697: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:2023] after create stream, mem is 7.15 GB
[2022-12-08 19:08:32. 30204: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:2010] before create ctx, mem is 7.15 GB
[2022-12-08 19:08:33.536992: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:2016] after create ctx, mem is 7.79 GB
[2022-12-08 19:08:33.537135: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:2023] after create stream, mem is 7.79 GB
[2022-12-08 19:08:33.537606: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:2010] before create ctx, mem is 7.79 GB
[2022-12-08 19:08:34.878247: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:2016] after create ctx, mem is 8.16 GB
[2022-12-08 19:08:34.878399: W /samgraph/3rdparty/collcachelib/coll_cache_lib/cache_context.cu:2023] after create stream, mem is 8.16 GB
[[2022-12-08 19:08:34.2022-12-08 19:08:34879059.: 879057E:  E/samgraph/3rdparty/collcachelib/coll_cache_lib/run_config.cc :/samgraph/3rdparty/collcachelib/coll_cache_lib/run_config.cc134:] 134using concurrent impl MPS] 
using concurrent impl MPS
[2022-12-08 19:08:34.879308: E /samgraph/3rdparty/collcachelib/coll_cache_lib/run_config.cc:134] using concurrent impl MPS
[2022-12-08 19:08:34.880023: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:200[] 2022-12-08 19:08:34build symm link desc with 3X Tesla V100-SXM2-16GB out of 4.
880046: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:200] [build symm link desc with 3X Tesla V100-SXM2-16GB out of 4
2022-12-08 19:08:34.880085: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:[2022-12-08 19:08:34201.] 880106remote time is 8.68421: 
E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:201[] 2022-12-08 19:08:34remote time is 8.68421.
880132: E[[ 2022-12-08 19:08:342022-12-08 19:08:34/samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc..:880156880140202: E: ]  Ecpu time is 30/samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc 
:/samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc202:] 200cpu time is 30] 
build symm link desc with 3X Tesla V100-SXM2-16GB out of 4
[2022-12-08 19:08:34.880305: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:201] remote time is 8.68421
[2022-12-08 19:08:34.880343: E /samgraph/3rdparty/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:202] cpu time is 30
[[[2022-12-08 19:08:372022-12-08 19:08:372022-12-08 19:08:37...639655639656639661: : : EEE   /samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc/samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc/samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc:::202202202] ] ] 0 solved2 solved1 solved


[[2022-12-08 19:08:37[2022-12-08 19:08:37.2022-12-08 19:08:37.639939.639944: 639949: EE:   E/samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc/samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc ::/samgraph/3rdparty/collcachelib/coll_cache_lib/facade.cc205205:] ] 205worker 2 thread 2 initing device 2worker 0 thread 0 initing device 0] 

worker 1 thread 1 initing device 1
[2022-12-08 19:08:40.314745: W /samgraph/samgraph/common/cuda/cuda_device.cc:49] GPU[0] alloc cuda memory 918.67 MB
[2022-12-08 19:08:42. 35109: W /samgraph/samgraph/common/cuda/cuda_device.cc:49] GPU[0] alloc cuda memory 918.67 MB
/usr/local/lib/python3.8/dist-packages/torch/nn/parallel/scatter_gather.py:9: UserWarning: is_namedtuple is deprecated, please use the python checks instead
  warnings.warn("is_namedtuple is deprecated, please use the python checks instead")
/usr/local/lib/python3.8/dist-packages/torch/nn/parallel/scatter_gather.py:9: UserWarning: is_namedtuple is deprecated, please use the python checks instead
  warnings.warn("is_namedtuple is deprecated, please use the python checks instead")
/usr/local/lib/python3.8/dist-packages/torch/nn/parallel/scatter_gather.py:9: UserWarning: is_namedtuple is deprecated, please use the python checks instead
  warnings.warn("is_namedtuple is deprecated, please use the python checks instead")
